{"version":3,"sources":["components/VideoProvider/useSelectedParticipant/useSelectedParticipant.tsx","utils/index.ts","hooks/useLocalVideoToggle/useLocalVideoToggle.tsx","components/VideoProvider/AttachVisibilityHandler/AttachVisibilityHandler.tsx","constants.ts","hooks/useDevices/useDevices.tsx","components/VideoProvider/useRoom/useRoom.tsx","components/VideoProvider/index.tsx","components/VideoProvider/useLocalTracks/useLocalTracks.ts","components/VideoProvider/useScreenShareToggle/useScreenShareToggle.tsx","components/VideoProvider/useHandleRoomDisconnection/useHandleRoomDisconnection.ts","components/VideoProvider/useHandleTrackPublicationFailed/useHandleTrackPublicationFailed.ts","components/VideoProvider/useRestartAudioTrackOnDeviceChange/useRestartAudioTrackOnDeviceChange.ts","hooks/useVideoContext/useVideoContext.ts","components/Buttons/EndCallButton/EndCallButton.tsx","state/settings/settingsReducer.ts","state/useFirebaseAuth/useFirebaseAuth.ts","state/usePasscodeAuth/usePasscodeAuth.ts","state/index.tsx","state/useActiveSinkId/useActiveSinkId.ts","components/AboutDialog/AboutDialog.tsx","hooks/useIsTrackEnabled/useIsTrackEnabled.tsx","hooks/useMediaStreamTrack/useMediaStreamTrack.ts","components/AudioLevelIndicator/AudioLevelIndicator.tsx","components/DeviceSelectionDialog/AudioInputList/AudioInputList.tsx","components/DeviceSelectionDialog/AudioOutputList/AudioOutputList.tsx","components/VideoTrack/VideoTrack.tsx","hooks/useVideoTrackDimensions/useVideoTrackDimensions.tsx","components/DeviceSelectionDialog/VideoInputList/VideoInputList.tsx","components/DeviceSelectionDialog/DeviceSelectionDialog.tsx","icons/FlipCameraIcon.tsx","icons/InfoIconOutlined.tsx","icons/SettingsIcon.tsx","components/MenuBar/Menu/Menu.tsx","hooks/useFlipCameraToggle/useFlipCameraToggle.tsx","hooks/useRoomState/useRoomState.tsx","icons/MicIcon.tsx","icons/MicOffIcon.tsx","components/Buttons/ToggleAudioButton/ToggleAudioButton.tsx","hooks/useLocalAudioToggle/useLocalAudioToggle.tsx","icons/ChatIcon.tsx","components/ChatProvider/index.tsx","hooks/useChatContext/useChatContext.ts","components/Buttons/ToggleChatButton/ToggleChatButton.tsx","icons/VideoOffIcon.tsx","icons/VideoOnIcon.tsx","components/Buttons/ToggleVideoButton/ToggleVideoButton.tsx","icons/ScreenShareIcon.tsx","hooks/useScreenShareParticipant/useScreenShareParticipant.tsx","components/Buttons/ToogleScreenShareButton/ToggleScreenShareButton.tsx","components/MenuBar/MenuBar.tsx","components/MobileTopMenuBar/MobileTopMenuBar.tsx","icons/AvatarIcon.tsx","components/LocalAudioLevelIndicator/LocalAudioLevelIndicator.tsx","components/PreJoinScreens/DeviceSelectionScreen/LocalVideoPreview/LocalVideoPreview.tsx","state/settings/renderDimensions.ts","components/ConnectionOptionsDialog/ConnectionOptionsDialog.tsx","components/PreJoinScreens/DeviceSelectionScreen/SettingsMenu/SettingsMenu.tsx","components/PreJoinScreens/DeviceSelectionScreen/DeviceSelectionScreen.tsx","components/IntroContainer/VideoLogo.tsx","components/IntroContainer/TwilioLogo.tsx","components/IntroContainer/UserMenu/UserAvatar/UserAvatar.tsx","components/IntroContainer/UserMenu/UserMenu.tsx","components/IntroContainer/IntroContainer.tsx","components/IntroContainer/swoosh.ts","icons/ErrorIcon.tsx","icons/WarningIcon.tsx","components/Snackbar/Snackbar.tsx","components/PreJoinScreens/MediaErrorSnackbar/MediaErrorSnackbar.tsx","components/PreJoinScreens/RoomNameScreen/RoomNameScreen.tsx","components/PreJoinScreens/PreJoinScreens.tsx","components/ReconnectingNotification/ReconnectingNotification.tsx","icons/CloseIcon.tsx","components/ChatWindow/ChatWindowHeader/ChatWindowHeader.tsx","icons/FileAttachmentIcon.tsx","icons/SendMessageIcon.tsx","components/ChatWindow/ChatInput/ChatInput.tsx","components/ChatWindow/MessageList/MessageInfo/MessageInfo.tsx","components/ChatWindow/MessageList/MessageListScrollContainer/MessageListScrollContainer.tsx","components/ChatWindow/MessageList/TextMessage/TextMessage.tsx","icons/FileDownloadIcon.tsx","components/ChatWindow/MessageList/MediaMessage/MediaMessage.tsx","components/ChatWindow/MessageList/MessageList.tsx","components/ChatWindow/ChatWindow.tsx","components/NetworkQualityLevel/NetworkQualityLevel.tsx","hooks/useParticipantNetworkQualityLevel/useParticipantNetworkQualityLevel.tsx","components/ParticipantInfo/PinIcon/PinIcon.tsx","hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff.tsx","hooks/usePublications/usePublications.tsx","hooks/useTrack/useTrack.tsx","hooks/useParticipantIsReconnecting/useParticipantIsReconnecting.ts","components/ParticipantInfo/ParticipantInfo.tsx","components/AudioTrack/AudioTrack.tsx","components/Publication/Publication.tsx","components/ParticipantTracks/ParticipantTracks.tsx","components/Participant/Participant.tsx","hooks/useDominantSpeaker/useDominantSpeaker.tsx","hooks/useParticipants/useParticipants.tsx","hooks/useMainParticipant/useMainParticipant.tsx","components/ParticipantList/ParticipantList.tsx","components/MainParticipantInfo/MainParticipantInfo.tsx","components/MainParticipant/MainParticipant.tsx","components/Room/Room.tsx","App.tsx","hooks/useHeight/useHeight.ts","components/ErrorDialog/ErrorDialog.tsx","components/ErrorDialog/enhanceMessage.ts","components/LoginPage/google-logo.svg","components/LoginPage/LoginPage.tsx","components/PrivateRoute/PrivateRoute.tsx","theme.ts","utils/useConnectionOptions/useConnectionOptions.ts","components/UnsupportedBrowserWarning/UnsupportedBrowserWarning.tsx","index.tsx"],"names":["selectedParticipantContext","createContext","useSelectedParticipant","useContext","SelectedParticipantProvider","room","children","useState","selectedParticipant","_setSelectedParticipant","useEffect","onDisconnect","handleParticipantDisconnected","participant","prevParticipant","on","off","Provider","value","isMobile","navigator","userAgent","test","removeUndefineds","obj","isPlainObject","target","key","val","useLocalVideoToggle","useVideoContext","localTracks","getLocalVideoTrack","removeLocalVideoTrack","onError","localParticipant","videoTrack","find","track","name","includes","isPublishing","setIspublishing","toggleVideoEnabled","useCallback","localTrackPublication","unpublishTrack","emit","then","publishTrack","priority","catch","finally","AttachVisibilityHandler","isVideoEnabled","shouldRepublishVideoOnForeground","useRef","handleVisibilityChange","document","visibilityState","current","addEventListener","removeEventListener","DEFAULT_VIDEO_CONSTRAINTS","width","height","frameRate","SELECTED_AUDIO_INPUT_KEY","SELECTED_AUDIO_OUTPUT_KEY","SELECTED_VIDEO_INPUT_KEY","useDevices","devices","setDevices","getDevices","mediaDevices","enumerateDevices","newDevices","audioInputDevices","filter","device","kind","videoInputDevices","audioOutputDevices","hasAudioInputDevices","length","hasVideoInputDevices","window","TwilioVideo","Video","VideoContext","VideoProvider","options","onErrorCallback","error","console","log","message","audioTrack","setAudioTrack","setVideoTrack","isAcquiringLocalTracks","setIsAcquiringLocalTracks","getLocalAudioTrack","deviceId","exact","createLocalAudioTrack","newTrack","selectedVideoDeviceId","localStorage","getItem","hasSelectedVideoDevice","some","Date","now","createLocalVideoTrack","removeLocalAudioTrack","stop","undefined","getAudioAndVideoTracks","Promise","resolve","selectedAudioDeviceId","hasSelectedAudioDevice","localTrackConstraints","video","audio","createLocalTracks","tracks","newVideoTrack","newAudioTrack","useLocalTracks","setRoom","isConnecting","setIsConnecting","optionsRef","connect","token","newRoom","disconnect","setMaxListeners","once","setTimeout","twilioRoom","videoTracks","forEach","publication","setPriority","useRoom","isSharing","setIsSharing","stopScreenShareRef","shareScreen","getDisplayMedia","stream","getTracks","trackPublication","onended","toggleScreenShare","useScreenShareToggle","isSharingScreen","onDisconnected","_","useHandleRoomDisconnection","useHandleTrackPublicationFailed","handleDeviceChange","mediaStreamTrack","readyState","restart","useRestartAudioTrackOnDeviceChange","context","Error","useStyles","makeStyles","theme","createStyles","button","background","brand","color","EndCallButton","props","classes","Button","onClick","className","clsx","data-cy-disconnect","initialSettings","trackSwitchOffMode","dominantSpeakerPriority","bandwidthProfileMode","maxTracks","maxAudioBitrate","renderDimensionLow","renderDimensionStandard","renderDimensionHigh","inputLabels","setting","settingsReducer","state","action","process","REACT_APP_FIREBASE_API_KEY","REACT_APP_FIREBASE_AUTH_DOMAIN","REACT_APP_FIREBASE_DATABASE_URL","REACT_APP_FIREBASE_STORAGE_BUCKET","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","fetchToken","passcode","create_room","create_conversation","REACT_APP_DISABLE_TWILIO_CONVERSATIONS","fetch","method","headers","body","JSON","stringify","user_identity","room_name","verifyPasscode","res","a","json","jsonResponse","status","isValid","ok","getErrorMessage","usePasscodeAuth","history","useHistory","user","setUser","isAuthReady","setIsAuthReady","roomType","setRoomType","getToken","errorMessage","statusText","room_type","match","location","search","sessionStorage","getPasscode","verification","setItem","replace","pathname","signIn","signOut","removeItem","StateContext","AppStateProvider","setError","isFetching","setIsFetching","activeSinkId","_setActiveSinkId","setActiveSinkId","sinkId","selectedSinkId","useActiveSinkId","useReducer","settings","dispatchSetting","contextValue","err","reject","useAppState","AboutDialog","open","onClose","Dialog","fullWidth","maxWidth","DialogTitle","Divider","DialogContent","DialogContentText","String","isSupported","version","appVersion","REACT_APP_GIT_TAG","REACT_APP_GIT_COMMIT","DialogActions","variant","autoFocus","useIsTrackEnabled","isEnabled","setIsEnabled","setEnabled","setDisabled","useMediaStreamTrack","setMediaStreamTrack","handleStarted","audioContext","clipId","AudioContext","webkitAudioContext","initializeAnalyser","audioSource","createMediaStreamSource","analyser","createAnalyser","smoothingTimeConstant","fftSize","AudioLevelIndicator","SVGRectRef","setAnalyser","isTrackEnabled","newMediaStream","MediaStream","clone","stopAllMediaStreamTracks","reinitializeAnalyser","SVGClipElement","sampleArray","Uint8Array","frequencyBinCount","timer","interval","getByteFrequencyData","values","i","volume","Math","min","max","log10","setAttribute","clipPathId","xmlns","viewBox","data-test-audio-indicator","id","ref","x","y","fill","fillRule","transform","clipPath","rx","ry","strokeWidth","d","data-test-audio-mute-icon","React","memo","AudioInputList","localAudioTrack","localAudioInputDeviceId","getSettings","Typography","gutterBottom","Grid","container","alignItems","justify","FormControl","Select","onChange","e","newDeviceId","map","MenuItem","label","AudioOutputList","activeOutputLabel","styled","VideoTrack","isLocal","dimensions","setDimensions","handleDimensionsChanged","useVideoTrackDimensions","isPortrait","el","muted","attach","detach","isFrontFacing","facingMode","style","objectFit","preview","maxHeight","margin","VideoInputList","localVideoTrack","storedLocalVideoDeviceId","setStoredLocalVideoDeviceId","localVideoInputDeviceId","minHeight","breakpoints","down","float","paper","headline","marginBottom","fontSize","listSection","DeviceSelectionDialog","FlipCameraIcon","InfoIconOutlined","SettingsIcon","clipRule","IconContainer","display","justifyContent","marginRight","Menu","useMediaQuery","aboutOpen","setAboutOpen","menuOpen","setMenuOpen","settingsOpen","setSettingsOpen","anchorRef","supportsFacingMode","setSupportsFacingMode","toggleFacingMode","newFacingMode","flipCameraDisabled","flipCameraSupported","useFlipCameraToggle","isOpen","buttonClassName","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","disabled","useRoomState","setState","setRoomState","MicIcon","MicOffIcon","ToggleAudioButton","disable","enable","useLocalAudioToggle","isAudioEnabled","toggleAudioEnabled","hasAudioTrack","startIcon","data-cy-audio-toggle","ChatIcon","ChatContext","ChatProvider","isChatWindowOpenRef","isChatWindowOpen","setIsChatWindowOpen","conversation","setConversation","messages","setMessages","hasUnreadMessages","setHasUnreadMessages","chatClient","setChatClient","Client","create","client","handleMessageAdded","oldMessages","getMessages","newMessages","items","getConversationByUniqueName","sid","newConversation","chatConversation","useChatContext","iconContainer","position","circle","backgroundColor","borderRadius","top","left","opacity","transition","ANIMATION_DURATION","ring","border","animateRing","animation","animationIterationCount","ToggleChatButton","shouldAnimate","setShouldAnimate","handleNewMessage","data-cy-chat-button","VideoOffIcon","VideoOnIcon","ToggleVideoButton","lastClickTimeRef","toggleVideo","ScreenShareIcon","useScreenShareParticipant","screenShareParticipant","setScreenShareParticipant","updateScreenShareParticipant","Array","from","participants","concat","trackName","ToggleScreenShareButton","disableScreenShareButton","Boolean","isScreenShareSupported","isDisabled","tooltipMessage","Tooltip","title","placement","PopperProps","disablePortal","cursor","data-cy-share-screen","palette","default","bottom","right","footerHeight","padding","zIndex","mobileFooterHeight","screenShareBanner","hideMobile","MenuBar","isReconnecting","Hidden","smDown","flex","item","paddingLeft","mobileTopBarHeight","endCallButton","settingsButton","minWidth","MobileTopMenuBar","AvatarIcon","cx","cy","r","strokeLinejoin","LocalAudioLevelIndicator","overflow","paddingTop","innerContainer","identityContainer","identity","avatarContainer","LocalVideoPreview","component","RenderDimensions","resolution","getResolution","formControl","withDefault","RenderDimensionItems","ConnectionOptionsDialog","handleChange","handleNumberChange","spacing","xs","hidden","sm","InputLabel","TextField","placeholder","SettingsMenu","mobileButtonClass","deviceSettingsOpen","setDeviceSettingsOpen","connectionSettingsOpen","setConnectionSettingsOpen","getContentAnchorEl","marginTop","deviceButton","localPreviewContainer","paddingRight","joinButtons","flexDirection","mobileButtonBar","mobileButton","DeviceSelectionScreen","roomName","setStep","chatConnect","videoConnect","disableButtons","direction","CircularProgress","fontWeight","md","mdUp","Steps","roomNameStep","data-cy-join-now","VideoLogo","TwilioLogo","red","userContainer","userButton","logoutLink","UserMenu","handleSignOut","Link","boxShadow","swooshContainer","backgroundImage","backgroundSize","backgroundPositionY","logoContainer","textAlign","twilioLogo","content","IntroContainer","useLocation","ErrorIcon","stroke","WarningIcon","contentContainer","borderLeft","warning","Snackbar","handleClose","reason","IconButton","size","aria-label","MediaErrorSnackbar","isSnackbarDismissed","setIsSnackbarDismissed","isSnackbarOpen","hasAudio","hasVideo","getSnackbarContent","inputContainer","textFieldContainer","continueButton","RoomNameScreen","setName","setRoomName","handleSubmit","hasUsername","displayName","onSubmit","shrink","htmlFor","event","autoCapitalize","type","PreJoinScreens","URLRoomName","useParams","step","mediaError","setMediaError","deviceSelectionStep","dir","preventDefault","origin","replaceState","encodeURI","ReconnectingNotification","roomState","CloseIcon","borderBottom","text","closeChatWindow","ChatWindowHeader","FileAttachmentIcon","chatInputContainer","borderTop","textArea","resize","fontFamily","buttonContainer","fileButtonContainer","fileButtonLoadingSpinner","marginLeft","ChatInput","messageBody","setMessageBody","isSendingFile","setIsSendingFile","fileSendError","setFileSendError","isValidMessage","textInputRef","fileInputRef","focus","handleSendMessage","sendMessage","trim","TextareaAutosize","rowsMin","rowsMax","onKeyPress","shiftKey","data-cy-chat-input","wrap","file","files","formData","FormData","append","code","accept","click","data-cy-send-message-button","messageInfoContainer","MessageInfo","author","dateCreated","isLocalParticipant","styles","outerContainer","innerScrollContainer","overflowY","messageListContainer","paddingBottom","visibility","showButton","MessageListScrollContainer","chatThreadRef","createRef","isScrolledToBottom","messageNotificationCount","handleScroll","throttle","innerScrollContainerEl","abs","clientHeight","scrollTop","scrollHeight","prevState","handleClick","scrollTo","behavior","this","scrollToBottom","prevProps","hasNewMessages","numberOfNewMessages","previousState","data-cy-message-list-inner-scroll","data-cy-new-message-button","Component","withStyles","messageContainer","wordBreak","hyphens","whiteSpace","TextMessage","matches","linkify","results","lastIndex","push","slice","index","rel","href","url","addLinks","FileDownloadIcon","mediaInfo","filename","textOverflow","formatFileSize","bytes","suffixIndex","suffixes","toFixed","FileMessage","media","getContentTemporaryUrl","createElement","getFormattedTime","toLocaleTimeString","hour","minute","toLowerCase","MessageList","idx","time","shouldDisplayMessageInfo","Fragment","chatWindowContainer","hide","ChatWindow","borderRight","BARS_ARRAY","NetworkQualityLevel","networkQualityLevel","setNetworkQualityLevel","handleNewtorkQualityLevelChange","newNetworkQualityLevel","useParticipantNetworkQualityLevel","level","PinIcon","SvgIcon","boxSizing","useIsTrackSwitchedOff","isSwitchedOff","setIsSwitchedOff","handleSwitchedOff","handleSwitchedOn","usePublications","publications","setPublications","publicationAdded","prevPublications","publicationRemoved","p","useTrack","setTrack","removeTrack","useParticipantIsReconnecting","setIsReconnecting","handleReconnecting","handleReconnected","participantBorderWidth","sidebarMobileHeight","infoContainer","reconnectingContainer","screenShareIconContainer","infoRowBottom","typeography","hideParticipant","cursorPointer","ParticipantInfo","isSelected","audioPublication","videoPublication","isScreenShareEnabled","isVideoSwitchedOff","isParticipantReconnecting","data-cy-participant","AudioTrack","audioEl","appendChild","remove","setSinkId","Publication","videoOnly","videoPriority","ParticipantTracks","filteredPublications","enableScreenShare","Participant","useDominantSpeaker","dominantSpeaker","setDominantSpeaker","handleDominantSpeakerChanged","newDominantSpeaker","prevDominantSpeaker","useParticipants","setParticipants","prevParticipants","participantConnected","participantDisconnected","useMainParticipant","gridArea","overflowX","transparentBackground","scrollContainer","sidebarWidth","sidebarMobilePadding","ParticipantList","setSelectedParticipant","mainParticipant","isRemoteParticipantScreenSharing","MainParticipantInfo","screenSharePublication","data-cy-main-participant","MainParticipant","totalMobileSidebarHeight","gridTemplateColumns","gridTemplateRows","chatWindowOpen","chatWindowWidth","Room","Container","Main","App","innerHeight","visualViewport","scale","setHeight","onResize","useHeight","ErrorDialog","dismissError","enhancedMessage","enhanceMessage","googleButton","textTransform","passcodeContainer","submitButton","LoginPage","setPasscode","authError","setAuthError","isAuthEnabled","PrivateRoute","rest","renderChildren","render","to","defaultTheme","createMuiTheme","overrides","MuiCssBaseline","MuiButton","root","transitions","duration","short","contained","outlinedPrimary","MuiTypography","body1","MuiInputBase","MuiSelect","MuiDialogActions","MuiTextField","MuiInputLabel","MuiOutlinedInput","notchedOutline","borderColor","typography","primary","main","useConnectionOptions","connectionOptions","bandwidthProfile","mode","renderDimensions","low","standard","high","Number","networkQuality","local","remote","preferredVideoCodecs","codec","simulcast","environment","REACT_APP_TWILIO_ENVIRONMENT","maxSubscriptionBitrate","wsServer","heading","UnsupportedBrowserWarning","Paper","VideoApp","ReactDOM","CssBaseline","path","getElementById"],"mappings":"kXAKaA,EAA6BC,wBAA8C,MAEzE,SAASC,IAA0B,IAAD,EACOC,qBAAWH,GADlB,mBAE/C,MAAO,CAFwC,WAU1C,SAASI,EAAT,GAA4F,IAArDC,EAAoD,EAApDA,KAAMC,EAA8C,EAA9CA,SAA8C,EACzCC,mBAA6B,MADY,mBACzFC,EADyF,KACpEC,EADoE,KAoBhG,OAfAC,qBAAU,WACR,GAAIL,EAAM,CACR,IAAMM,EAAe,kBAAMF,EAAwB,OAC7CG,EAAgC,SAACC,GAAD,OACpCJ,GAAwB,SAAAK,GAAe,OAAKA,IAAoBD,EAAc,KAAOC,MAIvF,OAFAT,EAAKU,GAAG,eAAgBJ,GACxBN,EAAKU,GAAG,0BAA2BH,GAC5B,WACLP,EAAKW,IAAI,eAAgBL,GACzBN,EAAKW,IAAI,0BAA2BJ,OAGvC,CAACP,IAGF,kBAACL,EAA2BiB,SAA5B,CAAqCC,MAAO,CAACV,EAnBhB,SAACK,GAAD,OAC7BJ,GAAwB,SAAAK,GAAe,OAAKA,IAAoBD,EAAc,KAAOA,QAmBlFP,G,sBCrCMa,EACc,qBAAdC,WAA4D,kBAAxBA,UAAUC,WAGlD,SAASC,KAAKF,UAAUC,WAI1B,SAASE,EAAoBC,GAClC,IAAKC,IAAcD,GAAM,OAAOA,EAEhC,IAAME,EAAkC,GAExC,IAAK,IAAMC,KAAOH,EAAK,CACrB,IAAMI,EAAMJ,EAAIG,GACG,qBAARC,IACTF,EAAOC,GAAOJ,EAAiBK,IAInC,OAAOF,EClBM,SAASG,IAAuB,IAAD,EACsCC,IAA1EzB,EADoC,EACpCA,KAAM0B,EAD8B,EAC9BA,YAAaC,EADiB,EACjBA,mBAAoBC,EADH,EACGA,sBAAuBC,EAD1B,EAC0BA,QAChEC,EAAgB,OAAG9B,QAAH,IAAGA,OAAH,EAAGA,EAAM8B,iBACzBC,EAAaL,EAAYM,MAAK,SAAAC,GAAK,OAAIA,EAAMC,KAAKC,SAAS,aAHrB,EAIJjC,oBAAS,GAJL,mBAIrCkC,EAJqC,KAIvBC,EAJuB,KAMtCC,EAAqBC,uBAAY,WACrC,IAAKH,EACH,GAAIL,EAAY,CACd,IAAMS,EAAqB,OAAGV,QAAH,IAAGA,OAAH,EAAGA,EAAkBW,eAAeV,GAE/C,OAAhBD,QAAgB,IAAhBA,KAAkBY,KAAK,mBAAoBF,GAC3CZ,SAEAS,GAAgB,GAChBV,IACGgB,MAAK,SAACV,GAAD,cAA4BH,QAA5B,IAA4BA,OAA5B,EAA4BA,EAAkBc,aAAaX,EAAO,CAAEY,SAAU,WACnFC,MAAMjB,GACNkB,SAAQ,kBAAMV,GAAgB,QAGpC,CAACN,EAAYD,EAAkBH,EAAoBS,EAAcP,EAASD,IAE7E,MAAO,GAAGG,EAAYO,GCZT,SAASU,IAA2B,IACzChD,EAASyB,IAATzB,KADwC,EAEHwB,IAFG,mBAEzCyB,EAFyC,KAEzBX,EAFyB,KAG1CY,EAAmCC,kBAAO,GAwBhD,OAtBA9C,qBAAU,WACR,GAAIL,GAAQc,EAAU,CACpB,IAAMsC,EAAyB,WAEI,WAA7BC,SAASC,iBAAgCL,GAC3CC,EAAiCK,SAAU,EAC3CjB,KAGSY,EAAiCK,UAC1CL,EAAiCK,SAAU,EAC3CjB,MAKJ,OADAe,SAASG,iBAAiB,mBAAoBJ,GACvC,WACLC,SAASI,oBAAoB,mBAAoBL,OAGpD,CAACH,EAAgBjD,EAAMsC,IAEnB,K,YC1CIoB,EAA6D,CACxEC,MAAO,KACPC,OAAQ,IACRC,UAAW,IAIAC,EAA2B,oCAC3BC,EAA4B,qCAC5BC,EAA2B,oC,iBCPzB,SAASC,IAAc,IAAD,EACL/D,mBAA4B,IADvB,mBAC5BgE,EAD4B,KACnBC,EADmB,KAanC,OAVA9D,qBAAU,WACR,IAAM+D,EAAa,kBAAMrD,UAAUsD,aAAaC,mBAAmB3B,MAAK,SAAA4B,GAAU,OAAIJ,EAAWI,OAIjG,OAHAxD,UAAUsD,aAAab,iBAAiB,eAAgBY,GACxDA,IAEO,WACLrD,UAAUsD,aAAaZ,oBAAoB,eAAgBW,MAE5D,IAEI,CACLI,kBAAmBN,EAAQO,QAAO,SAAAC,GAAM,MAAoB,eAAhBA,EAAOC,QACnDC,kBAAmBV,EAAQO,QAAO,SAAAC,GAAM,MAAoB,eAAhBA,EAAOC,QACnDE,mBAAoBX,EAAQO,QAAO,SAAAC,GAAM,MAAoB,gBAAhBA,EAAOC,QACpDG,qBAAsBZ,EAAQO,QAAO,SAAAC,GAAM,MAAoB,eAAhBA,EAAOC,QAAuBI,OAAS,EACtFC,qBAAsBd,EAAQO,QAAO,SAAAC,GAAM,MAAoB,eAAhBA,EAAOC,QAAuBI,OAAS,GCd1FE,OAAOC,YAAcC,IC6Bd,IAAMC,EAAexF,wBAA6B,MAQlD,SAASyF,EAAT,GAAuF,IAA9DC,EAA6D,EAA7DA,QAASrF,EAAoD,EAApDA,SAAoD,IAA1C4B,eAA0C,MAAhC,aAAgC,EACrF0D,EAAiChD,uBACrC,SAAAiD,GACEC,QAAQC,IAAR,iBAAsBF,EAAMG,SAAWH,GACvC3D,EAAQ2D,KAEV,CAAC3D,IANwF,ECtC9E,WAA2B,IAAD,EACH3B,qBADG,mBAChC0F,EADgC,KACpBC,EADoB,OAEH3F,qBAFG,mBAEhC6B,EAFgC,KAEpB+D,EAFoB,OAGqB5F,oBAAS,GAH9B,mBAGhC6F,EAHgC,KAGRC,EAHQ,OAIsD/B,IAArFO,EAJ+B,EAI/BA,kBAAmBI,EAJY,EAIZA,kBAAmBE,EAJP,EAIOA,qBAAsBE,EAJ7B,EAI6BA,qBAE9DiB,EAAqB1D,uBAAY,SAAC2D,GACtC,IAAMZ,EAAmC,GAMzC,OAJIY,IACFZ,EAAQY,SAAW,CAAEC,MAAOD,IAGvBf,IAAMiB,sBAAsBd,GAAS3C,MAAK,SAAA0D,GAE/C,OADAR,EAAcQ,GACPA,OAER,IAEG1E,EAAqBY,uBAAY,WACrC,IAAM+D,EAAwBrB,OAAOsB,aAAaC,QAAQxC,GAEpDyC,EAAyB7B,EAAkB8B,MAC/C,SAAAhC,GAAM,OAAI4B,GAAyB5B,EAAOwB,WAAaI,KAGnDhB,EAAgC,2BAChC5B,GADgC,IAEpCxB,KAAK,UAAD,OAAYyE,KAAKC,QACjBH,GAA0B,CAAEP,SAAU,CAAEC,MAAOG,KAGrD,OAAOnB,IAAM0B,sBAAsBvB,GAAS3C,MAAK,SAAA0D,GAE/C,OADAP,EAAcO,GACPA,OAER,CAACzB,IAEEkC,EAAwBvE,uBAAY,WACpCqD,IACFA,EAAWmB,OACXlB,OAAcmB,MAEf,CAACpB,IAEEhE,EAAwBW,uBAAY,WACpCR,IACFA,EAAWgF,OACXjB,OAAckB,MAEf,CAACjF,IAEEkF,EAAyB1E,uBAAY,WACzC,IAAKuC,IAAyBE,EAAsB,OAAOkC,QAAQC,UACnE,GAAIpB,GAA0BH,GAAc7D,EAAY,OAAOmF,QAAQC,UAEvEnB,GAA0B,GAE1B,IAAMoB,EAAwBnC,OAAOsB,aAAaC,QAAQ1C,GACpDwC,EAAwBrB,OAAOsB,aAAaC,QAAQxC,GAEpDqD,EAAyB7C,EAAkBkC,MAC/C,SAAAhC,GAAM,OAAI0C,GAAyB1C,EAAOwB,WAAakB,KAEnDX,EAAyB7B,EAAkB8B,MAC/C,SAAAhC,GAAM,OAAI4B,GAAyB5B,EAAOwB,WAAaI,KAGnDgB,EAAwB,CAC5BC,MAAOvC,GAAoB,2BACrBtB,GADqB,IAEzBxB,KAAK,UAAD,OAAYyE,KAAKC,QACjBH,GAA0B,CAAEP,SAAU,CAAEC,MAAOG,KAErDkB,MAAOH,EAAyB,CAAEnB,SAAU,CAAEC,MAAOiB,IAA6BtC,GAGpF,OAAOK,IAAMsC,kBAAkBH,GAC5B3E,MAAK,SAAA+E,GACJ,IAAMC,EAAgBD,EAAO1F,MAAK,SAAAC,GAAK,MAAmB,UAAfA,EAAM0C,QAC3CiD,EAAgBF,EAAO1F,MAAK,SAAAC,GAAK,MAAmB,UAAfA,EAAM0C,QAC7CgD,GACF7B,EAAc6B,GAEZC,GACF/B,EAAc+B,MAGjB7E,SAAQ,kBAAMiD,GAA0B,QAC1C,CACDlB,EACAE,EACAY,EACA7D,EACAyC,EACAI,EACAmB,IAQF,MAAO,CACLrE,YANkB,CAACkE,EAAY7D,GAAY0C,QAAO,SAAAxC,GAAK,YAAc+E,IAAV/E,KAO3DN,qBACAsE,qBACAF,yBACAe,wBACAlF,wBACAqF,0BDxDEY,GAPFnG,EAVyF,EAUzFA,YACAC,EAXyF,EAWzFA,mBACAsE,EAZyF,EAYzFA,mBACAF,EAbyF,EAazFA,uBACAe,EAdyF,EAczFA,sBACAlF,EAfyF,EAezFA,sBACAqF,EAhByF,EAgBzFA,uBAhByF,EDnC9E,SAAiBvF,EAA2BG,EAAmByD,GAA2B,IAAD,EAC9EpF,mBAAsB,MADwD,mBAC/FF,EAD+F,KACzF8H,EADyF,OAE9D5H,oBAAS,GAFqD,mBAE/F6H,EAF+F,KAEjFC,EAFiF,KAGhGC,EAAa9E,iBAAOmC,GA2D1B,OAzDAjF,qBAAU,WAGR4H,EAAW1E,QAAU+B,IACpB,CAACA,IAqDG,CAAEtF,OAAM+H,eAAcG,QAnDb3F,uBACd,SAAA4F,GAEE,OADAH,GAAgB,GACT7C,IAAM+C,QAAQC,EAAd,2BAA0BF,EAAW1E,SAArC,IAA8CmE,OAAQhG,KAAeiB,MAC1E,SAAAyF,GACEN,EAAQM,GACR,IAAMC,EAAa,kBAAMD,EAAQC,cAIjCD,EAAQE,gBAAgB,IAExBF,EAAQG,KAAK,gBAAgB,WAE3BC,YAAW,kBAAMV,EAAQ,SACzB7C,OAAOxB,oBAAoB,eAAgB4E,GAEvCvH,GACFmE,OAAOxB,oBAAoB,WAAY4E,MAK3CpD,OAAOwD,WAAaL,EAEpBA,EAAQtG,iBAAiB4G,YAAYC,SAAQ,SAAAC,GAAW,OAItDA,EAAYC,YAAY,UAG1Bb,GAAgB,GAGhB/C,OAAOzB,iBAAiB,eAAgB6E,GAEpCvH,GAEFmE,OAAOzB,iBAAiB,WAAY6E,MAGxC,SAAA7C,GACE3D,EAAQ2D,GACRwC,GAAgB,QAItB,CAACtG,EAAaG,KCNwBiH,CAAQpH,EAAa6D,EAAiBD,GAAtEtF,EAlBmF,EAkBnFA,KAAM+H,EAlB6E,EAkB7EA,aAAcG,EAlB+D,EAkB/DA,QAlB+D,EEjC9E,SAA8BlI,EAAmB6B,GAAyB,IAAD,EACpD3B,oBAAS,GAD2C,mBAC/E6I,EAD+E,KACpEC,EADoE,KAEhFC,EAAqB9F,iBAAmB,MAExC+F,EAAc3G,uBAAY,WAC9BxB,UAAUsD,aACP8E,gBAAgB,CACf3B,OAAO,EACPD,MAAO,CACL1D,UAAW,GACXD,OAAQ,KACRD,MAAO,QAGVhB,MAAK,SAAAyG,GACJ,IAAMnH,EAAQmH,EAAOC,YAAY,GAKjCrJ,EAAM8B,iBACHc,aAAaX,EAAO,CACnBC,KAAM,SACNW,SAAU,QAEXF,MAAK,SAAA2G,GACJL,EAAmB1F,QAAU,WAC3BvD,EAAM8B,iBAAiBW,eAAeR,GAEtCjC,EAAM8B,iBAAiBY,KAAK,mBAAoB4G,GAChDrH,EAAM8E,OACNiC,GAAa,IAGf/G,EAAMsH,QAAUN,EAAmB1F,QACnCyF,GAAa,MAEdlG,MAAMjB,MAEViB,OAAM,SAAA0C,GAEc,eAAfA,EAAMtD,MAAwC,oBAAfsD,EAAMtD,MACvCL,EAAQ2D,QAGb,CAACxF,EAAM6B,IAEJ2H,EAAoBjH,uBAAY,WAChCvC,IACD+I,EAA4BE,EAAmB1F,UAAnC2F,OAEd,CAACH,EAAWG,EAAaD,EAAoBjJ,IAEhD,MAAO,CAAC+I,EAAWS,GFA0BC,CAAqBzJ,EAAM6B,GApBmB,mBAoBpF6H,EApBoF,KAoBnEF,EApBmE,KAkC3F,OGxEa,SACbxJ,EACA6B,EACAiF,EACAlF,EACA8H,EACAF,GAEAnJ,qBAAU,WACR,GAAIL,EAAM,CACR,IAAM2J,EAAiB,SAACC,EAASpE,GAC3BA,GACF3D,EAAQ2D,GAGVsB,IACAlF,IACI8H,GACFF,KAKJ,OADAxJ,EAAKU,GAAG,eAAgBiJ,GACjB,WACL3J,EAAKW,IAAI,eAAgBgJ,OAG5B,CAAC3J,EAAM6B,EAASiF,EAAuBlF,EAAuB8H,EAAiBF,IHkClFK,CACE7J,EACA6B,EACAiF,EACAlF,EACA8H,EACAF,GInEW,SAAyCxJ,EAAmB6B,GACzExB,qBAAU,WACR,GAAIL,EAEF,OADAA,EAAK8B,iBAAiBpB,GAAG,yBAA0BmB,GAC5C,WACL7B,EAAK8B,iBAAiBnB,IAAI,yBAA0BkB,MAGvD,CAAC7B,EAAM6B,IJ6DViI,CAAgC9J,EAAM6B,GK9DzB,SAA4CH,GACzD,IAAMkE,EAAalE,EAAYM,MAAK,SAAAC,GAAK,MAAmB,UAAfA,EAAM0C,QAEnDtE,qBAAU,WACR,IAAM0J,EAAqB,WACuB,WAAlC,OAAVnE,QAAU,IAAVA,OAAA,EAAAA,EAAYoE,iBAAiBC,aAC/BrE,EAAWsE,QAAQ,KAMvB,OAFAnJ,UAAUsD,aAAab,iBAAiB,eAAgBuG,GAEjD,WACLhJ,UAAUsD,aAAaZ,oBAAoB,eAAgBsG,MAE5D,CAACnE,ILgDJuE,CAAmCzI,GAGjC,kBAAC0D,EAAaxE,SAAd,CACEC,MAAO,CACLb,OACA0B,cACAqG,eACAlG,QAAS0D,EACT5D,qBACAsE,qBACAiC,UACAnC,yBACAnE,wBACA8H,kBACAF,oBACAvC,2BAGF,kBAAClH,EAAD,CAA6BC,KAAMA,GAAOC,GAK1C,kBAAC+C,EAAD,OMhGS,SAASvB,IACtB,IAAM2I,EAAUtK,qBAAWsF,GAC3B,IAAKgF,EACH,MAAM,IAAIC,MAAM,uDAElB,OAAOD,ECAT,IAAME,EAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACXC,OAAQ,CACNC,WAAYH,EAAMI,MAClBC,MAAO,QACP,UAAW,CACTF,WAAY,iBAML,SAASG,EAAcC,GACpC,IAAMC,EAAUV,IACRtK,EAASyB,IAATzB,KAER,OACE,kBAACiL,EAAA,EAAD,CAAQC,QAAS,kBAAMlL,EAAMqI,cAAc8C,UAAWC,YAAKJ,EAAQN,OAAQK,EAAMI,WAAYE,sBAAA,GAA7F,c,6FCHSC,EAA4B,CACvCC,wBAAoBvE,EACpBwE,wBAAyB,WACzBC,qBAAsB,gBACtBC,UAAW5K,EAAW,IAAM,KAC5B6K,gBAAiB,QACjBC,mBAAoB,MACpBC,wBAAyB,OACzBC,oBAAqB,aAMVC,EAAe,WAC1B,IAAM1K,EAAc,GACpB,IAAK,IAAM2K,KAAWV,EACpBjK,EAAO2K,GAAWA,EAEpB,OAAO3K,EALmB,GAQrB,SAAS4K,EAAgBC,EAAiBC,GAC/C,OAAO,2BACFD,GADL,kBAEGC,EAAOjK,KAAwB,YAAjBiK,EAAOtL,WAAsBmG,EAAYmF,EAAOtL,Q,cC1CzDuL,iKAAYC,2BACRD,iKAAYE,+BACXF,iKAAYG,gCACVH,iKAAYI,kCACRJ,iKAAYK,uC,YCC1B,SAASC,EACdxK,EACAlC,EACA2M,GAGC,IAFDC,IAEA,yDADAC,EACA,uDAD6E,SAAvDT,iKAAYU,uCAElC,OAAOC,MAAM,SAAU,CACrBC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CACnBC,cAAenL,EACfoL,UAAWtN,EACX2M,WACAC,cACAC,0BAKC,SAASU,EAAeZ,GAC7B,OAAOD,EAAW,YAAa,YAAaC,GAAU,GAAyB,GAAiChK,KAAzG,uCACL,WAAM6K,GAAN,iBAAAC,EAAA,sEAC6BD,EAAIE,OADjC,UACQC,EADR,OAEqB,MAAfH,EAAII,OAFV,yCAGW,CAAEC,SAAS,EAAOrI,MAAK,UAAEmI,EAAanI,aAAf,aAAE,EAAoBG,UAHxD,WAMM6H,EAAIM,KAAMH,EAAaxF,MAN7B,yCAOW,CAAE0F,SAAS,IAPtB,2CADK,uDAcF,SAASE,GAAgBpI,GAC9B,OAAQA,GACN,IAAK,qBACH,MAAO,wBACT,IAAK,mBACH,MAAO,uBACT,QACE,OAAOA,GAIE,SAASqI,KACtB,IAAMC,EAAUC,cADwB,EAGhBhO,mBAAmF,MAHnE,mBAGjCiO,EAHiC,KAG3BC,EAH2B,OAIFlO,oBAAS,GAJP,mBAIjCmO,EAJiC,KAIpBC,EAJoB,OAKRpO,qBALQ,mBAKjCqO,EALiC,KAKvBC,EALuB,KAOlCC,EAAWlM,uBACf,SAACL,EAAclC,GACb,OAAO0M,EAAWxK,EAAMlC,EAAMmO,EAAMxB,UACjChK,KADI,uCACC,WAAM6K,GAAN,mBAAAC,EAAA,0DACAD,EAAIM,GADJ,yCAEKN,GAFL,uBAIeA,EAAIE,OAJnB,aAIEA,EAJF,OAKEgB,EAAeX,IAAgB,UAAAL,EAAKlI,aAAL,eAAYG,UAAW6H,EAAImB,YAC1DtE,MAAMqE,GANR,2CADD,uDASJ/L,MAAK,SAAA6K,GAAG,OAAIA,EAAIE,UAChB/K,MAAK,SAAA6K,GAEJ,OADAgB,EAAYhB,EAAIoB,WACTpB,EAAIrF,WAGjB,CAACgG,IAGH9N,qBAAU,WACR,IAAMsM,EAlFH,WACL,IAAMkC,EAAQ5J,OAAO6J,SAASC,OAAOF,MAAM,mBAE3C,OADiBA,EAAQA,EAAM,GAAK5J,OAAO+J,eAAexI,QAAQ,YAgF/CyI,GAEbtC,EACFY,EAAeZ,GACZhK,MAAK,SAAAuM,IACJ,OAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAcrB,WAChBO,EAAQ,CAAEzB,aACV1H,OAAO+J,eAAeG,QAAQ,WAAYxC,GAC1CsB,EAAQmB,QAAQnK,OAAO6J,SAASO,cAGnC1M,MAAK,kBAAM2L,GAAe,MAE7BA,GAAe,KAEhB,CAACL,IAEJ,IAAMqB,EAAS/M,uBAAY,SAACoK,GAC1B,OAAOY,EAAeZ,GAAUhK,MAAK,SAAAuM,GACnC,YAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAcrB,SAIhB,MAAM,IAAIxD,MAAM0D,GAAe,OAACmB,QAAD,IAACA,OAAD,EAACA,EAAc1J,QAH9C4I,EAAQ,CAAEzB,aACV1H,OAAO+J,eAAeG,QAAQ,WAAYxC,QAK7C,IAEG4C,EAAUhN,uBAAY,WAG1B,OAFA6L,EAAQ,MACRnJ,OAAO+J,eAAeQ,WAAW,YAC1BtI,QAAQC,YACd,IAEH,MAAO,CAAEgH,OAAME,cAAaI,WAAUa,SAAQC,UAAShB,YC/FlD,IAAMkB,GAAe7P,wBAAgC,MAW7C,SAAS8P,GAAiB3E,GAAqC,IAAD,EACjD7K,mBAA6B,MADoB,mBACpEsF,EADoE,KAC7DmK,EAD6D,OAEvCzP,oBAAS,GAF8B,mBAEpE0P,EAFoE,KAExDC,EAFwD,OChC9D,WAA4B,IACjChL,EAAuBZ,IAAvBY,mBADgC,EAEC3E,mBAAS,WAFV,mBAEjC4P,EAFiC,KAEnBC,EAFmB,KAIlCC,EAAkBzN,uBACtB,SAAC0N,GACChL,OAAOsB,aAAa4I,QAAQpL,EAA2BkM,GACvDF,EAAiBE,KAEnB,CAACF,IAaH,OAVA1P,qBAAU,WACR,IAAM6P,EAAiBjL,OAAOsB,aAAaC,QAAQzC,GACdc,EAAmB6B,MACtD,SAAAhC,GAAM,OAAIwL,GAAkBxL,EAAOwB,WAAagK,MAGhDH,EAAiBG,KAElB,CAACrL,IAEG,CAACiL,EAAcE,GDakBG,GAHmC,mBAGpEL,EAHoE,KAGtDE,EAHsD,OAIvCI,qBAAWnE,EAAiBX,GAJW,mBAIpE+E,EAJoE,KAI1DC,EAJ0D,KAMvEC,EAAe,CACjB/K,QACAmK,WACAC,aACAE,eACAE,kBACAK,WACAC,mBASAC,EAAY,2BACPA,GACAvC,MAwCP,OAAO,kBAACyB,GAAa7O,SAAd,CAAuBC,MAAK,2BAAO0P,GAAP,IAAqB9B,SAfT,SAACvM,EAAMlC,GAEpD,OADA6P,GAAc,GACPU,EACJ9B,SAASvM,EAAMlC,GACf2C,MAAK,SAAA6K,GAEJ,OADAqC,GAAc,GACPrC,KAER1K,OAAM,SAAA0N,GAGL,OAFAb,EAASa,GACTX,GAAc,GACP3I,QAAQuJ,OAAOD,UAIyCzF,EAAM9K,UAGtE,SAASyQ,KACd,IAAMtG,EAAUtK,qBAAW2P,IAC3B,IAAKrF,EACH,MAAM,IAAIC,MAAM,wDAElB,OAAOD,EElEMuG,OAxBf,YAA8E,IAAvDC,EAAsD,EAAtDA,KAAMC,EAAgD,EAAhDA,QACnBtC,EAAamC,KAAbnC,SACR,OACE,kBAACuC,EAAA,EAAD,CAAQF,KAAMA,EAAMC,QAASA,EAASE,WAAW,EAAMC,SAAS,MAC9D,kBAACC,EAAA,EAAD,cACA,kBAACC,EAAA,EAAD,MACA,kBAACC,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,2BAAuCC,OAAOlM,IAAMmM,cACpD,kBAACF,EAAA,EAAD,qBAAiCjM,IAAMoM,SACvC,kBAACH,EAAA,EAAD,qBAAiCI,KACjC,kBAACJ,EAAA,EAAD,sBAAkChF,iKAAYqF,mBAAqB,OACnE,kBAACL,EAAA,EAAD,8BAA0ChF,iKAAYsF,sBAAwB,OAC7EnD,GAAY,kBAAC6C,EAAA,EAAD,mBAA+B7C,IAE9C,kBAAC2C,EAAA,EAAD,MACA,kBAACS,EAAA,EAAD,KACE,kBAAC1G,EAAA,EAAD,CAAQC,QAAS2F,EAAShG,MAAM,UAAU+G,QAAQ,YAAYC,WAAS,GAAvE,S,UC7BO,SAASC,GAAkB7P,GAAmB,IAAD,EACxB/B,qBAAS+B,GAAQA,EAAM8P,WADC,mBACnDA,EADmD,KACxCC,EADwC,KAkB1D,OAfA3R,qBAAU,WAGR,GAFA2R,IAAa/P,GAAQA,EAAM8P,WAEvB9P,EAAO,CACT,IAAMgQ,EAAa,kBAAMD,GAAa,IAChCE,EAAc,kBAAMF,GAAa,IAGvC,OAFA/P,EAAMvB,GAAG,UAAWuR,GACpBhQ,EAAMvB,GAAG,WAAYwR,GACd,WACLjQ,EAAMtB,IAAI,UAAWsR,GACrBhQ,EAAMtB,IAAI,WAAYuR,OAGzB,CAACjQ,IAEG8P,ECbM,SAASI,GAAoBlQ,GAAkC,IAAD,EAC3B/B,mBAAQ,OAAC+B,QAAD,IAACA,OAAD,EAACA,EAAO+H,kBADW,mBACpEA,EADoE,KAClDoI,EADkD,KAe3E,OAZA/R,qBAAU,WAGR,GAFA+R,EAAmB,OAACnQ,QAAD,IAACA,OAAD,EAACA,EAAO+H,kBAEvB/H,EAAO,CACT,IAAMoQ,EAAgB,kBAAMD,EAAoBnQ,EAAM+H,mBAEtD,OADA/H,EAAMvB,GAAG,UAAW2R,GACb,WACLpQ,EAAMtB,IAAI,UAAW0R,OAGxB,CAACpQ,IAEG+H,ECnBT,IAKIsI,GALAC,GAAS,EAIPC,GAAevN,OAAOuN,cAAgBvN,OAAOwN,mBAG5C,SAASC,GAAmBtJ,GAEjC,IAAMuJ,GADNL,GAAeA,IAAgB,IAAIE,IACFI,wBAAwBxJ,GAEnDyJ,EAAWP,GAAaQ,iBAK9B,OAJAD,EAASE,sBAAwB,GACjCF,EAASG,QAAU,IAEnBL,EAAYzK,QAAQ2K,GACbA,EAGT,SAASI,GAAT,GAA4G,IAA7ErN,EAA4E,EAA5EA,WAA4E,IAAhEiF,aAAgE,MAAxD,QAAwD,EACnGqI,EAAa/P,iBAAuB,MAD+D,EAEzEjD,qBAFyE,mBAElG2S,EAFkG,KAExFM,EAFwF,KAGnGC,EAAiBtB,GAAkBlM,GACnCoE,EAAmBmI,GAAoBvM,GAE7CvF,qBAAU,WACR,GAAIuF,GAAcoE,GAAoBoJ,EAAgB,CAIpD,IAAIC,EAAiB,IAAIC,YAAY,CAACtJ,EAAiBuJ,UAMjDC,EAA2B,kBAAMH,EAAehK,YAAYV,SAAQ,SAAA1G,GAAK,OAAIA,EAAM8E,WACzFnB,EAAWlF,GAAG,UAAW8S,GAEzB,IAAMC,EAAuB,WAC3BD,IACAH,EAAiB,IAAIC,YAAY,CAACtJ,EAAiBuJ,UACnDJ,EAAYT,GAAmBW,KAUjC,OAPAF,EAAYT,GAAmBW,IAK/BpO,OAAOzB,iBAAiB,QAASiQ,GAE1B,WACLD,IACAvO,OAAOxB,oBAAoB,QAASgQ,GACpC7N,EAAWjF,IAAI,UAAW6S,OAG7B,CAACJ,EAAgBpJ,EAAkBpE,IAEtCvF,qBAAU,WACR,IAAMqT,EAAiBR,EAAW3P,QAElC,GAAI6P,GAAkBM,GAAkBb,EAAU,CAChD,IAAMc,EAAc,IAAIC,WAAWf,EAASgB,mBAEtCC,EAAQC,cAAS,WACrBlB,EAASmB,qBAAqBL,GAI9B,IAHA,IAAIM,EAAS,EAEPlP,EAAS4O,EAAY5O,OAClBmP,EAAI,EAAGA,EAAInP,EAAQmP,IAC1BD,GAAUN,EAAYO,GAGxB,IAAMC,EAASC,KAAKC,IAAI,GAAID,KAAKE,IAAI,EAAqC,EAAlCF,KAAKG,MAAMN,EAASlP,EAAS,KAEvD,OAAd2O,QAAc,IAAdA,KAAgBc,aAAa,IAAKnD,OAAO,GAAK8C,MAC7C,KAEH,OAAO,WACLT,EAAec,aAAa,IAAK,MACjCV,EAAM/M,WAGT,CAACqM,EAAgBP,IAGpB,IAAM4B,EAAU,2BAvFYlC,MAyF5B,OAAOa,EACL,yBAAKsB,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,YAAYC,6BAAA,GACjF,8BACE,8BAAUC,GAAIJ,GACZ,0BAAMK,IAAK5B,EAAY6B,EAAE,IAAIC,EAAE,KAAKrR,MAAM,KAAKC,OAAO,SAG1D,uBAAGqR,KAAK,OAAOC,SAAS,UAAUC,UAAU,iBAC1C,0BACEC,SAAQ,eAAUX,EAAV,KACR9Q,MAAM,MACNC,OAAO,KACPmR,EAAE,MACFC,EAAE,MACFK,GAAG,IACHC,GAAG,IACHL,KAAK,YAEP,0BACEA,KAAMpK,EACN0K,YAAY,IACZC,EAAE,mjBAKR,yBACEd,MAAM,6BACN/Q,MAAM,KACNC,OAAO,KACP+Q,QAAQ,YACRQ,UAAU,qBACVM,6BAAA,GAEA,uBAAGR,KAAK,OAAOC,SAAS,WACtB,0BACED,KAAMpK,EACN0K,YAAY,IACZC,EAAE,+vBACFL,UAAU,qBAEZ,0BACEF,KAAK,MACLM,YAAY,IACZC,EAAE,uJACFL,UAAU,uBAOLO,WAAMC,KAAK1C,I,kDC3IX,SAAS2C,KAAkB,IAChCpR,EAAsBP,IAAtBO,kBAGFqR,EAFkBpU,IAAhBC,YAE4BM,MAAK,SAAAC,GAAK,MAAmB,UAAfA,EAAM0C,QAClDqF,EAAmBmI,GAAoB0D,GACvCC,EAAuB,OAAG9L,QAAH,IAAGA,OAAH,EAAGA,EAAkB+L,cAAc7P,SAOhE,OACE,6BACE,kBAAC8P,GAAA,EAAD,CAAYpE,QAAQ,YAAYqE,cAAY,GAA5C,eAGA,kBAACC,GAAA,EAAD,CAAMC,WAAS,EAACC,WAAW,SAASC,QAAQ,iBAC1C,yBAAKlL,UAAU,eACZ3G,EAAkBO,OAAS,EAC1B,kBAACuR,GAAA,EAAD,CAAavF,WAAS,GACpB,kBAACwF,GAAA,EAAD,CACEC,SAAU,SAAAC,GAAC,OAfHC,EAeoBD,EAAEpV,OAAOR,MAdjDoE,OAAOsB,aAAa4I,QAAQrL,EAA0B4S,QACvC,OAAfb,QAAe,IAAfA,KAAiB3L,QAAQ,CAAEhE,SAAU,CAAEC,MAAOuQ,MAFhD,IAAsBA,GAgBR7V,MAAOiV,GAA2B,GAClClE,QAAQ,YAEPpN,EAAkBmS,KAAI,SAAAjS,GAAM,OAC3B,kBAACkS,GAAA,EAAD,CAAU/V,MAAO6D,EAAOwB,SAAU5E,IAAKoD,EAAOwB,UAC3CxB,EAAOmS,YAMhB,kBAACb,GAAA,EAAD,MAA4B,OAAfH,QAAe,IAAfA,OAAA,EAAAA,EAAiB7L,iBAAiB6M,QAAS,mBAG5D,kBAAC,GAAD,CAAqBjR,WAAYiQ,EAAiBhL,MAAM,YC1CjD,SAASiM,KAAmB,IAAD,EAChCjS,EAAuBZ,IAAvBY,mBADgC,EAEE6L,KAAlCZ,EAFgC,EAEhCA,aAAcE,EAFkB,EAElBA,gBAChB+G,EAAiB,UAAGlS,EAAmB7C,MAAK,SAAA0C,GAAM,OAAIA,EAAOwB,WAAa4J,YAAzD,aAAG,EAAqE+G,MAE/F,OACE,yBAAK1L,UAAU,eACZtG,EAAmBE,OAAS,EAC3B,kBAACuR,GAAA,EAAD,CAAavF,WAAS,GACpB,kBAACiF,GAAA,EAAD,CAAYpE,QAAQ,YAAYqE,cAAY,GAA5C,gBAGA,kBAACM,GAAA,EAAD,CAAQC,SAAU,SAAAC,GAAC,OAAIzG,EAAgByG,EAAEpV,OAAOR,QAAkBA,MAAOiP,EAAc8B,QAAQ,YAC5F/M,EAAmB8R,KAAI,SAAAjS,GAAM,OAC5B,kBAACkS,GAAA,EAAD,CAAU/V,MAAO6D,EAAOwB,SAAU5E,IAAKoD,EAAOwB,UAC3CxB,EAAOmS,YAMhB,oCACE,kBAACb,GAAA,EAAD,CAAYpE,QAAQ,aAApB,gBACA,kBAACoE,GAAA,EAAD,KAAae,GAAqB,iCCrB5C,IAAM5R,GAAQ6R,YAAO,QAAPA,CAAgB,CAC5BrT,MAAO,OACPC,OAAQ,SASK,SAASqT,GAAT,GAAoE,IAAD,IAA7ChV,EAA6C,EAA7CA,MAAOiV,EAAsC,EAAtCA,QAASrU,EAA6B,EAA7BA,SAC7CiS,EAAM3R,iBAAyB,MAC/B6G,EAAmBmI,GAAoBlQ,GACvCkV,EChBO,SAAiClV,GAAoB,IAAD,EAC7B/B,mBAAQ,OAAC+B,QAAD,IAACA,OAAD,EAACA,EAAOkV,YADa,mBAC1DA,EAD0D,KAC9CC,EAD8C,KAmBjE,OAhBA/W,qBAAU,WAGR,GAFA+W,EAAa,OAACnV,QAAD,IAACA,OAAD,EAACA,EAAOkV,YAEjBlV,EAAO,CACT,IAAMoV,EAA0B,SAAChR,GAAD,OAC9B+Q,EAAc,CACZzT,MAAO0C,EAAS8Q,WAAWxT,MAC3BC,OAAQyC,EAAS8Q,WAAWvT,UAGhC,OADA3B,EAAMvB,GAAG,oBAAqB2W,GACvB,WACLpV,EAAMtB,IAAI,oBAAqB0W,OAGlC,CAACpV,IAEGkV,EDHYG,CAAwBrV,GACrCsV,GAAa,iBAACJ,QAAD,IAACA,OAAD,EAACA,EAAYvT,cAAb,QAAuB,IAAvB,iBAA6BuT,QAA7B,IAA6BA,OAA7B,EAA6BA,EAAYxT,aAAzC,QAAkD,GAErEtD,qBAAU,WACR,IAAMmX,EAAK1C,EAAIvR,QAMf,OALAiU,EAAGC,OAAQ,EACPxV,EAAM4G,aAAehG,GACvBZ,EAAM4G,YAAYhG,GAEpBZ,EAAMyV,OAAOF,GACN,WACLvV,EAAM0V,OAAOH,GACTvV,EAAM4G,aAAehG,GAEvBZ,EAAM4G,YAAY,SAGrB,CAAC5G,EAAOY,IAGX,IAAM+U,EAA+D,iBAA/B,OAAhB5N,QAAgB,IAAhBA,OAAA,EAAAA,EAAkB+L,cAAc8B,YAChDC,EAAQ,CACZ3C,UAAW+B,GAAWU,EAAgB,kBAAoB,GAC1DG,UAAWR,GAActV,EAAMC,KAAKC,SAAS,UAAa,UAAuB,SAGnF,OAAO,kBAACgD,GAAD,CAAO2P,IAAKA,EAAKgD,MAAOA,IErCjC,IAAMxN,GAAYC,YAAW,CAC3ByN,QAAS,CACPrU,MAAO,QACPsU,UAAW,QACXC,OAAQ,aACR,UAAW,CACTD,UAAW,YAKF,SAASE,KACtB,IAAMnN,EAAUV,KACR1F,EAAsBX,IAAtBW,kBAGFwT,EAFkB3W,IAAhBC,YAE4BM,MAAK,SAAAC,GAAK,MAAmB,UAAfA,EAAM0C,QAClDqF,EAAmBmI,GAAoBiG,GANN,EAOyBlY,mBAC9D+E,OAAOsB,aAAaC,QAAQxC,IARS,mBAOhCqU,EAPgC,KAONC,EAPM,KAUjCC,GAA0C,OAAhBvO,QAAgB,IAAhBA,OAAA,EAAAA,EAAkB+L,cAAc7P,WAAYmS,EAa5E,OACE,6BACGD,GACC,yBAAKjN,UAAWH,EAAQgN,SACtB,kBAACf,GAAD,CAAYC,SAAO,EAACjV,MAAOmW,KAG9BxT,EAAkBG,OAAS,EAC1B,kBAACuR,GAAA,EAAD,CAAavF,WAAS,GACpB,kBAACiF,GAAA,EAAD,CAAYpE,QAAQ,YAAYqE,cAAY,GAA5C,eAGA,kBAACM,GAAA,EAAD,CACEC,SAAU,SAAAC,GAAC,OAxBCC,EAwBgBD,EAAEpV,OAAOR,MArB7CyX,EAA4B5B,GAC5BzR,OAAOsB,aAAa4I,QAAQnL,EAA0B0S,QACvC,OAAf0B,QAAe,IAAfA,KAAiBlO,QAAjB,2BACMxG,GADN,IAEEwC,SAAU,CAAEC,MAAOuQ,OAPvB,IAAsBA,GAyBZ7V,MAAO0X,GAA2B,GAClC3G,QAAQ,YAEPhN,EAAkB+R,KAAI,SAAAjS,GAAM,OAC3B,kBAACkS,GAAA,EAAD,CAAU/V,MAAO6D,EAAOwB,SAAU5E,IAAKoD,EAAOwB,UAC3CxB,EAAOmS,YAMhB,oCACE,kBAACb,GAAA,EAAD,CAAYpE,QAAQ,YAAYqE,cAAY,GAA5C,eAGA,kBAACD,GAAA,EAAD,MAA4B,OAAfoC,QAAe,IAAfA,OAAA,EAAAA,EAAiBpO,iBAAiB6M,QAAS,oBCxDlE,IAAMvM,GAAYC,aAAW,SAACC,GAAD,YAAmB,CAC9C2L,WAAS,GACPxS,MAAO,QACP6U,UAAW,SAFJ,cAGNhO,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B/U,MAAO,uBAJF,cAMP,iBAAkB,CAChBA,MAAO,sBAPF,GAUT+G,OAAQ,CACNiO,MAAO,SAETC,MAAM,eACHpO,EAAMiO,YAAYC,KAAK,MAAQ,CAC9BR,OAAQ,SAGZW,SAAU,CACRC,aAAc,QACdC,SAAU,UAEZC,YAAa,CACXd,OAAQ,cACR,gBAAiB,CACfA,OAAQ,oBAKC,SAASe,GAAT,GAA2F,IAA1DrI,EAAyD,EAAzDA,KAAMC,EAAmD,EAAnDA,QAC9C7F,EAAUV,KAEhB,OACE,kBAACwG,EAAA,EAAD,CAAQF,KAAMA,EAAMC,QAASA,EAAS7F,QAAS,CAAE4N,MAAO5N,EAAQ4N,QAC9D,kBAAC3H,EAAA,EAAD,iCACA,kBAACC,EAAA,EAAD,MACA,kBAACC,EAAA,EAAD,CAAehG,UAAWH,EAAQmL,WAChC,yBAAKhL,UAAWH,EAAQgO,aACtB,kBAAChD,GAAA,EAAD,CAAYpE,QAAQ,KAAKzG,UAAWH,EAAQ6N,UAA5C,SAGA,kBAACV,GAAD,OAEF,kBAACjH,EAAA,EAAD,MACA,yBAAK/F,UAAWH,EAAQgO,aACtB,kBAAChD,GAAA,EAAD,CAAYpE,QAAQ,KAAKzG,UAAWH,EAAQ6N,UAA5C,SAGA,kBAACjD,GAAD,OAEF,yBAAKzK,UAAWH,EAAQgO,aACtB,kBAAClC,GAAD,QAGJ,kBAAC5F,EAAA,EAAD,MACA,kBAACS,EAAA,EAAD,KACE,kBAAC1G,EAAA,EAAD,CAAQJ,MAAM,UAAU+G,QAAQ,YAAYzG,UAAWH,EAAQN,OAAQQ,QAAS2F,GAAhF,U,yBCzEO,SAASqI,KACtB,OACE,yBAAKxE,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aACrE,uBAAGM,KAAK,OAAOC,SAAS,WACtB,uBAAGD,KAAK,WACN,0BACEO,EAAE,koCACFL,UAAU,kFCPP,SAASgE,KACtB,OACE,yBAAKzE,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aACrE,uBAAGM,KAAK,OAAOC,SAAS,WACtB,uBAAGD,KAAK,WACN,0BACEO,EAAE,2SACFL,UAAU,iF,mCCPP,SAASiE,KACtB,OACE,yBAAKzV,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,YAAYM,KAAK,OAAOP,MAAM,8BAChE,0BACEQ,SAAS,UACTmE,SAAS,UACT7D,EAAE,2pJACFP,KAAK,a,cCMN,IAAMqE,GAAgBtC,YAAO,MAAPA,CAAc,CACzCuC,QAAS,OACTC,eAAgB,SAChB7V,MAAO,QACP8V,YAAa,UAGA,SAASC,GAAK3O,GAC3B,IAAMjK,EAAW6Y,cAAc,SAACnP,GAAD,OAAkBA,EAAMiO,YAAYC,KAAK,SADR,EAE9BxY,oBAAS,GAFqB,mBAEzD0Z,EAFyD,KAE9CC,EAF8C,OAGhC3Z,oBAAS,GAHuB,mBAGzD4Z,EAHyD,KAG/CC,EAH+C,OAIxB7Z,oBAAS,GAJe,mBAIzD8Z,EAJyD,KAI3CC,EAJ2C,KAM1DC,EAAY/W,iBAA0B,MANoB,ECfnD,WAAgC,IACrCzB,EAAgBD,IAAhBC,YADoC,EAEQxB,oBAAS,GAFjB,mBAErCia,EAFqC,KAEjBC,EAFiB,KAGtCrY,EAAaL,EAAYM,MAAK,SAAAC,GAAK,OAAIA,EAAMC,KAAKC,SAAS,aAC3D6H,EAAmBmI,GAAoBpQ,GACrC6C,EAAsBX,IAAtBW,kBAERvE,qBAAU,YAMe,OAAG2J,QAAH,IAAGA,OAAH,EAAGA,EAAkB+L,cAAc8B,cACV,IAAvBsC,GACvBC,GAAsB,KAEvB,CAACpQ,EAAkBmQ,IAEtB,IAAME,EAAmB9X,uBAAY,WACnC,IAAM+X,EAA+D,UAA/B,OAAhBtQ,QAAgB,IAAhBA,OAAA,EAAAA,EAAkB+L,cAAc8B,YAAwB,cAAgB,OACpF,OAAV9V,QAAU,IAAVA,KAAYmI,QAAZ,2BACMxG,GADN,IAEEmU,WAAYyC,OAEb,CAACtQ,EAAkBjI,IAEtB,MAAO,CACLwY,oBAAqBxY,EACrBsY,mBACAG,oBAAqBL,GAAsBvV,EAAkBG,OAAS,GDRF0V,GAA9DF,EAPwD,EAOxDA,mBAAoBF,EAPoC,EAOpCA,iBAAkBG,EAPkB,EAOlBA,oBAE9C,OACE,oCACE,kBAACvP,EAAA,EAAD,CAAQC,QAAS,kBAAM6O,GAAY,SAAAW,GAAM,OAAKA,MAAS5F,IAAKoF,EAAW/O,UAAWJ,EAAM4P,iBACrF7Z,EACC,kBAAC,KAAD,MAEA,+CAEE,kBAAC,KAAD,QAIN,kBAAC4Y,GAAA,EAAD,CACE9I,KAAMkJ,EACNjJ,QAAS,kBAAMkJ,GAAY,SAAAW,GAAM,OAAKA,MACtCE,SAAUV,EAAU3W,QACpBsX,aAAc,CACZC,SAAU,MACVC,WAAY,QAEdC,gBAAiB,CACfF,SAAUha,GAAY,GAAK,SAC3Bia,WAAY,WAGbP,GACC,kBAAC5D,GAAA,EAAD,CAAUqE,SAAUV,EAAoBrP,QAASmP,GAC/C,kBAACf,GAAD,KACE,kBAACJ,GAAD,OAEF,kBAAClD,GAAA,EAAD,CAAYpE,QAAQ,SAApB,gBAIJ,kBAACgF,GAAA,EAAD,CAAU1L,QAAS,kBAAM+O,GAAgB,KACvC,kBAACX,GAAD,KACE,kBAACF,GAAD,OAEF,kBAACpD,GAAA,EAAD,CAAYpE,QAAQ,SAApB,6BAGF,kBAACgF,GAAA,EAAD,CAAU1L,QAAS,kBAAM2O,GAAa,KACpC,kBAACP,GAAD,KACE,kBAACH,GAAD,OAEF,kBAACnD,GAAA,EAAD,CAAYpE,QAAQ,SAApB,WAGJ,kBAAC,GAAD,CACEhB,KAAMgJ,EACN/I,QAAS,WACPgJ,GAAa,GACbE,GAAY,MAGhB,kBAACd,GAAD,CACErI,KAAMoJ,EACNnJ,QAAS,WACPoJ,GAAgB,GAChBF,GAAY,OErFP,SAASmB,KAAgB,IAC9Blb,EAASyB,IAATzB,KAD6B,EAEXE,mBAAwB,gBAFb,mBAE9BgM,EAF8B,KAEvBiP,EAFuB,KAqBrC,OAjBA9a,qBAAU,WACR,GAAIL,EAAM,CACR,IAAMob,EAAe,kBAAMD,EAASnb,EAAKkM,QAMzC,OALAkP,IACApb,EACGU,GAAG,eAAgB0a,GACnB1a,GAAG,cAAe0a,GAClB1a,GAAG,eAAgB0a,GACf,WACLpb,EACGW,IAAI,eAAgBya,GACpBza,IAAI,cAAeya,GACnBza,IAAI,eAAgBya,OAG1B,CAACpb,IAEGkM,E,cCxBM,SAASmP,KACtB,OACE,yBAAK3G,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aACrE,0BACEM,KAAK,UACLC,SAAS,UACTM,EAAE,miBCNK,SAAS8F,KACtB,OACE,yBAAK5G,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aACrE,uBAAGM,KAAK,OAAOC,SAAS,WACtB,0BACED,KAAK,UACLO,EAAE,+vBACFL,UAAU,qBAEZ,0BACEF,KAAK,MACLO,EAAE,uJACFL,UAAU,uBCLL,SAASoG,GAAkBxQ,GAAoD,IAAD,ECJ9E,WAAgC,IAEvCnF,EADkBnE,IAAhBC,YACuBM,MAAK,SAAAC,GAAK,MAAmB,UAAfA,EAAM0C,QASnD,MAAO,CARWmN,GAAkBlM,GAETrD,uBAAY,WACjCqD,IACFA,EAAWmM,UAAYnM,EAAW4V,UAAY5V,EAAW6V,YAE1D,CAAC7V,KDJyC8V,GAD8C,mBACpFC,EADoF,KACpEC,EADoE,KAGrFC,EADkBpa,IAAhBC,YAC0BgF,MAAK,SAAAzE,GAAK,MAAmB,UAAfA,EAAM0C,QAEtD,OACE,kBAACsG,EAAA,EAAD,CACEE,UAAWJ,EAAMI,UACjBD,QAAS0Q,EACTX,UAAWY,GAAiB9Q,EAAMkQ,SAClCa,UAAWH,EAAiB,kBAACN,GAAD,MAAc,kBAACC,GAAD,MAC1CS,wBAAA,GAEEF,EAA6BF,EAAiB,OAAS,SAAvC,YEpBT,SAASK,KACtB,OACE,yBAAKrY,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,YAAYM,KAAK,OAAOP,MAAM,8BAChE,0BACEQ,SAAS,UACTmE,SAAS,UACT7D,EAAE,2YACFP,KAAK,a,wBCMAgH,GAAcrc,wBAA+B,MAE7Csc,GAAyB,SAAC,GAAkB,IAAhBjc,EAAe,EAAfA,SAAe,EAC5BwB,IAAlBzB,EAD8C,EAC9CA,KAAM6B,EADwC,EACxCA,QACRsa,EAAsBhZ,kBAAO,GAFmB,EAGNjD,oBAAS,GAHH,mBAG/Ckc,EAH+C,KAG7BC,EAH6B,OAIdnc,mBAA8B,MAJhB,mBAI/Coc,EAJ+C,KAIjCC,EAJiC,OAKtBrc,mBAAoB,IALE,mBAK/Csc,EAL+C,KAKrCC,EALqC,OAMJvc,oBAAS,GANL,mBAM/Cwc,EAN+C,KAM5BC,EAN4B,OAOlBzc,qBAPkB,mBAO/C0c,EAP+C,KAOnCC,EAPmC,KAShD3U,EAAU3F,uBACd,SAAC4F,GACC2U,UAAOC,OAAO5U,GACXxF,MAAK,SAAAqa,GAEJ/X,OAAO2X,WAAaI,EACpBH,EAAcG,MAEfla,OAAM,WACLjB,EAAQ,IAAIwI,MAAM,0EAGxB,CAACxI,IAyCH,OAtCAxB,qBAAU,WACR,GAAIic,EAAc,CAChB,IAAMW,EAAqB,SAACtX,GAAD,OAAsB8W,GAAY,SAAAS,GAAW,6BAAQA,GAAR,CAAqBvX,QAG7F,OAFA2W,EAAaa,cAAcxa,MAAK,SAAAya,GAAW,OAAIX,EAAYW,EAAYC,UACvEf,EAAa5b,GAAG,eAAgBuc,GACzB,WACLX,EAAa3b,IAAI,eAAgBsc,OAGpC,CAACX,IAEJjc,qBAAU,YAEH8b,EAAoB5Y,SAAWiZ,EAASzX,QAC3C4X,GAAqB,KAEtB,CAACH,IAEJnc,qBAAU,WACR8b,EAAoB5Y,QAAU6Y,EAC1BA,GAAkBO,GAAqB,KAC1C,CAACP,IAEJ/b,qBAAU,WACJL,GAAQ4c,GACVA,EACGU,4BAA4Btd,EAAKud,KACjC5a,MAAK,SAAA6a,GAEJvY,OAAOwY,iBAAmBD,EAC1BjB,EAAgBiB,MAEjB1a,OAAM,WACLjB,EAAQ,IAAIwI,MAAM,iFAGvB,CAACrK,EAAM4c,EAAY/a,IAGpB,kBAACoa,GAAYrb,SAAb,CACEC,MAAO,CAAEub,mBAAkBC,sBAAqBnU,UAASwU,oBAAmBF,WAAUF,iBAErFrc,IChFQ,SAASyd,KACtB,IAAMtT,EAAUtK,qBAAWmc,IAC3B,IAAK7R,EACH,MAAM,IAAIC,MAAM,qDAElB,OAAOD,ECDF,IAEDE,GAAYC,YAAW,CAC3BoT,cAAe,CACbC,SAAU,WACVrE,QAAS,QAEXsE,OAAQ,CACNla,MAAO,OACPC,OAAQ,OACRka,gBAAiB,UACjBC,aAAc,MACdH,SAAU,WACVI,IAAK,OACLC,KAAM,OACNC,QAAS,EACTC,WAAW,WAAD,OAAaC,IAAb,eAEZ1B,kBAAmB,CACjBwB,QAAS,GAEXG,KAAM,CACJC,OAAQ,oBACRP,aAAc,OACdna,OAAQ,OACRD,MAAO,OACPia,SAAU,WACVK,KAAM,OACND,IAAK,OACLE,QAAS,GAEXK,YAAa,CACXC,UAAU,WAAD,OAhCqB,IAgCrB,eACTC,wBAAyB,GAE3B,oBAAqB,CACnB,KAAM,CACJtJ,UAAW,kBACX+I,QAAS,GAEX,MAAO,CACLA,QAAS,GAEX,OAAQ,CACN/I,UAAW,kBACX+I,QAAS,MAKA,SAASQ,KACtB,IAAM1T,EAAUV,KADyB,EAECpK,oBAAS,GAFV,mBAElCye,EAFkC,KAEnBC,EAFmB,OAG0ClB,KAA3EtB,EAHiC,EAGjCA,iBAAkBC,EAHe,EAGfA,oBAAqBC,EAHN,EAGMA,aAAcI,EAHpB,EAGoBA,kBAsB7D,OAhBArc,qBAAU,WACJse,GACFnW,YAAW,kBAAMoW,GAAiB,KA7DN,OA+D7B,CAACD,IAEJte,qBAAU,WACR,GAAIic,IAAiBF,EAAkB,CACrC,IAAMyC,EAAmB,kBAAMD,GAAiB,IAEhD,OADAtC,EAAa5b,GAAG,eAAgBme,GACzB,WACLvC,EAAa3b,IAAI,eAAgBke,OAGpC,CAACvC,EAAcF,IAGhB,kBAACnR,EAAA,EAAD,CACE6T,uBAAA,EACA5T,QAvBqB,WACvBmR,GAAqBD,IAuBnBnB,UAAWqB,EACXR,UACE,yBAAK3Q,UAAWH,EAAQ2S,eACtB,kBAAC3B,GAAD,MACA,yBAAK7Q,UAAWC,YAAKJ,EAAQqT,KAAT,eAAkBrT,EAAQuT,YAAcI,MAC5D,yBAAKxT,UAAWC,YAAKJ,EAAQ6S,OAAT,eAAoB7S,EAAQ0R,kBAAoBA,QAR1E,QCjFW,SAASqC,KACtB,OACE,yBAAKrK,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aACrE,uBAAGM,KAAK,OAAOC,SAAS,WACtB,0BACED,KAAK,UACLO,EAAE,siBACFL,UAAU,mBAEZ,0BACEF,KAAK,MACLC,SAAS,UACTM,EAAE,8JACFL,UAAU,qBCbL,SAAS6J,KACtB,OACE,yBAAKtK,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aACrE,0BACEM,KAAK,UACLC,SAAS,UACTM,EAAE,gbCCK,SAASyJ,GAAkBlU,GAAoD,IAAD,EAC9CvJ,IAD8C,mBACpFyB,EADoF,KACpEX,EADoE,KAErF4c,EAAmB/b,iBAAO,GACxB6B,EAAyBf,IAAzBe,qBAEFma,EAAc5c,uBAAY,WAC1BoE,KAAKC,MAAQsY,EAAiB3b,QAAU,MAC1C2b,EAAiB3b,QAAUoD,KAAKC,MAChCtE,OAED,CAACA,IAEJ,OACE,kBAAC2I,EAAA,EAAD,CACEE,UAAWJ,EAAMI,UACjBD,QAASiU,EACTlE,UAAWjW,GAAwB+F,EAAMkQ,SACzCa,UAAW7Y,EAAiB,kBAAC+b,GAAD,MAAkB,kBAACD,GAAD,OAE5C/Z,EAAoC/B,EAAiB,aAAe,cAA7C,YC1BhB,SAASmc,KACtB,OACE,yBAAK1K,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aACrE,0BACEM,KAAK,UACLC,SAAS,UACTM,EAAE,+0B,cCCK,SAAS6J,KAA6B,IAC3Crf,EAASyB,IAATzB,KAD0C,EAEUE,qBAFV,mBAE3Cof,EAF2C,KAEnBC,EAFmB,KAuClD,OAnCAlf,qBAAU,WACR,GAAIL,EAAM,CACR,IAAMwf,EAA+B,WACnCD,EACEE,MAAMC,KAAkB1f,EAAK2f,aAAa1L,UAEvC2L,OAAO5f,EAAK8B,kBACZE,MAAK,SAACxB,GAAD,OACJif,MAAMC,KAAuBlf,EAAYkH,OAAOuM,UAAUjS,MAAK,SAAAC,GAAK,OAClEA,EAAM4d,UAAU1d,SAAS,kBAenC,OAVAqd,IAEAxf,EAAKU,GAAG,iBAAkB8e,GAC1Bxf,EAAKU,GAAG,mBAAoB8e,GAC5Bxf,EAAKU,GAAG,0BAA2B8e,GAInCxf,EAAK8B,iBAAiBpB,GAAG,iBAAkB8e,GAC3Cxf,EAAK8B,iBAAiBpB,GAAG,mBAAoB8e,GACtC,WACLxf,EAAKW,IAAI,iBAAkB6e,GAC3Bxf,EAAKW,IAAI,mBAAoB6e,GAC7Bxf,EAAKW,IAAI,0BAA2B6e,GAEpCxf,EAAK8B,iBAAiBnB,IAAI,iBAAkB6e,GAC5Cxf,EAAK8B,iBAAiBnB,IAAI,mBAAoB6e,OAGjD,CAACxf,IAEGsf,ECtCF,IAKDhV,GAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACXC,OAAQ,CACN,cAAe,CACbG,MAAO,OACP,UAAW,CACToK,KAAM,eAOD,SAAS6K,GAAwB/U,GAC9C,IAAMC,EAAUV,KACVgV,EAAyBD,KACvB7V,EAAsB/H,IAAtB+H,kBACFuW,EAA2BC,QAAQV,GACnCW,EAAyBlf,UAAUsD,cAAgBtD,UAAUsD,aAAa8E,gBAC1E+W,EAAanV,EAAMkQ,UAAY8E,IAA6BE,EAE9DE,EAAiB,GAUrB,OARIJ,IACFI,EA3BkC,oDA8B/BF,IACHE,EA9BoC,qDAkCpC,kBAACC,GAAA,EAAD,CACEC,MAAOF,EACPG,UAAU,MACVC,YAAa,CAAEC,eAAe,GAC9B1I,MAAO,CAAE2I,OAAQP,EAAa,cAAgB,YAE9C,8BAGE,kBAACjV,EAAA,EAAD,CACEE,UAAWH,EAAQN,OACnBQ,QAAS1B,EACTyR,SAAUiF,EACVpE,UAAW,kBAACsD,GAAD,MACXsB,wBAAA,GAnDuB,kBCKjC,IAAMpW,GAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACX0L,UAAU,aACR2H,gBAAiBtT,EAAMmW,QAAQhW,WAAWiW,QAC1CC,OAAQ,EACR5C,KAAM,EACN6C,MAAO,EACPld,OAAO,GAAD,OAAK4G,EAAMuW,aAAX,MACNnD,SAAU,QACVrE,QAAS,OACTyH,QAAS,WACTC,OAAQ,IACPzW,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B9U,OAAO,GAAD,OAAK4G,EAAM0W,mBAAX,MACNF,QAAS,IAGbG,kBAAmB,CACjBvD,SAAU,QACVqD,OAAQ,GACRJ,OAAO,GAAD,OAAKrW,EAAMuW,aAAX,MACN9C,KAAM,EACN6C,MAAO,EACPld,OAAQ,QACR+G,WAAY,qBACZ,OAAQ,CACNE,MAAO,SAET,WAAY,CACVF,WAAY,QACZE,MAAOL,EAAMI,MACb0T,OAAO,aAAD,OAAe9T,EAAMI,OAC3BsN,OAAQ,QACR,UAAW,CACTrN,MAAO,UACPyT,OAAO,oBACP3T,WAAY,aAIlByW,WAAW,aACT7H,QAAS,WACR/O,EAAMiO,YAAYC,KAAK,MAAQ,CAC9Ba,QAAS,cAMF,SAAS8H,KACtB,IAAMrW,EAAUV,KADgB,EAEe7I,IAAvCiI,EAFwB,EAExBA,gBAAiBF,EAFO,EAEPA,kBAEnB8X,EAA+B,iBADnBpG,KAEVlb,EAASyB,IAATzB,KAER,OACE,oCACG0J,GACC,kBAACwM,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,SAASD,WAAW,SAASjL,UAAWH,EAAQmW,mBACtE,kBAACnL,GAAA,EAAD,CAAYpE,QAAQ,MAApB,+BACA,kBAAC3G,EAAA,EAAD,CAAQC,QAAS,kBAAM1B,MAAvB,iBAGJ,4BAAQ2B,UAAWH,EAAQmL,WACzB,kBAACD,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,eAAeD,WAAW,UAChD,kBAACmL,GAAA,EAAD,CAAQC,QAAM,GACZ,kBAACtL,GAAA,EAAD,CAAM4B,MAAO,CAAE2J,KAAM,IACnB,kBAACzL,GAAA,EAAD,CAAYpE,QAAQ,SAAS5R,EAAMkC,QAGvC,kBAACgU,GAAA,EAAD,CAAMwL,MAAI,GACR,kBAACxL,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,UACtB,kBAACkF,GAAD,CAAmBN,SAAUqG,IAC7B,kBAACrC,GAAD,CAAmBhE,SAAUqG,KAC3B5X,IAAoB5I,GAAY,kBAACgf,GAAD,CAAyB7E,SAAUqG,IACb,SAAvDlV,iKAAYU,wCAAqD,kBAAC4R,GAAD,QAGtE,kBAAC6C,GAAA,EAAD,CAAQC,QAAM,GACZ,kBAACtL,GAAA,EAAD,CAAM4B,MAAO,CAAE2J,KAAM,IACnB,kBAACvL,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,YACtB,kBAAC,GAAD,MACA,kBAACvL,EAAD,YC5FhB,IAAMR,GAAYC,aAAW,SAACC,GAAD,MAAmB,CAC9C2L,UAAU,aACRxL,WAAY,QACZgX,YAAa,MACbpI,QAAS,OACT3V,OAAO,GAAD,OAAK4G,EAAMoX,mBAAX,OACLpX,EAAMiO,YAAYC,KAAK,MAAQ,CAC9Ba,QAAS,SAGbsI,cAAe,CACbje,OAAQ,OACRmV,SAAU,UACViI,QAAS,WAEXc,eAAe,eACZtX,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B9U,OAAQ,OACRme,SAAU,OACVzD,OAAQ,+BACR0C,QAAS,EACT9I,OAAQ,cAKC,SAAS8J,KACtB,IAAMhX,EAAUV,KACRtK,EAASyB,IAATzB,KAER,OACE,kBAACkW,GAAA,EAAD,CAAMC,WAAS,EAACC,WAAW,SAASC,QAAQ,gBAAgBlL,UAAWH,EAAQmL,WAC7E,kBAACH,GAAA,EAAD,CAAYpE,QAAQ,aAAa5R,EAAMkC,MACvC,6BACE,kBAAC4I,EAAD,CAAeK,UAAWH,EAAQ6W,gBAClC,kBAAC,GAAD,CAAMlH,gBAAiB3P,EAAQ8W,mB,cCvCxB,SAASG,KACtB,OACE,yBAAKvN,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aACrE,uBAAGM,KAAK,OAAOC,SAAS,WACtB,4BAAQgN,GAAG,OAAOC,GAAG,OAAOC,EAAE,OAAOnN,KAAK,SAC1C,0BACEA,KAAK,UACLoN,eAAe,QACf7M,EAAE,szBCLG,SAAS8M,KAA4B,IAE5C1c,EADkBnE,IAAhBC,YACuBM,MAAK,SAAAC,GAAK,MAAmB,UAAfA,EAAM0C,QAEnD,OAAO,kBAAC,GAAD,CAAqBiB,WAAYA,ICD1C,IAAM0E,GAAYC,aAAW,SAACC,GAAD,MAAmB,CAC9C2L,UAAW,CACTyH,SAAU,WACVha,OAAQ,EACR2e,SAAU,SACVC,WAAW,GAAD,OAAM,MAAN,KACV7X,WAAY,SAEd8X,eAAgB,CACd7E,SAAU,WACVI,IAAK,EACLC,KAAM,EACNta,MAAO,OACPC,OAAQ,QAEV8e,kBAAmB,CACjB9E,SAAU,WACViD,OAAQ,EACRI,OAAQ,GAEV0B,SAAU,CACRhY,WAAY,qBACZE,MAAO,QACPmW,QAAS,eACT9I,OAAQ,EACRqB,QAAS,OACTnD,WAAY,UAEdwM,gBAAgB,aACdrJ,QAAS,OACTnD,WAAY,SACZoD,eAAgB,SAChB7O,WAAY,QACZiT,SAAU,WACVI,IAAK,EACL8C,MAAO,EACPD,OAAQ,EACR5C,KAAM,EACNgD,OAAQ,GACPzW,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B,QAAS,CACPvD,UAAW,oBAMJ,SAAS0N,GAAT,GAAgE,IAAnCF,EAAkC,EAAlCA,SACpC3X,EAAUV,KAGVvI,EAFkBN,IAAhBC,YAEuBM,MAAK,SAAAC,GAAK,OAAIA,EAAMC,KAAKC,SAAS,aAEjE,OACE,yBAAKgJ,UAAWH,EAAQmL,WACtB,yBAAKhL,UAAWH,EAAQyX,gBACrB1gB,EACC,kBAACkV,GAAD,CAAYhV,MAAOF,EAAYmV,SAAO,IAEtC,yBAAK/L,UAAWH,EAAQ4X,iBACtB,kBAACX,GAAD,QAKN,yBAAK9W,UAAWH,EAAQ0X,mBACtB,0BAAMvX,UAAWH,EAAQ2X,UACvB,kBAACL,GAAD,MACA,kBAACtM,GAAA,EAAD,CAAYpE,QAAQ,QAAQ/G,MAAM,UAAUiY,UAAU,QACnDH,M,wBCzDAI,GAAsC,CACjD,CACElM,MAAO,iBACPhW,MAAO,MACPmiB,WAAY,CAAErf,MAAO,IAAKC,OAAQ,KAEpC,CACEiT,MAAO,kBACPhW,MAAO,MACPmiB,WAAY,CAAErf,MAAO,IAAKC,OAAQ,MAEpC,CACEiT,MAAO,kBACPhW,MAAO,MACPmiB,WAAY,CAAErf,MAAO,IAAKC,OAAQ,MAEpC,CACEiT,MAAO,mBACPhW,MAAO,OACPmiB,WAAY,CAAErf,MAAO,IAAKC,OAAQ,MAEpC,CACEiT,MAAO,sBACPhW,MAAO,OACPmiB,WAAY,CAAErf,MAAO,IAAKC,OAAQ,MAEpC,CACEiT,MAAO,uBACPhW,MAAO,OACPmiB,WAAY,CAAErf,MAAO,KAAMC,OAAQ,MAErC,CACEiT,MAAO,uBACPhW,MAAO,OACPmiB,WAAY,CAAErf,MAAO,KAAMC,OAAQ,MAErC,CACEiT,MAAO,kCACPhW,MAAO,gBACPmiB,WAAY,CAAErf,MAAO,KAAMC,OAAQ,OAErC,CACEiT,MAAO,oCACPhW,MAAO,YACPmiB,WAAY,CAAErf,MAAO,KAAMC,OAAQ,OAErC,CACEiT,MAAO,iBACPhW,MAAO,UACPmiB,gBAAYhc,IAIT,SAASic,GAAcpiB,GAA+B,IAAD,EAC1D,GAAqB,qBAAVA,EAIX,iBAAOkiB,GAAiB/gB,MAAK,SAAA0f,GAAI,OAAIA,EAAK7gB,QAAUA,YAApD,aAAO,EAAqDmiB,WCvD9D,IAAM1Y,GAAYC,aAAW,SAACC,GAAD,YAAmB,CAC9C2L,WAAS,GACPxS,MAAO,QACP6U,UAAW,SAFJ,cAGNhO,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B/U,MAAO,uBAJF,cAMP,iBAAkB,CAChBA,MAAO,sBAPF,GAUT+G,OAAQ,CACNiO,MAAO,SAETC,MAAM,eACHpO,EAAMiO,YAAYC,KAAK,MAAQ,CAC9BR,OAAQ,SAGZgL,YAAa,CACX3J,QAAS,QACTrB,OAAQ,UACR,gBAAiB,CACfA,OAAQ,gBAGZrB,MAAO,CACLlT,MAAO,YAILwf,GAAc,SAAC5hB,GAAD,MAAkC,qBAARA,EAAsB,UAAYA,GAE1E6hB,GAAuBL,GAAiBpM,KAAI,gBAAGE,EAAH,EAAGA,MAAOhW,EAAV,EAAUA,MAAV,OAChD,kBAAC+V,GAAA,EAAD,CAAU/V,MAAOA,EAAOS,IAAKT,GAC1BgW,MAIU,SAASwM,GAAT,GAA6F,IAA1DzS,EAAyD,EAAzDA,KAAMC,EAAmD,EAAnDA,QAChD7F,EAAUV,KADyF,EAEnEoG,KAA9BL,EAFiG,EAEjGA,SAAUC,EAFuF,EAEvFA,gBAEZ4P,EAA2B,iBADfhF,KAGZoI,EAAe/gB,uBACnB,SAACkU,GACCnG,EAAgB,CAAEpO,KAAMuU,EAAEpV,OAAOa,KAAwBrB,MAAO4V,EAAEpV,OAAOR,UAE3E,CAACyP,IAGGiT,EAAqBhhB,uBACzB,SAACkU,GACM,QAAQxV,KAAKwV,EAAEpV,OAAOR,QAAkByiB,EAAa7M,KAE5D,CAAC6M,IAGH,OACE,kBAACxS,EAAA,EAAD,CAAQF,KAAMA,EAAMC,QAASA,EAAS7F,QAAS,CAAE4N,MAAO5N,EAAQ4N,QAC9D,kBAAC3H,EAAA,EAAD,4BACA,kBAACC,EAAA,EAAD,MACA,kBAACC,EAAA,EAAD,CAAehG,UAAWH,EAAQmL,WAChC,kBAACD,GAAA,EAAD,CAAMC,WAAS,EAACqN,QAAS,GACvB,kBAACtN,GAAA,EAAD,CAAMwL,MAAI,EAAC+B,GAAI,IACb,kBAACzN,GAAA,EAAD,CAAY0N,QAASxD,EAAYtO,QAAQ,SAAzC,+DAKF,kBAACsE,GAAA,EAAD,CAAMwL,MAAI,EAACiC,GAAI,EAAGF,GAAI,IACpB,kBAACnN,GAAA,EAAD,CAAanL,UAAWH,EAAQkY,aAC9B,kBAACU,GAAA,EAAD,CAAY/O,GAAI9I,EAAYP,yBAA5B,8BACA,kBAAC+K,GAAA,EAAD,CACExF,WAAS,EACTkK,SAAUiF,EACVhe,KAAM6J,EAAYP,wBAClBqL,MAAO9K,EAAYP,wBACnB3K,MAAOsiB,GAAY9S,EAAS7E,yBAC5BgL,SAAU8M,GAEV,kBAAC1M,GAAA,EAAD,CAAU/V,MAAM,OAAhB,OACA,kBAAC+V,GAAA,EAAD,CAAU/V,MAAM,YAAhB,YACA,kBAAC+V,GAAA,EAAD,CAAU/V,MAAM,QAAhB,QACA,kBAAC+V,GAAA,EAAD,CAAU/V,MAAM,WAAhB,oBAIJ,kBAACyV,GAAA,EAAD,CAAanL,UAAWH,EAAQkY,aAC9B,kBAACU,GAAA,EAAD,CAAY/O,GAAI9I,EAAYR,oBAA5B,0BACA,kBAACgL,GAAA,EAAD,CACExF,WAAS,EACTkK,SAAUiF,EACVhe,KAAM6J,EAAYR,mBAClBsL,MAAO9K,EAAYR,mBACnB1K,MAAOsiB,GAAY9S,EAAS9E,oBAC5BiL,SAAU8M,GAEV,kBAAC1M,GAAA,EAAD,CAAU/V,MAAM,aAAhB,aACA,kBAAC+V,GAAA,EAAD,CAAU/V,MAAM,YAAhB,YACA,kBAAC+V,GAAA,EAAD,CAAU/V,MAAM,YAAhB,YACA,kBAAC+V,GAAA,EAAD,CAAU/V,MAAM,WAAhB,oBAIJ,kBAACyV,GAAA,EAAD,CAAanL,UAAWH,EAAQkY,aAC9B,kBAACU,GAAA,EAAD,CAAY/O,GAAI9I,EAAYN,sBAA5B,SACA,kBAAC8K,GAAA,EAAD,CACExF,WAAS,EACTkK,SAAUiF,EACVhe,KAAM6J,EAAYN,qBAClBoL,MAAO9K,EAAYN,qBACnB5K,MAAOsiB,GAAY9S,EAAS5E,sBAC5B+K,SAAU8M,GAEV,kBAAC1M,GAAA,EAAD,CAAU/V,MAAM,QAAhB,QACA,kBAAC+V,GAAA,EAAD,CAAU/V,MAAM,iBAAhB,iBACA,kBAAC+V,GAAA,EAAD,CAAU/V,MAAM,gBAAhB,gBACA,kBAAC+V,GAAA,EAAD,CAAU/V,MAAM,WAAhB,oBAIJ,kBAACyV,GAAA,EAAD,CAAanL,UAAWH,EAAQkY,aAC9B,kBAACW,GAAA,EAAD,CACE5I,SAAUiF,EACVnP,WAAS,EACT8D,GAAI9I,EAAYL,UAChBmL,MAAM,aACNiN,YAAY,2BACZ5hB,KAAM6J,EAAYL,UAClB7K,MAAOsiB,GAAY9S,EAAS3E,WAC5B8K,SAAU+M,KAId,kBAACjN,GAAA,EAAD,CAAanL,UAAWH,EAAQkY,aAC9B,kBAACW,GAAA,EAAD,CACE5I,SAAUiF,EACVnP,WAAS,EACT8D,GAAI9I,EAAYJ,gBAChBkL,MAAM,oBACNiN,YAAY,2BACZ5hB,KAAM6J,EAAYJ,gBAClB9K,MAAOsiB,GAAY9S,EAAS1E,iBAC5B6K,SAAU+M,MAIhB,kBAACrN,GAAA,EAAD,CAAMwL,MAAI,EAACiC,GAAI,EAAGF,GAAI,IACpB,kBAACnN,GAAA,EAAD,CAAavF,WAAS,EAAC5F,UAAWH,EAAQkY,aACxC,kBAACU,GAAA,EAAD,CAAY/O,GAAI9I,EAAYH,mBAAoBT,UAAWH,EAAQ6L,OAAnE,oCAGA,kBAACN,GAAA,EAAD,CACExF,WAAS,EACTkK,SAAUiF,EACVhe,KAAM6J,EAAYH,mBAClBiL,MAAO9K,EAAYH,mBACnB/K,MAAOsiB,GAAY9S,EAASzE,oBAC5B4K,SAAU8M,GAETF,KAIL,kBAAC9M,GAAA,EAAD,CAAavF,WAAS,EAAC5F,UAAWH,EAAQkY,aACxC,kBAACU,GAAA,EAAD,CAAY/O,GAAI9I,EAAYF,wBAAyBV,UAAWH,EAAQ6L,OAAxE,yCAGA,kBAACN,GAAA,EAAD,CACExF,WAAS,EACTkK,SAAUiF,EACVhe,KAAM6J,EAAYF,wBAClBgL,MAAO9K,EAAYF,wBACnBhL,MAAOsiB,GAAY9S,EAASxE,yBAC5B2K,SAAU8M,GAETF,KAIL,kBAAC9M,GAAA,EAAD,CAAavF,WAAS,EAAC5F,UAAWH,EAAQkY,aACxC,kBAACU,GAAA,EAAD,CAAY/O,GAAI9I,EAAYD,oBAAqBX,UAAWH,EAAQ6L,OAApE,qCAGA,kBAACN,GAAA,EAAD,CACExF,WAAS,EACTkK,SAAUiF,EACVhe,KAAM6J,EAAYD,oBAClB+K,MAAO9K,EAAYD,oBACnBjL,MAAOsiB,GAAY9S,EAASvE,qBAC5B0K,SAAU8M,GAETF,QAMX,kBAAClS,EAAA,EAAD,MACA,kBAACS,EAAA,EAAD,KACE,kBAAC1G,EAAA,EAAD,CAAQE,UAAWH,EAAQN,OAAQG,MAAM,UAAU+G,QAAQ,YAAY1G,QAAS2F,GAAhF,UCnNR,IAAMvG,GAAYC,YAAW,CAC3BuX,eAAgB,CACd5J,OAAQ,eAIG,SAAS6L,GAAT,GAA8E,IAAtDC,EAAqD,EAArDA,kBAC/BhZ,EAAUV,KACRiE,EAAamC,KAAbnC,SACFzN,EAAW6Y,cAAc,SAACnP,GAAD,OAAkBA,EAAMiO,YAAYC,KAAK,SAHkB,EAI1DxY,oBAAS,GAJiD,mBAInF4Z,EAJmF,KAIzEC,EAJyE,OAKxD7Z,oBAAS,GAL+C,mBAKnF0Z,EALmF,KAKxEC,EALwE,OAMtC3Z,oBAAS,GAN6B,mBAMnF+jB,EANmF,KAM/DC,EAN+D,OAO9BhkB,oBAAS,GAPqB,mBAOnFikB,EAPmF,KAO3DC,EAP2D,KASpFlK,EAAY/W,iBAA0B,MAE5C,OACE,oCACGrC,EACC,kBAACmK,EAAA,EAAD,CACE6J,IAAKoF,EACLhP,QAAS,kBAAM6O,GAAY,IAC3B+B,UAAW,kBAAC,KAAD,MACX3Q,UAAW6Y,GAJb,QASA,kBAAC/Y,EAAA,EAAD,CACE6J,IAAKoF,EACLhP,QAAS,kBAAM6O,GAAY,IAC3B+B,UAAW,kBAAC1C,GAAD,MACXjO,UAAWH,EAAQ8W,gBAJrB,YASF,kBAACpI,GAAA,EAAD,CACE9I,KAAMkJ,EACNjJ,QAAS,kBAAMkJ,GAAY,SAAAW,GAAM,OAAKA,MACtCE,SAAUV,EAAU3W,QACpB8gB,mBAAoB,KACpBxJ,aAAc,CACZC,SAAU,MACVC,WAAYja,EAAW,OAAS,SAElCka,gBAAiB,CACfF,SAAUha,GAAY,IAAM,GAC5Bia,WAAY,WAGd,kBAACnE,GAAA,EAAD,CAAU1L,QAAS,kBAAM2O,GAAa,KACpC,kBAAC7D,GAAA,EAAD,CAAYpE,QAAQ,SAApB,UAEF,kBAACgF,GAAA,EAAD,CAAU1L,QAAS,kBAAMgZ,GAAsB,KAC7C,kBAAClO,GAAA,EAAD,CAAYpE,QAAQ,SAApB,6BAEY,iBAAbrD,GAA4C,OAAbA,GAC9B,kBAACqI,GAAA,EAAD,CAAU1L,QAAS,kBAAMkZ,GAA0B,KACjD,kBAACpO,GAAA,EAAD,CAAYpE,QAAQ,SAApB,yBAIN,kBAAC,GAAD,CACEhB,KAAMgJ,EACN/I,QAAS,WACPgJ,GAAa,GACbE,GAAY,MAGhB,kBAACd,GAAD,CACErI,KAAMqT,EACNpT,QAAS,WACPqT,GAAsB,GACtBnK,GAAY,MAGhB,kBAACsJ,GAAD,CACEzS,KAAMuT,EACNtT,QAAS,WACPuT,GAA0B,GAC1BrK,GAAY,OCpFtB,IAAMzP,GAAYC,aAAW,SAACC,GAAD,MAAmB,CAC9CyL,aAAc,CACZ6C,aAAc,OAEhBwL,UAAW,CACTA,UAAW,OAEbC,aAAc,CACZ5gB,MAAO,OACP2a,OAAQ,iBACRpG,OAAQ,SAEVsM,sBAAsB,aACpBC,aAAc,OACbja,EAAMiO,YAAYC,KAAK,MAAQ,CAC9BsI,QAAS,YAGb0D,YAAY,aACVnL,QAAS,OACTC,eAAgB,iBACfhP,EAAMiO,YAAYC,KAAK,MAAQ,CAC9BiM,cAAe,iBACfhhB,MAAO,OACP,WAAY,CACVuU,OAAQ,aAId0M,gBAAgB,eACbpa,EAAMiO,YAAYC,KAAK,MAAQ,CAC9Ba,QAAS,OACTC,eAAgB,gBAChBtB,OAAQ,gBAGZ2M,aAAc,CACZ7D,QAAS,UACT9I,OAAQ,OAUG,SAAS4M,GAAT,GAAyF,IAAxD5iB,EAAuD,EAAvDA,KAAM6iB,EAAiD,EAAjDA,SAAUC,EAAuC,EAAvCA,QACxDha,EAAUV,KADqF,EAEpEoG,KAAzBjC,EAF6F,EAE7FA,SAAUmB,EAFmF,EAEnFA,WACDqV,EAAgBvH,KAAzBxV,QAH6F,EAI7BzG,IAAvDyjB,EAJoF,EAI7Fhd,QAAuBnC,EAJsE,EAItEA,uBAAwBgC,EAJ8C,EAI9CA,aACjDod,EAAiBvV,GAAc7J,GAA0BgC,EAS/D,OAAI6H,GAAc7H,EAEd,kBAACmO,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,SAASD,WAAW,SAASgP,UAAU,SAAStN,MAAO,CAAElU,OAAQ,SACvF,6BACE,kBAACyhB,GAAA,EAAD,CAAkBzT,QAAQ,mBAE5B,6BACE,kBAACoE,GAAA,EAAD,CAAYpE,QAAQ,QAAQkG,MAAO,CAAEwN,WAAY,OAAQvM,SAAU,SAAnE,qBASN,oCACE,kBAAC/C,GAAA,EAAD,CAAYpE,QAAQ,KAAKzG,UAAWH,EAAQiL,cAA5C,QACQ8O,GAGR,kBAAC7O,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,UACtB,kBAACH,GAAA,EAAD,CAAMwL,MAAI,EAAC6D,GAAI,EAAG5B,GAAI,GAAIF,GAAI,IAC5B,yBAAKtY,UAAWH,EAAQwZ,uBACtB,kBAAC3B,GAAD,CAAmBF,SAAUzgB,KAE/B,yBAAKiJ,UAAWH,EAAQ4Z,iBACtB,kBAACrD,GAAA,EAAD,CAAQiE,MAAI,GACV,kBAACjK,GAAD,CAAmBpQ,UAAWH,EAAQ6Z,aAAc5J,SAAUkK,IAC9D,kBAAClG,GAAD,CAAmB9T,UAAWH,EAAQ6Z,aAAc5J,SAAUkK,KAEhE,kBAACpB,GAAD,CAAcC,kBAAmBhZ,EAAQ6Z,iBAG7C,kBAAC3O,GAAA,EAAD,CAAMwL,MAAI,EAAC6D,GAAI,EAAG5B,GAAI,GAAIF,GAAI,IAC5B,kBAACvN,GAAA,EAAD,CAAMC,WAAS,EAACiP,UAAU,SAAS/O,QAAQ,gBAAgByB,MAAO,CAAElU,OAAQ,SAC1E,6BACE,kBAAC2d,GAAA,EAAD,CAAQC,QAAM,GACZ,kBAACjG,GAAD,CAAmBpQ,UAAWH,EAAQuZ,aAActJ,SAAUkK,IAC9D,kBAAClG,GAAD,CAAmB9T,UAAWH,EAAQuZ,aAActJ,SAAUkK,MAGlE,yBAAKha,UAAWH,EAAQ0Z,aACtB,kBAACzZ,EAAA,EAAD,CAAQ2G,QAAQ,WAAW/G,MAAM,UAAUK,QAAS,kBAAM8Z,EAAQS,GAAMC,gBAAxE,UAGA,kBAACza,EAAA,EAAD,CACE2G,QAAQ,YACR/G,MAAM,UACN8a,oBAAA,EACAza,QAzDK,WACjBuD,EAASvM,EAAM6iB,GAAUpiB,MAAK,SAAAwF,GAC5B+c,EAAa/c,GAC0C,SAAvDiE,iKAAYU,wCAAqDmY,EAAY9c,OAuDnE8S,SAAUkK,GALZ,iBCtHC,SAASS,KACtB,OACE,yBAAKlR,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aACrE,uBAAGM,KAAK,OAAOC,SAAS,WACtB,0BACED,KAAK,OACLO,EAAE,8bAEJ,0BACEP,KAAK,UACLO,EAAE,+qBCVG,SAASqQ,GAAW9a,GACjC,OACE,uCAAKkK,KAAK,UAAUP,MAAM,6BAA6B/Q,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aAAgB5J,GACpG,0BAAMyK,EAAE,wc,wCCCIjL,aAAW,CAC3Bub,IAAK,CACHjb,MAAO,QACPiT,gBAAiB,aCDrB,IAAMxT,GAAYC,YAAW,CAC3Bwb,cAAe,CACbnI,SAAU,WACVI,IAAK,EACL8C,MAAO,EACP5I,OAAQ,MACRqB,QAAS,OACTnD,WAAY,UAEd4P,WAAY,CACVnb,MAAO,SAETob,WAAY,CACVpb,MAAO,QACP4V,OAAQ,UACRO,QAAS,eA4DEkF,GAxDY,WACzB,IAAMlb,EAAUV,KADe,EAELoG,KAAZnB,GAFiB,EAEvBpB,KAFuB,EAEjBoB,SACN7N,EAAgBD,IAAhBC,YAHuB,EAKCxB,oBAAS,GALV,mBAQzBimB,GARyB,UAMbhjB,iBAA0B,MAEtBZ,uBAAY,WAChCb,EAAYiH,SAAQ,SAAA1G,GAAK,OAAIA,EAAM8E,UAC5B,OAAPwI,QAAO,IAAPA,SACC,CAAC7N,EAAa6N,KAGf,OACE,yBAAKpE,UAAWH,EAAQ+a,eACtB,kBAACK,GAAA,EAAD,CAAMlb,QAASib,EAAehb,UAAWH,EAAQib,YAAjD,YClCF3b,GAAYC,aAAW,SAACC,GAAD,MAAmB,CAC9CG,WAAY,CACV4O,QAAS,OACTnD,WAAY,SACZoD,eAAgB,SAChB7O,WAAY,kBACZ/G,OAAQ,QAEVuS,UAAW,CACTyH,SAAU,WACV6D,KAAM,KAERgB,eAAe,aACblJ,QAAS,OACT5V,MAAO,QACPC,OAAQ,QACRma,aAAc,MACdsI,UAAW,wCACX9D,SAAU,SACV3E,SAAU,WACV1F,OAAQ,QACP1N,EAAMiO,YAAYC,KAAK,MAAQ,CAC9Ba,QAAS,QACT3V,OAAQ,OACRD,MAAO,oBACPuU,OAAQ,OACRlH,SAAU,UAGdsV,gBAAgB,aACd1I,SAAU,WACVrE,QAAS,OACTnD,WAAY,SACZoD,eAAgB,SAChB+M,gBC3CQ,s8CD4CRC,eAAgB,QAChB7iB,MAAO,SACN6G,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B/U,MAAO,OACPC,OAAQ,QACR6iB,oBAAqB,UAGzBC,cAAc,aACZ9I,SAAU,WACVja,MAAO,QACPgjB,UAAW,UACVnc,EAAMiO,YAAYC,KAAK,MAAQ,CAC9Ba,QAAS,OACTnD,WAAY,SACZzS,MAAO,MACPgjB,UAAW,UACX,QAAS,CACP/iB,OAAQ,UAIdgjB,WAAY,CACVhJ,SAAU,WACVI,IAAK,EACLC,KAAM,EACN/F,OAAQ,QAEV2O,QAAQ,aACNlc,WAAY,QACZhH,MAAO,OACPqd,QAAS,MACTS,KAAM,GACLjX,EAAMiO,YAAYC,KAAK,MAAQ,CAC9BsI,QAAS,QAGbX,MAAM,aACJxV,MAAO,QACPqN,OAAQ,WACP1N,EAAMiO,YAAYC,KAAK,MAAQ,CAC9BR,OAAQ,EACRa,SAAU,eAmCD+N,GA1BQ,SAAC/b,GACtB,IAAMC,EAAUV,KACR6D,EAASuC,KAATvC,KACFW,EAAWiY,cAEjB,OACE,yBAAK5b,UAAWH,EAAQL,YACtB,kBAACkb,GAAD,CAAY1a,UAAWH,EAAQ4b,aAC9BzY,GAA8B,WAAtBW,EAASO,UAAyB,kBAAC,GAAD,MAC3C,yBAAKlE,UAAWH,EAAQmL,WACtB,yBAAKhL,UAAWH,EAAQyX,gBACtB,yBAAKtX,UAAWH,EAAQsb,iBACtB,yBAAKnb,UAAWH,EAAQ0b,eACtB,kBAACd,GAAD,MACA,kBAAC5P,GAAA,EAAD,CAAYpE,QAAQ,KAAKzG,UAAWH,EAAQqV,OAA5C,+BAKJ,yBAAKlV,UAAWH,EAAQ6b,SAAU9b,EAAM9K,c,qBEhHnC,SAAS+mB,KACtB,OACE,yBAAKrjB,MAAM,OAAOC,OAAO,OAAO+Q,QAAQ,YAAYpD,QAAQ,MAAMmD,MAAM,8BACtE,uBAAGuS,OAAO,OAAO1R,YAAY,IAAIN,KAAK,OAAOC,SAAS,WACpD,uBAAGC,UAAU,sCAAsCF,KAAK,WACtD,uBAAGE,UAAU,qCACX,uBAAGA,UAAU,mCACX,0BACEK,EAAE,q+BACFX,GAAG,e,wBCTJ,SAASqS,KACtB,OACE,yBAAKvjB,MAAM,OAAOC,OAAO,OAAO+Q,QAAQ,YAAYpD,QAAQ,MAAMmD,MAAM,8BACtE,uBAAGuS,OAAO,OAAO1R,YAAY,IAAIN,KAAK,OAAOC,SAAS,WACpD,uBAAGC,UAAU,sCAAsCF,KAAK,WACtD,uBAAGE,UAAU,qCACX,uBAAGA,UAAU,mCACX,0BAAMK,EAAE,46BCOtB,IAAMlL,GAAYC,aAAW,SAACC,GAAD,MAAmB,CAC9C2L,UAAU,aACRoD,QAAS,OACTnD,WAAY,WACZoD,eAAgB,gBAChB7V,MAAO,QACP6U,UAAW,OACX7N,WAAY,QACZqW,QAAS,MACTjD,aAAc,MACdsI,UAAW,sCACV7b,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B/U,MAAO,SAGXwjB,iBAAkB,CAChB5N,QAAS,QAEXoE,cAAe,CACbpE,QAAS,OACTyH,QAAS,kBACT7L,UAAW,mBAEb0D,SAAU,CACRyM,WAAY,QAEd9f,MAAO,CACL4hB,WAAY,qBAEdC,QAAS,CACPD,WAAY,yBAID,SAASE,GAAT,GAAqF,IAAD,EAAhEzO,EAAgE,EAAhEA,SAAUlT,EAAsD,EAAtDA,QAASiM,EAA6C,EAA7CA,QAAShB,EAAoC,EAApCA,KAAM2W,EAA8B,EAA9BA,YAC7Dvc,EAAUV,KAUhB,OACE,kBAAC,KAAD,CACEuQ,aAAc,CACZC,SAAU,MACVC,WAAY,SAEdnK,KAAMA,EACNC,QAfkB,SAACjH,EAA4C4d,GAClD,cAAXA,IAIO,OAAXD,QAAW,IAAXA,UAYE,yBACEpc,UAAWC,YAAKJ,EAAQmL,WAAT,mBACZnL,EAAQxF,MAAoB,UAAZoM,GADJ,cAEZ5G,EAAQqc,QAAsB,YAAZzV,GAFN,KAKf,yBAAKzG,UAAWH,EAAQmc,kBACtB,yBAAKhc,UAAWH,EAAQ2S,eACT,YAAZ/L,GAAyB,kBAACsV,GAAD,MACb,UAAZtV,GAAuB,kBAACoV,GAAD,OAE1B,6BACE,kBAAChR,GAAA,EAAD,CAAYpE,QAAQ,QAAQzG,UAAWH,EAAQ6N,SAAUiK,UAAU,QAChEjK,GAEH,kBAAC7C,GAAA,EAAD,CAAYpE,QAAQ,QAAQkR,UAAU,QACnC,IACAnd,KAIP,6BACG4hB,GACC,kBAACE,GAAA,EAAD,CAAYC,KAAK,QAAQC,aAAW,QAAQ9c,MAAM,UAAUK,QAASqc,GACnE,kBAAC,KAAD,CAAWxO,SAAS,cClCnB,SAAS6O,GAAT,GAA2D,IAA7BpiB,EAA4B,EAA5BA,MAA4B,EAChBvB,IAA/Ca,EAD+D,EAC/DA,qBAAsBE,EADyC,EACzCA,qBAEtBe,EAA2BtE,IAA3BsE,uBAH+D,EAKjB7F,oBAAS,GALQ,mBAKhE2nB,EALgE,KAK3CC,EAL2C,KAOjEC,GACHF,IACA9hB,IACAia,QAAQxa,KAAWV,IAAyBE,GAVwB,EAvDlE,SAA4BgjB,EAAmBC,EAAmBziB,GACvE,IAAIqT,EAAW,GACXlT,EAAU,GAEd,QAAQ,GAEN,IAAqB,qBAAX,OAALH,QAAK,IAALA,OAAA,EAAAA,EAAOtD,MACV2W,EAAW,0BAITlT,EAFqB,gCAAnBH,EAAOG,QAGP,qIAGA,qIAGJ,MAGF,IAAqB,mBAAX,OAALH,QAAK,IAALA,OAAA,EAAAA,EAAOtD,MACV2W,EAAW,oCACXlT,EACE,oHACF,MAIF,KAAKqa,QAAQxa,GACXqT,EAAW,yBACXlT,EAAO,UAAMH,EAAOtD,KAAb,YAAqBsD,EAAOG,SACnC,MAEF,KAAMqiB,IAAaC,EACjBpP,EAAW,oCACXlT,EAAU,qEACV,MAEF,KAAMsiB,EACJpP,EAAW,sBACXlT,EAAU,4DACV,MAEF,KAAMqiB,EACJnP,EAAW,0BACXlT,EAAU,6DAGd,MAAO,CACLkT,WACAlT,WAgB4BuiB,CAAmBpjB,EAAsBE,EAAsBQ,GAArFqT,EAZ+D,EAY/DA,SAAUlT,EAZqD,EAYrDA,QAElB,OACE,kBAAC,GAAD,CACEiL,KAAMmX,EACNR,YAAa,kBAAMO,GAAuB,IAC1CjP,SAAUA,EACVlT,QAASA,EACTiM,QAAQ,YC5Ed,ICKY6T,GDLNnb,GAAYC,aAAW,SAACC,GAAD,MAAmB,CAC9CyL,aAAc,CACZ6C,aAAc,OAEhBqP,eAAe,aACb5O,QAAS,OACTC,eAAgB,gBAChBtB,OAAQ,gBACR,yBAA0B,CACxBuB,YAAa,QAEdjP,EAAMiO,YAAYC,KAAK,MAAQ,CAC9BR,OAAQ,gBAGZkQ,mBAAoB,CAClBzkB,MAAO,QAET0kB,eAAe,eACZ7d,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B/U,MAAO,aAaE,SAAS2kB,GAAT,GAAsG,IAA5EpmB,EAA2E,EAA3EA,KAAM6iB,EAAqE,EAArEA,SAAUwD,EAA2D,EAA3DA,QAASC,EAAkD,EAAlDA,YAAaC,EAAqC,EAArCA,aACvEzd,EAAUV,KACR6D,EAASuC,KAATvC,KAUFua,GAAezjB,OAAO6J,SAASC,OAAO5M,SAAS,yBAAjC,OAA2DgM,QAA3D,IAA2DA,OAA3D,EAA2DA,EAAMwa,aAErF,OACE,oCACE,kBAAC3S,GAAA,EAAD,CAAYpE,QAAQ,KAAKzG,UAAWH,EAAQiL,cAA5C,eAGA,kBAACD,GAAA,EAAD,CAAYpE,QAAQ,SACjB8W,EACG,+CACA,6DAEN,0BAAME,SAAUH,GACd,yBAAKtd,UAAWH,EAAQmd,iBACpBO,GACA,yBAAKvd,UAAWH,EAAQod,oBACtB,kBAACxE,GAAA,EAAD,CAAYiF,QAAM,EAACC,QAAQ,mBAA3B,aAGA,kBAACjF,GAAA,EAAD,CACEhP,GAAG,kBACHjD,QAAQ,WACRb,WAAS,EACT2W,KAAK,QACL7mB,MAAOqB,EACPsU,SAjCW,SAACuS,GACxBR,EAAQQ,EAAM1nB,OAAOR,WAoCf,yBAAKsK,UAAWH,EAAQod,oBACtB,kBAACxE,GAAA,EAAD,CAAYiF,QAAM,EAACC,QAAQ,mBAA3B,aAGA,kBAACjF,GAAA,EAAD,CACEmF,eAAe,QACfnU,GAAG,kBACHjD,QAAQ,WACRb,WAAS,EACT2W,KAAK,QACL7mB,MAAOkkB,EACPvO,SA5CiB,SAACuS,GAC5BP,EAAYO,EAAM1nB,OAAOR,YA+CrB,kBAACqV,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,YACtB,kBAACpL,EAAA,EAAD,CACE2G,QAAQ,YACRqX,KAAK,SACLpe,MAAM,UACNoQ,UAAW/Y,IAAS6iB,EACpB5Z,UAAWH,EAAQqd,gBALrB,eChFK,SAASa,KAAkB,IAChC/a,EAASuC,KAATvC,KACAlH,EAA2BxF,IAA3BwF,uBACAkiB,EAAgBC,cAAhBD,YAH+B,EAIfjpB,mBAASulB,GAAMC,cAJA,mBAIhC2D,EAJgC,KAI1BrE,EAJ0B,OAMf9kB,oBAAqB,OAAJiO,QAAI,IAAJA,OAAA,EAAAA,EAAMwa,cAAe,IANvB,mBAMhCzmB,EANgC,KAM1BqmB,EAN0B,OAOProB,mBAAiB,IAPV,mBAOhC6kB,EAPgC,KAOtByD,EAPsB,OASHtoB,qBATG,mBAShCopB,EATgC,KASpBC,EAToB,KAWvClpB,qBAAU,WACJ8oB,IACFX,EAAYW,IACZ,OAAIhb,QAAJ,IAAIA,OAAJ,EAAIA,EAAMwa,cACR3D,EAAQS,GAAM+D,wBAGjB,CAACrb,EAAMgb,IAEV9oB,qBAAU,WACJgpB,IAAS5D,GAAM+D,qBAAwBF,GACzCriB,IAAyBnE,OAAM,SAAA0C,GAC7BC,QAAQC,IAAI,gCACZD,QAAQgkB,IAAIjkB,GACZ+jB,EAAc/jB,QAGjB,CAACyB,EAAwBoiB,EAAMC,IAWlC,OACE,kBAAC,GAAD,KACE,kBAAC1B,GAAD,CAAoBpiB,MAAO8jB,IAC1BD,IAAS5D,GAAMC,cACd,kBAAC4C,GAAD,CACEpmB,KAAMA,EACN6iB,SAAUA,EACVwD,QAASA,EACTC,YAAaA,EACbC,aAlBa,SAACM,GACpBA,EAAMW,iBAEDzkB,OAAO6J,SAAS6a,OAAOxnB,SAAS,YACnC8C,OAAOgJ,QAAQ2b,aAAa,KAAM,GAAI3kB,OAAO4kB,UAAP,gBAA0B9E,GAA1B,OAAqC9f,OAAO6J,SAASC,QAAU,MAEvGiW,EAAQS,GAAM+D,wBAgBXH,IAAS5D,GAAM+D,qBACd,kBAAC1E,GAAD,CAAuB5iB,KAAMA,EAAM6iB,SAAUA,EAAUC,QAASA,KC/DzD,SAAS8E,KACtB,IAAMC,EAAY7O,KAElB,OACE,kBAAC,GAAD,CACEtJ,QAAQ,QACRiH,SAAS,mBACTlT,QAAQ,0BACRiL,KAAoB,iBAAdmZ,ICVG,SAASC,KACtB,OACE,yBAAKrmB,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,YAAYM,KAAK,OAAOP,MAAM,8BAChE,0BACEQ,SAAS,UACTmE,SAAS,UACT7D,EAAE,oPACFP,KAAK,YAEP,0BACEC,SAAS,UACTmE,SAAS,UACT7D,EAAE,oPACFP,KAAK,c,SFNDwQ,O,+BAAAA,I,8CAAAA,Q,KGHZ,IAAMnb,GAAYC,aAAW,kBAC3BE,YAAa,CACX0L,UAAW,CACTvS,OAAQ,OACR+G,WAAY,UACZsf,aAAc,oBACd1Q,QAAS,OACTC,eAAgB,gBAChBpD,WAAY,SACZ4K,QAAS,SAEXkJ,KAAM,CACJ5E,WAAY,QAEd6E,gBAAiB,CACf1J,OAAQ,UACRlH,QAAS,OACT5O,WAAY,cACZ2T,OAAQ,IACR0C,QAAS,cAKA,SAASoJ,KACtB,IAAMpf,EAAUV,KACR+R,EAAwBqB,KAAxBrB,oBAER,OACE,yBAAKlR,UAAWH,EAAQmL,WACtB,yBAAKhL,UAAWH,EAAQkf,MAAxB,QACA,4BAAQ/e,UAAWH,EAAQmf,gBAAiBjf,QAAS,kBAAMmR,GAAoB,KAC7E,kBAAC2N,GAAD,QCpCO,SAASK,KACtB,OACE,yBAAK1mB,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,aAAaM,KAAK,OAAOP,MAAM,8BACjE,0BACEQ,SAAS,UACTmE,SAAS,UACT7D,EAAE,uwCACFP,KAAK,aCPE,SAASmK,KACtB,OACE,yBAAKzb,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,YAAYM,KAAK,OAAOP,MAAM,8BAChE,0BACEQ,SAAS,UACTmE,SAAS,UACT7D,EAAE,kPACFP,KAAK,YAEP,0BACEC,SAAS,UACTmE,SAAS,UACT7D,EAAE,4eACFP,KAAK,a,cCNP3K,GAAYC,YAAW,CAC3B+f,mBAAoB,CAClBC,UAAW,oBACXN,aAAc,oBACdjJ,QAAS,iBAEXwJ,SAAU,CACRxJ,QAAS,aACTsD,UAAW,QACX3gB,MAAO,OACP2a,OAAQ,IACRmM,OAAQ,OACR1R,SAAU,OACV2R,WAAY,SAEdhgB,OAAQ,CACNsW,QAAS,SACTe,SAAU,OACV,aAAc,CACZpX,WAAY,OACZ,SAAU,CACRsK,KAAM,aAIZ0V,gBAAiB,CACfzS,OAAQ,cACRqB,QAAS,QAEXqR,oBAAqB,CACnBhN,SAAU,WACVnE,YAAa,OAEfoR,yBAA0B,CACxBjN,SAAU,WACVI,IAAK,MACLC,KAAM,MACNqG,WAAY,GACZwG,YAAa,MAYF,SAASC,GAAT,GAAwE,IAAnDzO,EAAkD,EAAlDA,aAAcF,EAAoC,EAApCA,iBAC1CpR,EAAUV,KADoE,EAE9CpK,mBAAS,IAFqC,mBAE7E8qB,EAF6E,KAEhEC,EAFgE,OAG1C/qB,oBAAS,GAHiC,mBAG7EgrB,EAH6E,KAG9DC,EAH8D,OAI1CjrB,mBAAwB,MAJkB,mBAI7EkrB,EAJ6E,KAI9DC,EAJ8D,KAK9EC,EAAiB,KAAKrqB,KAAK+pB,GAC3BO,EAAepoB,iBAA4B,MAC3CqoB,EAAeroB,iBAAyB,MAE9C9C,qBAAU,WACe,IAAD,EAAlB+b,IAGF,UAAAmP,EAAahoB,eAAb,SAAsBkoB,WAEvB,CAACrP,IAEJ,IAYMsP,EAAoB,SAAC/lB,GACrB2lB,IACFhP,EAAaqP,YAAYhmB,EAAQimB,QACjCX,EAAe,MA2BnB,OACE,yBAAK9f,UAAWH,EAAQsf,oBACtB,kBAAC,GAAD,CACE1Z,KAAMoP,QAAQoL,GACdvS,SAAS,QACTlT,QAASylB,GAAiB,GAC1BxZ,QAAQ,QACR2V,YAAa,kBAAM8D,EAAiB,SAGtC,kBAACQ,GAAA,EAAD,CACEC,QAAS,EACTC,QAAS,EACT5gB,UAAWH,EAAQwf,SACnB7C,aAAW,aACX7D,YAAY,qBACZkI,WArDuB,SAACjD,GACvBjoB,GAA0B,UAAdioB,EAAMznB,KAAoBynB,EAAMkD,WAC/ClD,EAAMW,iBACNgC,EAAkBV,KAmDhBxU,SA3De,SAACuS,GACpBkC,EAAelC,EAAM1nB,OAAOR,QA2DxBA,MAAOmqB,EACPkB,sBAAA,EACApX,IAAKyW,IAGP,kBAACrV,GAAA,EAAD,CAAMC,WAAS,EAACC,WAAW,WAAWC,QAAQ,WAAW8V,KAAK,UAG5D,2BACErX,IAAK0W,EACLvC,KAAK,OACLnR,MAAO,CAAEyB,QAAS,QAClB/C,SArDe,SAACuS,GAAgD,IAAD,EAC/DqD,EAAI,UAAGrD,EAAM1nB,OAAOgrB,aAAhB,aAAG,EAAqB,GAClC,GAAID,EAAM,CACR,IAAIE,EAAW,IAAIC,SACnBD,EAASE,OAAO,WAAYJ,GAC5BjB,GAAiB,GACjBE,EAAiB,MACjB/O,EACGqP,YAAYW,GACZxpB,OAAM,SAAA2T,GACU,MAAXA,EAAEgW,KACJpB,EAAiB,uDAEjBA,EAAiB,6DAEnB5lB,QAAQC,IAAI,yBAA0B+Q,MAEvC1T,SAAQ,WACPooB,GAAiB,QAoCjBtqB,MAAO,GACP6rB,OA7FR,uKA+FM,yBAAKvhB,UAAWH,EAAQ2f,iBACtB,yBAAKxf,UAAWH,EAAQ4f,qBACtB,kBAAC3f,EAAA,EAAD,CAAQE,UAAWH,EAAQN,OAAQQ,QAAS,kCAAMsgB,EAAajoB,eAAnB,aAAM,EAAsBopB,SAAS1R,SAAUiQ,GACzF,kBAACb,GAAD,OAGDa,GAAiB,kBAAC7F,GAAA,EAAD,CAAkBqC,KAAM,GAAIvc,UAAWH,EAAQ6f,4BAGnE,kBAAC5f,EAAA,EAAD,CACEE,UAAWH,EAAQN,OACnBQ,QAAS,kBAAMwgB,EAAkBV,IACjCngB,MAAM,UACN+G,QAAQ,YACRqJ,UAAWqQ,EACXsB,+BAAA,GAEA,kBAAC,GAAD,UCtKZ,IAAMtiB,GAAYC,aAAW,kBAC3BE,YAAa,CACXoiB,qBAAsB,CACpBtT,QAAS,OACTC,eAAgB,gBAChBpD,WAAY,SACZ4K,QAAS,oBACTjI,SAAU,OACVlO,MAAO,gBAWE,SAASiiB,GAAT,GAAqF,IAA9DC,EAA6D,EAA7DA,OAAQC,EAAqD,EAArDA,YAAaC,EAAwC,EAAxCA,mBACnDjiB,EAAUV,KAEhB,OACE,yBAAKa,UAAWH,EAAQ6hB,sBACtB,6BAAMI,EAAkB,UAAMF,EAAN,UAAuBA,GAC/C,6BAAMC,I,8FCnBNE,GAASziB,YAAa,CAC1B0iB,eAAgB,CACd3U,UAAW,EACXiJ,KAAM,EACN7D,SAAU,YAEZwP,qBAAsB,CACpBxpB,OAAQ,OACRypB,UAAW,OACXrM,QAAS,aAEXsM,qBAAsB,CACpBD,UAAW,OACX5L,KAAM,IACN8L,cAAe,OAEjB7iB,OAAQ,CACNkT,SAAU,WACViD,OAAQ,OACRC,MAAO,MACPG,OAAQ,IACRD,QAAS,cACTwM,WAAY,SACZtP,QAAS,EACTmI,UAAW,qCACXlI,WAAY,iBAEdsP,WAAY,CACVD,WAAY,UACZtP,QAAS,EACT2C,OAAQ,UAyBC6M,GAAb,+MAIEC,cAAgBjY,IAAMkY,YAJxB,EAKE1hB,MAAQ,CAAE2hB,oBAAoB,EAAMJ,YAAY,EAAOK,yBAA0B,GALnF,EAuCEC,aAAeC,MAAS,WACtB,IAAMC,EAAyB,EAAKN,cAAcpqB,QAIlD,GAAK0qB,EAAL,CAIA,IAAMJ,EACJzZ,KAAK8Z,IACHD,EAAuBE,aAAeF,EAAuBG,UAAYH,EAAwBI,cAC/F,EAEN,EAAKlT,UAAS,SAAAmT,GAAS,MAAK,CAC1BT,qBACAJ,YAAYI,GAA6BS,EAAUb,kBAEpD,KAzDL,EA2DEc,YAAc,WACZ,IAAMN,EAAyB,EAAKN,cAAcpqB,QAElD0qB,EAAuBO,SAAS,CAAExQ,IAAKiQ,EAAuBI,aAAcI,SAAU,WAEtF,EAAKtT,SAAS,CAAEsS,YAAY,KAhEhC,qDAOE,WACE,IAAMQ,EAAyBS,KAAKf,cAAcpqB,QAClD0qB,EAAuBG,UAAYH,EAAwBI,eAT/D,+BAYE,WACEK,KAAKC,iBACLD,KAAKf,cAAcpqB,QAASC,iBAAiB,SAAUkrB,KAAKX,gBAdhE,gCAkBE,SAAmBa,EAA4CN,GAC7D,IAAMO,EAAiBH,KAAK3jB,MAAMyR,SAASzX,SAAW6pB,EAAUpS,SAASzX,OAEzE,GAAIupB,EAAUT,oBAAsBgB,EAClCH,KAAKC,sBACA,GAAIE,EAAgB,CACzB,IAAMC,EAAsBJ,KAAK3jB,MAAMyR,SAASzX,OAAS6pB,EAAUpS,SAASzX,OAE5E2pB,KAAKvT,UAAS,SAAA4T,GAAa,MAAK,CAE9BtB,YAAasB,EAAclB,mBAI3BC,yBAA0BiB,EAActB,WACpCsB,EAAcjB,yBAA2BgB,EACzC,SAlCZ,kCAmEE,WACiCJ,KAAKf,cAAcpqB,QAE3BE,oBAAoB,SAAUirB,KAAKX,gBAtE9D,oBAyEE,WAAU,IACA/iB,EAAY0jB,KAAK3jB,MAAjBC,QAER,OACE,yBAAKG,UAAWH,EAAQmiB,gBACtB,yBAAKhiB,UAAWH,EAAQoiB,qBAAsBtY,IAAK4Z,KAAKf,cAAeqB,qCAAA,GACrE,yBAAK7jB,UAAWH,EAAQsiB,sBACrBoB,KAAK3jB,MAAM9K,SACZ,kBAACgL,EAAA,EAAD,CACEE,UAAWC,YAAKJ,EAAQN,OAAT,eAAoBM,EAAQyiB,WAAaiB,KAAKxiB,MAAMuhB,aACnEviB,QAASwjB,KAAKH,YACdzS,UAAW,kBAAC,KAAD,MACXjR,MAAM,UACN+G,QAAQ,YACRqd,8BAAA,GAECP,KAAKxiB,MAAM4hB,yBARd,eASGY,KAAKxiB,MAAM4hB,yBAA2B,GAAK,YA1F1D,GAAgDpY,IAAMwZ,WAmGvCC,gBAAWjC,GAAXiC,CAAmBzB,I,qBC7J5BpjB,GAAYC,YAAW,CAC3B6kB,iBAAkB,CAChBrR,aAAc,OACdxE,QAAS,cACTnD,WAAY,SACZ4K,QAAS,oBACT9I,OAAQ,YACRmX,UAAW,aACXvR,gBAAiB,UACjBwR,QAAS,OACTC,WAAY,YAEdtC,mBAAoB,CAClBnP,gBAAiB,aA+BN,SAAS0R,GAAT,GAAsE,IAA/CtiB,EAA8C,EAA9CA,KAAM+f,EAAwC,EAAxCA,mBACpCjiB,EAAUV,KAEhB,OACE,6BACE,yBACEa,UAAWC,YAAKJ,EAAQokB,iBAAT,eACZpkB,EAAQiiB,mBAAqBA,KAGhC,6BAhCR,SAAkB/C,GAChB,IAAMuF,EAAUC,OAAU7gB,MAAMqb,GAChC,IAAKuF,EAAS,OAAOvF,EAErB,IAAMyF,EAAU,GACZC,EAAY,EAchB,OAZAH,EAAQ9mB,SAAQ,SAACkG,EAAOqF,GACtByb,EAAQE,KAAK3F,EAAK4F,MAAMF,EAAW/gB,EAAMkhB,QACzCJ,EAAQE,KACN,kBAACzJ,GAAA,EAAD,CAAM/kB,OAAO,SAAS2uB,IAAI,aAAaC,KAAMphB,EAAMqhB,IAAK5uB,IAAK4S,GAC1DrF,EAAMqb,OAGX0F,EAAY/gB,EAAM+gB,aAGpBD,EAAQE,KAAK3F,EAAK4F,MAAMF,EAAW1F,EAAKnlB,SAEjC4qB,EAaKQ,CAASjjB,MC1DR,SAASkjB,KACtB,OACE,yBAAKzsB,MAAM,KAAKC,OAAO,KAAK+Q,QAAQ,YAAYM,KAAK,OAAOP,MAAM,8BAChE,0BACEQ,SAAS,UACTmE,SAAS,UACT7D,EAAE,mUACFP,KAAK,YAEP,0BACEC,SAAS,UACTmE,SAAS,UACT7D,EAAE,0ZACFP,KAAK,YAEP,0BACEC,SAAS,UACTmE,SAAS,UACT7D,EAAE,iOACFP,KAAK,YAEP,0BACEC,SAAS,UACTmE,SAAS,UACT7D,EAAE,mtBACFP,KAAK,YAEP,0BACEC,SAAS,UACTmE,SAAS,UACT7D,EAAE,8XACFP,KAAK,YAEP,0BACEC,SAAS,UACTmE,SAAS,UACT7D,EAAE,icACFP,KAAK,YAEP,0BACEC,SAAS,UACTmE,SAAS,UACT7D,EAAE,yPACFP,KAAK,aCxCb,IAAM3K,GAAYC,YAAW,CAC3B6kB,iBAAkB,CAChB7V,QAAS,OACTyH,QAAS,cACT9I,OAAQ,UACRoG,OAAQ,oBACRP,aAAc,MACd0C,OAAQ,WAEV9C,cAAe,CACbpE,QAAS,OACTnD,WAAY,UAEdia,UAAW,CACT9W,QAAS,OACToL,cAAe,SACfnL,eAAgB,SAChBsR,WAAY,QACZ/I,SAAU,EACV,MAAO,CACL7J,OAAQ,EACRa,SAAU,SAGduX,SAAU,CACRhL,WAAY,IACZ/C,SAAU,SACVgO,aAAc,YAEhB7I,KAAM,CACJpC,WAAY,OAQT,SAASkL,GAAeC,GAAyC,IAA1BC,EAAyB,uDAAX,EACpDC,EAAW,CAAC,QAAS,KAAM,KAAM,MACvC,OAAIF,EAAQ,KAAcA,EAAMG,QAAQ,GAAK,IAAMD,EAASD,GACrDF,GAAeC,EAAQ,KAAMC,EAAc,GAGrC,SAASG,GAAT,GAAoD,IAA7BC,EAA4B,EAA5BA,MAC9B9lB,EAAUV,KAiBhB,OACE,yBAAKa,UAAWH,EAAQokB,iBAAkBlkB,QAhBxB,WAClB4lB,EAAMC,yBAAyBpuB,MAAK,SAAAutB,GAClC,IAAMtV,EAAWvX,SAAS2tB,cAAc,KAExCpW,EAASqV,KAAOC,EAChBtV,EAASvZ,OAAS,SAClBuZ,EAASoV,IAAM,WAGfxnB,YAAW,WACToS,EAAS+R,gBAOX,yBAAKxhB,UAAWH,EAAQ2S,eACtB,kBAACyS,GAAD,OAEF,yBAAKjlB,UAAWH,EAAQqlB,WACtB,uBAAGllB,UAAWH,EAAQslB,UAAWQ,EAAMR,UACvC,uBAAGnlB,UAAWH,EAAQ0c,MAAO8I,GAAeM,EAAMpJ,MAAlD,sBC9DR,IAAMuJ,GAAmB,SAACtrB,GAAD,cACvBA,QADuB,IACvBA,OADuB,EACvBA,EAASqnB,YAAYkE,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,YAAaC,eAE5E,SAASC,GAAT,GAAsD,IAA/B9U,EAA8B,EAA9BA,SAE9B1a,EADWL,IAATzB,KACuB8B,iBAE/B,OACE,kBAAC,GAAD,CAA4B0a,SAAUA,GACnCA,EAAS7F,KAAI,SAAChR,EAAS4rB,GAAS,IAAD,EACxBC,EAAOP,GAAiBtrB,GAIxB8rB,EAA2BD,IAHZP,GAAiBzU,EAAS+U,EAAM,KAGK5rB,EAAQonB,UAAR,UAAmBvQ,EAAS+U,EAAM,UAAlC,aAAmB,EAAmBxE,QAE1FE,EAAqBnrB,EAAiB6gB,WAAahd,EAAQonB,OAEjE,OACE,kBAAC,IAAM2E,SAAP,CAAgBpwB,IAAKqE,EAAQ4X,KAC1BkU,GACC,kBAAC3E,GAAD,CAAaC,OAAQpnB,EAAQonB,OAAQE,mBAAoBA,EAAoBD,YAAawE,IAE1E,SAAjB7rB,EAAQsjB,MAAmB,kBAACuG,GAAD,CAAatiB,KAAMvH,EAAQuH,KAAM+f,mBAAoBA,IAC/D,UAAjBtnB,EAAQsjB,MAAoB,kBAAC,GAAD,CAAc6H,MAAOnrB,EAAQmrB,aC5BtE,IAAMxmB,GAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACXknB,oBAAoB,aAClBhnB,WAAY,UACZsW,OAAQ,IACR1H,QAAS,OACToL,cAAe,SACfyC,WAAY,qBACX5c,EAAMiO,YAAYC,KAAK,MAAQ,CAC9BkF,SAAU,QACVI,IAAK,EACLC,KAAM,EACN4C,OAAQ,EACRC,MAAO,IAGX8Q,KAAM,CACJrY,QAAS,aASA,SAASsY,KACtB,IAAM7mB,EAAUV,KADmB,EAEkBoT,KAA7CtB,EAF2B,EAE3BA,iBAAkBI,EAFS,EAETA,SAAUF,EAFD,EAECA,aAEpC,OACE,2BAAOnR,UAAWC,YAAKJ,EAAQ2mB,oBAAT,eAAiC3mB,EAAQ4mB,MAAQxV,KACrE,kBAACgO,GAAD,MACA,kBAACkH,GAAD,CAAa9U,SAAUA,IACvB,kBAACuO,GAAD,CAAWzO,aAAcA,EAAeF,iBAAkBA,KCrChE,IAAM9R,GAAYC,YAAW,CAC3B4iB,eAAgB,CACdxpB,MAAO,MACPC,OAAQ,MACRod,QAAS,QACTzH,QAAS,OACTnD,WAAY,SACZoD,eAAgB,SAChB7O,WAAY,sBAEd8X,eAAgB,CACdlJ,QAAS,OACTnD,WAAY,WACZ,QAAS,CACPzS,MAAO,MACP8V,YAAa,MACb,qBAAsB,CACpBqY,YAAa,YAOfC,GAAa,CAAC,EAAG,EAAG,EAAG,EAAG,GAEjB,SAASC,GAAT,GAA6E,IAA9CxxB,EAA6C,EAA7CA,YACtCwK,EAAUV,KACV2nB,EC9BO,SAA2CzxB,GAA2B,IAAD,EAC5BN,mBAASM,EAAYyxB,qBADO,mBAC3EA,EAD2E,KACtDC,EADsD,KAclF,OAXA7xB,qBAAU,WACR,IAAM8xB,EAAkC,SAACC,GAAD,OACtCF,EAAuBE,IAIzB,OAFAF,EAAuB1xB,EAAYyxB,qBACnCzxB,EAAYE,GAAG,6BAA8ByxB,GACtC,WACL3xB,EAAYG,IAAI,6BAA8BwxB,MAE/C,CAAC3xB,IAEGyxB,EDgBqBI,CAAkC7xB,GAE9D,OAA4B,OAAxByxB,EAAqC,KAGvC,yBAAK9mB,UAAWH,EAAQmiB,gBACtB,yBAAKhiB,UAAWH,EAAQyX,gBACrBsP,GAAWpb,KAAI,SAAA2b,GAAK,OACnB,yBACEhxB,IAAKgxB,EACLxa,MAAO,CACLlU,OAAO,GAAD,OAhBP,GAgBoB0uB,EAAQ,GAArB,MACN3nB,WAAYsnB,EAAsBK,EAAQ,QAAU,mC,cEzCnD,SAASC,KACtB,OACE,kBAACnS,GAAA,EAAD,CAASC,MAAM,0CAA0CC,UAAU,OACjE,kBAACkS,GAAA,EAAD,CACE1a,MAAO,CAAEa,MAAO,QAAShO,WAAY,qBAAsBqW,QAAS,QAASyR,UAAW,eACxF9uB,MAAM,KACNC,OAAO,KACP+Q,QAAQ,aAER,0BACEM,KAAK,OACLC,SAAS,UACTK,YAAY,IACZC,EAAE,uuBCTG,SAASkd,GAAsBzwB,GAAmB,IAAD,EACpB/B,mBAAS+B,GAASA,EAAM0wB,eADJ,mBACvDA,EADuD,KACxCC,EADwC,KAmB9D,OAhBAvyB,qBAAU,WAIR,GAFAuyB,EAAiB3wB,GAASA,EAAM0wB,eAE5B1wB,EAAO,CACT,IAAM4wB,EAAoB,kBAAMD,GAAiB,IAC3CE,EAAmB,kBAAMF,GAAiB,IAGhD,OAFA3wB,EAAMvB,GAAG,cAAemyB,GACxB5wB,EAAMvB,GAAG,aAAcoyB,GAChB,WACL7wB,EAAMtB,IAAI,cAAekyB,GACzB5wB,EAAMtB,IAAI,aAAcmyB,OAG3B,CAAC7wB,MAEK0wB,ECtBI,SAASI,GAAgBvyB,GAA2B,IAAD,EACxBN,mBAA6B,IADL,mBACzD8yB,EADyD,KAC3CC,EAD2C,KAoBhE,OAjBA5yB,qBAAU,WAER4yB,EAAgBxT,MAAMC,KAAKlf,EAAYkH,OAAOuM,WAE9C,IAAMif,EAAmB,SAACtqB,GAAD,OACvBqqB,GAAgB,SAAAE,GAAgB,6BAAQA,GAAR,CAA0BvqB,QACtDwqB,EAAqB,SAACxqB,GAAD,OACzBqqB,GAAgB,SAAAE,GAAgB,OAAIA,EAAiB1uB,QAAO,SAAA4uB,GAAC,OAAIA,IAAMzqB,SAIzE,OAFApI,EAAYE,GAAG,iBAAkBwyB,GACjC1yB,EAAYE,GAAG,mBAAoB0yB,GAC5B,WACL5yB,EAAYG,IAAI,iBAAkBuyB,GAClC1yB,EAAYG,IAAI,mBAAoByyB,MAErC,CAAC5yB,IAEGwyB,ECtBM,SAASM,GAAS1qB,GAA0E,IAAD,EAC9E1I,mBAAS0I,GAAeA,EAAY3G,OAD0C,mBACjGA,EADiG,KAC1FsxB,EAD0F,KAmBxG,OAhBAlzB,qBAAU,WAIR,GAFAkzB,EAAS3qB,GAAeA,EAAY3G,OAEhC2G,EAAa,CACf,IAAM4qB,EAAc,kBAAMD,EAAS,OAInC,OAFA3qB,EAAYlI,GAAG,aAAc6yB,GAC7B3qB,EAAYlI,GAAG,eAAgB8yB,GACxB,WACL5qB,EAAYjI,IAAI,aAAc4yB,GAC9B3qB,EAAYjI,IAAI,eAAgB6yB,OAGnC,CAAC5qB,IAEG3G,ECnBM,SAASwxB,GAA6BjzB,GAA2B,IAAD,EACjCN,oBAAS,GADwB,mBACtEohB,EADsE,KACtDoS,EADsD,KAiB7E,OAdArzB,qBAAU,WACR,IAAMszB,EAAqB,kBAAMD,GAAkB,IAC7CE,EAAoB,kBAAMF,GAAkB,IAMlD,OAJAE,IAEApzB,EAAYE,GAAG,eAAgBizB,GAC/BnzB,EAAYE,GAAG,cAAekzB,GACvB,WACLpzB,EAAYG,IAAI,eAAgBgzB,GAChCnzB,EAAYG,IAAI,cAAeizB,MAEhC,CAACpzB,IAEG8gB,ECHT,IAAMhX,GAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACX0L,UAAU,aACRyH,SAAU,WACVrE,QAAS,OACTnD,WAAY,SACZxS,OAAQ,EACR2e,SAAU,SACVzJ,aAAc,MACd,UAAW,CACTrU,OAAQ,OACRsT,UAAW,sBAEbgG,aAAc,MACdO,OAAO,GAAD,OAAK9T,EAAMqpB,uBAAX,+BACNrR,WAAW,QAAD,OAAW,MAAX,eAA+BhY,EAAMqpB,uBAArC,OACVlpB,WAAY,SACXH,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B9U,OAAQ4G,EAAMspB,oBACdnwB,MAAM,GAAD,OAAkC,GAA5B6G,EAAMspB,oBAA4B,EAAxC,MACLra,YAAa,MACbX,aAAc,IACdC,SAAU,OACVyJ,WAAW,GAAD,OAAKhY,EAAMspB,oBAAsB,EAAjC,QAGdrR,eAAgB,CACd7E,SAAU,WACVI,IAAK,EACLC,KAAM,EACNta,MAAO,OACPC,OAAQ,QAEVmwB,cAAe,CACbnW,SAAU,WACVqD,OAAQ,EACR1H,QAAS,OACToL,cAAe,SACfnL,eAAgB,gBAChB5V,OAAQ,OACRD,MAAO,OACPgH,WAAY,cACZqT,IAAK,GAEP4E,gBAAgB,aACdrJ,QAAS,OACTnD,WAAY,SACZoD,eAAgB,SAChB7O,WAAY,QACZiT,SAAU,WACVI,IAAK,EACL8C,MAAO,EACPD,OAAQ,EACR5C,KAAM,EACNgD,OAAQ,GACPzW,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B,QAAS,CACPvD,UAAW,gBAIjB6e,sBAAuB,CACrBpW,SAAU,WACVI,IAAK,EACL8C,MAAO,EACPD,OAAQ,EACR5C,KAAM,EACN1E,QAAS,OACTnD,WAAY,SACZoD,eAAgB,SAChB7O,WAAY,yBACZsW,OAAQ,GAEVgT,yBAA0B,CACxBtpB,WAAY,qBACZqW,QAAS,eACTvH,YAAa,QACbF,QAAS,OACT,SAAU,CACRtE,KAAM,UAGV0N,SAAU,CACRhY,WAAY,qBACZE,MAAO,QACPmW,QAAS,eACT9I,OAAQ,EACRqB,QAAS,OACTnD,WAAY,UAEd8d,cAAe,CACb3a,QAAS,OACTC,eAAgB,gBAChBoE,SAAU,WACViD,OAAQ,EACR5C,KAAM,GAERkW,YAAY,aACVtpB,MAAO,SACNL,EAAMiO,YAAYC,KAAK,MAAQ,CAC9BK,SAAU,YAGdqb,gBAAiB,CACf7a,QAAS,QAEX8a,cAAe,CACb5T,OAAQ,gBAcC,SAAS6T,GAAT,GAOW,IAAD,EANvB9zB,EAMuB,EANvBA,YACA0K,EAKuB,EALvBA,QACAqpB,EAIuB,EAJvBA,WACAt0B,EAGuB,EAHvBA,SACAgtB,EAEuB,EAFvBA,mBACAmH,EACuB,EADvBA,gBAEMpB,EAAeD,GAAgBvyB,GAE/Bg0B,EAAmBxB,EAAahxB,MAAK,SAAAqxB,GAAC,MAAe,UAAXA,EAAE1uB,QAC5C8vB,EAAmBzB,EAAahxB,MAAK,SAAAqxB,GAAC,OAAIA,EAAExT,UAAU1d,SAAS,aAE/Dc,EAAiB+c,QAAQyU,GACzBC,EAAuB1B,EAAahxB,MAAK,SAAAqxB,GAAC,OAAIA,EAAExT,UAAU1d,SAAS,aAGnEwyB,EAAqBjC,GADRY,GAASmB,IAGtB7uB,EAAa0tB,GAASkB,GACtBI,EAA4BnB,GAA6BjzB,GAEzDwK,EAAUV,KAEhB,OACE,yBACEa,UAAWC,YAAKJ,EAAQmL,WAAT,mBACZnL,EAAQopB,gBAAkBA,GADd,cAEZppB,EAAQqpB,cAAgBrU,QAAQ9U,IAFpB,IAIfA,QAASA,EACT2pB,sBAAqBr0B,EAAYmiB,UAEjC,yBAAKxX,UAAWH,EAAQ+oB,eACtB,kBAAC/B,GAAD,CAAqBxxB,YAAaA,IAClC,yBAAK2K,UAAWH,EAAQkpB,eACrBQ,GACC,0BAAMvpB,UAAWH,EAAQipB,0BACvB,kBAAC7U,GAAD,OAGJ,0BAAMjU,UAAWH,EAAQ2X,UACvB,kBAAC,GAAD,CAAqB/c,WAAYA,IACjC,kBAACoQ,GAAA,EAAD,CAAYpE,QAAQ,QAAQzG,UAAWH,EAAQmpB,YAAarR,UAAU,QACnEtiB,EAAYmiB,SACZsK,GAAsB,YAI7B,6BAAMsH,GAAc,kBAAChC,GAAD,QAEtB,yBAAKpnB,UAAWH,EAAQyX,kBACnBxf,GAAkB0xB,IACnB,yBAAKxpB,UAAWH,EAAQ4X,iBACtB,kBAACX,GAAD,OAGH2S,GACC,yBAAKzpB,UAAWH,EAAQgpB,uBACtB,kBAAChe,GAAA,EAAD,CAAYpE,QAAQ,QAAQzG,UAAWH,EAAQmpB,aAA/C,oBAKHl0B,IClMM,SAAS60B,GAAT,GAAiD,IAA3B7yB,EAA0B,EAA1BA,MAC3B6N,EAAiBY,KAAjBZ,aACFilB,EAAU5xB,mBAahB,OAXA9C,qBAAU,WAIR,OAHA00B,EAAQxxB,QAAUtB,EAAMyV,SACxBqd,EAAQxxB,QAAQiR,aAAa,2BAA4BvS,EAAMC,MAC/DmB,SAAS6J,KAAK8nB,YAAYD,EAAQxxB,SAC3B,kBAAMtB,EAAM0V,SAAShP,SAAQ,SAAA6O,GAAE,OAAIA,EAAGyd,eAC5C,CAAChzB,IAEJ5B,qBAAU,WAAO,IAAD,IACd,UAAA00B,EAAQxxB,eAAR,mBAAiB2xB,iBAAjB,gBAA6BplB,KAC5B,CAACA,IAEG,KCDM,SAASqlB,GAAT,GAAuG,IAAhFvsB,EAA+E,EAA/EA,YAAaqkB,EAAkE,EAAlEA,mBAAoBmI,EAA8C,EAA9CA,UAAWC,EAAmC,EAAnCA,cAC1EpzB,EAAQqxB,GAAS1qB,GAEvB,IAAK3G,EAAO,OAAO,KAEnB,OAAQA,EAAM0C,MACZ,IAAK,QACH,OACE,kBAACsS,GAAD,CACEhV,MAAOA,EACPY,SAAUwyB,EACVne,QAASjV,EAAMC,KAAKC,SAAS,WAAa8qB,IAGhD,IAAK,QACH,OAAOmI,EAAY,KAAO,kBAACN,GAAD,CAAY7yB,MAAOA,IAC/C,QACE,OAAO,MClBE,SAASqzB,GAAT,GAMa,IAGtBC,EARJ/0B,EAKyB,EALzBA,YACA40B,EAIyB,EAJzBA,UACAI,EAGyB,EAHzBA,kBACAH,EAEyB,EAFzBA,cACApI,EACyB,EADzBA,mBAEM+F,EAAeD,GAAgBvyB,GAUrC,OALE+0B,EADEC,GAAqBxC,EAAatsB,MAAK,SAAA2sB,GAAC,OAAIA,EAAExT,UAAU1d,SAAS,aAC5C6wB,EAAavuB,QAAO,SAAA4uB,GAAC,OAAKA,EAAExT,UAAU1d,SAAS,aAE/C6wB,EAAavuB,QAAO,SAAA4uB,GAAC,OAAKA,EAAExT,UAAU1d,SAAS,aAItE,oCACGozB,EAAqB5e,KAAI,SAAA/N,GAAW,OACnC,kBAACusB,GAAD,CACE7zB,IAAKsH,EAAYjE,KACjBiE,YAAaA,EACbpI,YAAaA,EACbysB,mBAAoBA,EACpBmI,UAAWA,EACXC,cAAeA,QC/BV,SAASI,GAAT,GAQO,IAPpBj1B,EAOmB,EAPnBA,YACA40B,EAMmB,EANnBA,UACAI,EAKmB,EALnBA,kBACAtqB,EAImB,EAJnBA,QACAqpB,EAGmB,EAHnBA,WACAtH,EAEmB,EAFnBA,mBACAmH,EACmB,EADnBA,gBAEA,OACE,kBAACE,GAAD,CACE9zB,YAAaA,EACb0K,QAASA,EACTqpB,WAAYA,EACZtH,mBAAoBA,EACpBmH,gBAAiBA,GAEjB,kBAACkB,GAAD,CACE90B,YAAaA,EACb40B,UAAWA,EACXI,kBAAmBA,EACnBvI,mBAAoBA,KCjCb,SAASyI,KAAsB,IAAD,EACnC11B,EAASyB,IAATzB,KADmC,EAEGE,mBAAQ,iBAACF,QAAD,IAACA,OAAD,EAACA,EAAM21B,uBAAP,QAA0B,MAFrC,mBAEpCA,EAFoC,KAEnBC,EAFmB,KAiC3C,OA7BAv1B,qBAAU,WACR,GAAIL,EAAM,CAKR,IAAM61B,EAA+B,SAACC,GACT,OAAvBA,GACFF,EAAmBE,IAMjBv1B,EAAgC,SAACC,GACrCo1B,GAAmB,SAAAG,GACjB,OAAOA,IAAwBv1B,EAAc,KAAOu1B,MAMxD,OAFA/1B,EAAKU,GAAG,yBAA0Bm1B,GAClC71B,EAAKU,GAAG,0BAA2BH,GAC5B,WACLP,EAAKW,IAAI,yBAA0Bk1B,GACnC71B,EAAKW,IAAI,0BAA2BJ,OAGvC,CAACP,IAEG21B,EChCM,SAASK,KAAmB,IAAD,EAChCh2B,EAASyB,IAATzB,KACF21B,EAAkBD,KAFgB,EAGAx1B,mBAASuf,MAAMC,KAAN,iBAAW1f,QAAX,IAAWA,OAAX,EAAWA,EAAM2f,aAAa1L,gBAA9B,QAA0C,KAHnD,mBAGjC0L,EAHiC,KAGnBsW,EAHmB,KAgCxC,OAxBA51B,qBAAU,WACJs1B,GACFM,GAAgB,SAAAC,GAAgB,OAC9BP,GAD8B,oBAE3BO,EAAiBzxB,QAAO,SAAAjE,GAAW,OAAIA,IAAgBm1B,YAG7D,CAACA,IAEJt1B,qBAAU,WACR,GAAIL,EAAM,CACR,IAAMm2B,EAAuB,SAAC31B,GAAD,OAC3By1B,GAAgB,SAAAC,GAAgB,6BAAQA,GAAR,CAA0B11B,QACtD41B,EAA0B,SAAC51B,GAAD,OAC9By1B,GAAgB,SAAAC,GAAgB,OAAIA,EAAiBzxB,QAAO,SAAA4uB,GAAC,OAAIA,IAAM7yB,SAGzE,OAFAR,EAAKU,GAAG,uBAAwBy1B,GAChCn2B,EAAKU,GAAG,0BAA2B01B,GAC5B,WACLp2B,EAAKW,IAAI,uBAAwBw1B,GACjCn2B,EAAKW,IAAI,0BAA2By1B,OAGvC,CAACp2B,IAEG2f,EC/BM,SAAS0W,KAAsB,IAAD,EACbx2B,IAAvBM,EADoC,oBAErCmf,EAAyBD,KACzBsW,EAAkBD,KAClB/V,EAAeqW,KACbh2B,EAASyB,IAATzB,KACF8B,EAAgB,OAAG9B,QAAH,IAAGA,OAAH,EAAGA,EAAM8B,iBAK/B,OAAO3B,IAJ8Bmf,IAA2Bxd,EAAmBwd,EAAyB,OAI9CqW,GAAmBhW,EAAa,IAAM7d,ECPtG,IAAMwI,GAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACX0L,UAAU,aACRkX,UAAW,OACX1iB,WAAY,kBACZ2rB,SAAU,gBACVrV,OAAQ,GACPzW,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B4d,SAAU,gBACVjJ,UAAW,UACXkJ,UAAW,OACXhd,QAAS,SAGbid,sBAAuB,CACrB7rB,WAAY,eAEd8rB,gBAAiB,CACfld,QAAS,OACTC,eAAgB,UAElB4T,qBAAqB,aACnBzpB,MAAM,QAAD,OAAU6G,EAAMksB,aAAhB,aACL1V,QAAS,SACRxW,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B/U,MAAO,OACPqd,QAAQ,GAAD,OAAKxW,EAAMmsB,qBAAX,MACPpd,QAAS,cAMF,SAASqd,KACtB,IAAM5rB,EAAUV,KAEVxI,EADWL,IAATzB,KACuB8B,iBACzB6d,EAAeqW,KAJmB,EAKcn2B,IALd,mBAKjCM,EALiC,KAKZ02B,EALY,KAMlCvX,EAAyBD,KACzByX,EAAkBT,KAClBU,EAAmCzX,GAA0BA,IAA2Bxd,EAE9F,OAA4B,IAAxB6d,EAAa5a,OAAqB,KAGpC,2BACEoG,UAAWC,YAAKJ,EAAQmL,UAAT,eACZnL,EAAQwrB,uBAAyBO,KAGpC,yBAAK5rB,UAAWH,EAAQyrB,iBACtB,yBAAKtrB,UAAWH,EAAQoiB,sBACtB,kBAACqI,GAAD,CAAaj1B,YAAasB,EAAkBmrB,oBAAoB,IAC/DtN,EAAahJ,KAAI,SAAAnW,GAChB,IACM4zB,EACJ5zB,IAAgBs2B,GAAmBt2B,IAAgB8e,KAFlC9e,IAAgBL,GAGnC,OACE,kBAACs1B,GAAD,CACEn0B,IAAKd,EAAY+c,IACjB/c,YAAaA,EACb+zB,WAAY/zB,IAAgBL,EAC5B+K,QAAS,kBAAM2rB,EAAuBr2B,IACtC4zB,gBAAiBA,UCzDjC,IAAM9pB,GAAYC,aAAW,SAACC,GAAD,MAAmB,CAC9C2L,UAAW,CACTyH,SAAU,WACVrE,QAAS,OACTnD,WAAY,UAEduM,SAAU,CACRhY,WAAY,qBACZE,MAAO,QACPmW,QAAS,sBACTzH,QAAS,cACT,QAAS,CACPuR,WAAY,SAEdrR,YAAa,QACbrD,WAAY,UAEd2d,cAAe,CACbnW,SAAU,WACVqD,OAAQ,EACRrd,OAAQ,OACRD,MAAO,QAETqwB,sBAAuB,CACrBpW,SAAU,WACVI,IAAK,EACL8C,MAAO,EACPD,OAAQ,EACR5C,KAAM,EACN1E,QAAS,OACTnD,WAAY,SACZoD,eAAgB,SAChB7O,WAAY,yBACZsW,OAAQ,GAEVlQ,UAAU,aACRulB,SAAU,iBACT9rB,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B4d,SAAU,kBAGd1T,gBAAiB,CACfrJ,QAAS,OACTnD,WAAY,SACZoD,eAAgB,SAChB7O,WAAY,QACZiT,SAAU,WACVI,IAAK,EACL8C,MAAO,EACPD,OAAQ,EACR5C,KAAM,EACNgD,OAAQ,EACR,QAAS,CACP9L,UAAW,iBAUF,SAAS6hB,GAAT,GAAmF,IAApDx2B,EAAmD,EAAnDA,YAAaP,EAAsC,EAAtCA,SACnD+K,EAAUV,KAEVxI,EADWL,IAATzB,KACuB8B,iBACzBoV,EAAUpV,IAAqBtB,EAE/B8e,EAAyBD,KACzB0X,EAAmCzX,GAA0BA,IAA2Bxd,EAExFkxB,EAAeD,GAAgBvyB,GAC/Bi0B,EAAmBzB,EAAahxB,MAAK,SAAAqxB,GAAC,OAAIA,EAAExT,UAAU1d,SAAS,aAC/D80B,EAAyBjE,EAAahxB,MAAK,SAAAqxB,GAAC,OAAIA,EAAExT,UAAU1d,SAAS,aAErEJ,EAAauxB,GAAS2D,GAA0BxC,GAChDxxB,EAAiB+c,QAAQje,GAGzB6D,EAAa0tB,GADMN,EAAahxB,MAAK,SAAAqxB,GAAC,MAAe,UAAXA,EAAE1uB,SAG5CgwB,EAAqBjC,GAAsB3wB,GAC3C6yB,EAA4BnB,GAA6BjzB,GAE/D,OACE,yBACE02B,4BAAA,EACArC,sBAAqBr0B,EAAYmiB,SACjCxX,UAAWC,YAAKJ,EAAQmL,UAAT,eACZnL,EAAQ+F,WAAagmB,KAGxB,yBAAK5rB,UAAWH,EAAQ+oB,eACtB,yBAAKjc,MAAO,CAAEyB,QAAS,SACrB,yBAAKpO,UAAWH,EAAQ2X,UACtB,kBAAC,GAAD,CAAqB/c,WAAYA,IACjC,kBAACoQ,GAAA,EAAD,CAAYpE,QAAQ,QAAQ/G,MAAM,WAC/BrK,EAAYmiB,SACZzL,GAAW,SACX+f,GAA0B,cAG/B,kBAACjF,GAAD,CAAqBxxB,YAAasB,QAGnCmB,GAAkB0xB,IACnB,yBAAKxpB,UAAWH,EAAQ4X,iBACtB,kBAACX,GAAD,OAGH2S,GACC,yBAAKzpB,UAAWH,EAAQgpB,uBACtB,kBAAChe,GAAA,EAAD,CAAYpE,QAAQ,QAAQkG,MAAO,CAAEjN,MAAO,UAA5C,oBAKH5K,GC/HQ,SAASk3B,KACtB,IAAML,EAAkBT,KAElBv0B,EADWL,IAATzB,KACuB8B,iBAHS,EAIVjC,IAAvBM,EAJiC,oBAKlCmf,EAAyBD,KAEzBgW,EACHyB,IAAoB32B,GAAuB22B,IAAoBxX,GAChEwX,IAAoBh1B,EAEhB,KADA,OAGN,OAGE,kBAACk1B,GAAD,CAAqBx2B,YAAas2B,GAChC,kBAACxB,GAAD,CACE90B,YAAas2B,EACb1B,WAAS,EACTI,kBAAmBsB,IAAoBh1B,EACvCuzB,cAAeA,EACfpI,mBAAoB6J,IAAoBh1B,KCtBhD,IAAMwI,GAAYC,aAAW,SAACC,GAC5B,IAAM4sB,EAAwB,UAAM5sB,EAAMspB,oBACX,EAA7BtpB,EAAMmsB,qBACNnsB,EAAMqpB,uBAFsB,MAG9B,MAAO,CACL1d,UAAU,aACRyH,SAAU,WACVha,OAAQ,OACR2V,QAAS,OACT8d,oBAAoB,OAAD,OAAS7sB,EAAMksB,aAAf,MACnBY,iBAAkB,QACjB9sB,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B2e,oBAAoB,OACpBC,iBAAiB,eAAD,OAAiBF,EAAjB,aAA8CA,KAGlEG,eAAgB,CAAEF,oBAAoB,OAAD,OAAS7sB,EAAMksB,aAAf,cAAiClsB,EAAMgtB,gBAAvC,WAI1B,SAASC,KACtB,IAAMzsB,EAAUV,KACR8R,EAAqBsB,KAArBtB,iBACR,OACE,yBAAKjR,UAAWC,YAAKJ,EAAQmL,UAAT,eAAuBnL,EAAQusB,eAAiBnb,KAClE,kBAAC+a,GAAD,MACA,kBAACP,GAAD,MACA,kBAAC/E,GAAD,OCvBN,IAAM6F,GAAY1gB,YAAO,MAAPA,CAAc,CAC9BuC,QAAS,OACT+d,iBAAkB,aAGdK,GAAO3gB,YAAO,OAAPA,EAAe,gBAAGxM,EAAH,EAAGA,MAAH,oBAC1B+X,SAAU,SACVgL,cAAc,GAAD,OAAK/iB,EAAMuW,aAAX,MACbpW,WAAY,SACXH,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B6U,cAAc,GAAD,OAAK/iB,EAAM0W,mBAAqB1W,EAAMoX,mBAAtC,WAIF,SAASgW,KACtB,IAAM7N,EAAY7O,KAOZtX,EChCO,WAAsB,IAAD,IACN1D,mBAAS+E,OAAO4yB,cAAe,UAAA5yB,OAAO6yB,sBAAP,eAAuBC,QAAS,IADzD,mBAC3Bn0B,EAD2B,KACnBo0B,EADmB,KAclC,OAXA33B,qBAAU,WACR,IAAM43B,EAAW,WAAO,IAAD,EACrBD,EAAU/yB,OAAO4yB,cAAe,UAAA5yB,OAAO6yB,sBAAP,eAAuBC,QAAS,KAIlE,OADA9yB,OAAOzB,iBAAiB,SAAUy0B,GAC3B,WACLhzB,OAAOxB,oBAAoB,SAAUw0B,OAIlCr0B,EAAS,KDkBDs0B,GAEf,OACE,kBAACR,GAAD,CAAW5f,MAAO,CAAElU,WACH,iBAAdmmB,EACC,kBAACb,GAAD,MAEA,kBAACyO,GAAD,KACE,kBAAC7N,GAAD,MACA,kBAAC9H,GAAD,MACA,kBAACyV,GAAD,MACA,kBAACpW,GAAD,Q,aENK8W,OAxBf,YAAoF,IAA7DC,EAA4D,EAA5DA,aAAc5yB,EAA8C,EAA9CA,MAA8C,EACvDA,GAAS,GAA3BG,EADyE,EACzEA,QAAS8mB,EADgE,EAChEA,KACX4L,ECfO,WAAsD,IAA9B1yB,EAA6B,uDAAnB,GAC/C,OADkE,wCAEhE,KAAK,MACH,OAAOA,EAAU,4DACnB,QACE,OAAOA,GDUa2yB,CAAe3yB,EAAS8mB,GAEhD,OACE,kBAAC3b,EAAA,EAAD,CAAQF,KAAgB,OAAVpL,EAAgBqL,QAAS,kBAAMunB,KAAgBrnB,WAAW,EAAMC,SAAS,MACrF,kBAACC,EAAA,EAAD,cACA,kBAACE,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,KAAoBinB,GACnBrY,QAAQyM,IACP,6BACE,6CAAmBA,KAIzB,kBAAC9a,EAAA,EAAD,KACE,kBAAC1G,EAAA,EAAD,CAAQC,QAAS,kBAAMktB,KAAgBvtB,MAAM,UAAUgH,WAAS,GAAhE,S,qBEwFO,IADf,ICvGMvH,GAAYC,aAAW,SAACC,GAAD,YAAmB,CAC9C+tB,cAAY,GACV5tB,WAAY,QACZE,MAAO,kBACPkT,aAAc,MACdO,OAAQ,6BACRpG,OAAQ,gBACRsgB,cAAe,OACfnS,UAAW,OACXrF,QAAS,aARC,cASTxW,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B/U,MAAO,SAVC,cAYV,UAAW,CACTgH,WAAY,QACZ0b,UAAW,SAdH,GAiBZ3X,aAAc,CACZ7D,MAAO,MACP0O,QAAS,OACTnD,WAAY,SACZ8B,OAAQ,cACR,QAAS,CACPuB,YAAa,UAGjBxD,aAAc,CACZ6C,aAAc,OAEhB2f,kBAAmB,CACjBjgB,UAAW,SAEbkgB,aAAa,eACVluB,EAAMiO,YAAYC,KAAK,MAAQ,CAC9B/U,MAAO,aAKE,SAASg1B,KACtB,IAAM3tB,EAAUV,KADkB,EAEIoG,KAA9BpB,EAF0B,EAE1BA,OAAQnB,EAFkB,EAElBA,KAAME,EAFY,EAEZA,YAChBJ,EAAUC,cACVY,EAAWiY,cAJiB,EAKF7mB,mBAAS,IALP,mBAK3ByM,EAL2B,KAKjBisB,EALiB,OAMA14B,mBAAuB,MANvB,mBAM3B24B,EAN2B,KAMhBC,EANgB,KAQ5BC,EAAgB/Y,QAAQ5T,YAoB9B,OAJI+B,GAAS4qB,GACX9qB,EAAQmB,QAAQ,KAGbf,EAKH,kBAAC,GAAD,MACGjC,EAaC,oCACE,kBAAC4J,GAAA,EAAD,CAAYpE,QAAQ,KAAKzG,UAAWH,EAAQiL,cAA5C,iCAGA,0BAAM2S,SAhCO,SAACnS,GACpBA,EAAEiT,iBATFoP,EAAa,MACP,OAANxpB,QAAM,IAANA,KAAS3C,GACNhK,MAAK,WAAO,IAAD,EACVsL,EAAQmB,SAAgB,OAARN,QAAQ,IAARA,GAAA,UAAAA,EAAU5C,aAAV,eAAiBwT,OAAQ,CAAErQ,SAAU,SAEtDvM,OAAM,SAAA0N,GAAG,OAAIsoB,EAAatoB,QAoCrB,kBAAC0F,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,iBACtB,yBAAKlL,UAAWH,EAAQytB,mBACtB,kBAAC7U,GAAA,EAAD,CAAYiF,QAAM,EAACC,QAAQ,kBAA3B,YAGA,kBAACjF,GAAA,EAAD,CACEhP,GAAG,iBACH2B,SAAU,SAACC,GAAD,OAAsCmiB,EAAYniB,EAAEpV,OAAOR,QACrEooB,KAAK,WACLrX,QAAQ,WACR8V,KAAK,UAEP,6BACGmR,GACC,kBAAC7iB,GAAA,EAAD,CAAYpE,QAAQ,UAAUzG,UAAWH,EAAQ0D,cAC/C,kBAAC,KAAD,MACCmqB,EAAUlzB,YAMrB,kBAACuQ,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,YACtB,kBAACpL,EAAA,EAAD,CACE2G,QAAQ,YACR/G,MAAM,UACNoe,KAAK,SACLhO,UAAWtO,EAAS5H,OACpBoG,UAAWH,EAAQ0tB,cALrB,cA9CH,K,cChFI,SAASM,GAAT,GAA0D,IAAlC/4B,EAAiC,EAAjCA,SAAag5B,EAAoB,+BACxCvoB,KAAtBrC,EAD8D,EAC9DA,YAEF6qB,EAHgE,EACjD/qB,OAEU,EAE/B,OAAK+qB,GAAmB7qB,EAKtB,kBAAC,IAAD,iBACM4qB,EADN,CAEEE,OAAQ,gBAAGrqB,EAAH,EAAGA,SAAH,OACNoqB,EACEj5B,EAEA,kBAAC,IAAD,CACEm5B,GAAI,CACF/pB,SAAU,SACVnD,MAAO,CAAEwT,KAAM5Q,UAblB,K,cCmBLuqB,GAAeC,eAENA,gBAAe,CAC5BC,UAAW,CACTC,eAAgB,CACd,UAAW,CACT,oBAAqB,CACnB51B,OAAQ,UAId61B,UAAW,CACTC,KAAM,CACJ3b,aAAc,MACdya,cAAe,OACf3tB,MAAO,kBACPkO,SAAU,SACVoF,WAAYkb,GAAaM,YAAY5c,OAAO,CAAC,mBAAoB,aAAc,SAAU,SAAU,CACjG6c,SAAUP,GAAaM,YAAYC,SAASC,SAGhD3P,KAAM,CACJlJ,QAAS,YAEX8Y,UAAW,CACTzT,UAAW,OACX,UAAW,CACTA,UAAW,SAGf0T,gBAAiB,CACfzb,OAAQ,oBACR,UAAW,CACTA,OAAQ,8BAGZxC,UAAW,CACTrC,YAAa,QAGjBugB,cAAe,CACbC,MAAO,CACLpvB,MAAO,kBACPkO,SAAU,WAGdmhB,aAAc,CACZR,KAAM,CACJ3gB,SAAU,WAGdohB,UAAW,CACTT,KAAM,CACJ1Y,QAAS,WAGboZ,iBAAkB,CAChBV,KAAM,CACJ1Y,QAAS,SAGbqZ,aAAc,CACZX,KAAM,CACJ7uB,MAAO,oBAGXyvB,cAAe,CACbZ,KAAM,CACJ7uB,MAAO,kBACPkO,SAAU,SACVD,aAAc,QACdwM,WAAY,MAGhBiV,iBAAkB,CAChBC,eAAgB,CACdC,YAAa,wBAInBC,WAAY,CACVhQ,WAAY,qBAEd/J,QAAS,CACPga,QAAS,CACPC,KAAM,YAGVhwB,MAAO,UACPmW,aAAc,GACdG,mBAAoB,GACpBwV,aAAc,IACd5C,oBAAqB,GACrB6C,qBAAsB,EACtB9C,uBAAwB,EACxBjS,mBAAoB,GACpB4V,gBAAiB,MCxHJ,SAASqD,KAAwB,IAAD,IACdnqB,KAAvBnC,EADqC,EACrCA,SAAU8B,EAD2B,EAC3BA,SAIZyqB,EAAoC,CAKxCC,iBAAkB,CAChBxzB,MAAO,CACLyzB,KAAM3qB,EAAS5E,qBACfD,wBAAyB6E,EAAS7E,wBAClCyvB,iBAAkB,CAChBC,IAAKjY,GAAc5S,EAASzE,oBAC5BuvB,SAAUlY,GAAc5S,EAASxE,yBACjCuvB,KAAMnY,GAAc5S,EAASvE,sBAE/BJ,UAAW2vB,OAAOhrB,EAAS3E,WAC3BH,mBAAoB8E,EAAS9E,qBAGjCoqB,iBAAiB,EACjB2F,eAAgB,CAAEC,MAAO,EAAGC,OAAQ,GAGpC7vB,gBAAiB0vB,OAAOhrB,EAAS1E,iBAMjC8vB,qBAAsB,CAAC,CAAEC,MAAO,MAAOC,UAAwB,iBAAbptB,GAA4C,OAAbA,IAGjFqtB,YAAaxvB,iKAAYyvB,8BAe3B,OAXI/6B,IAAQ,OAAIg6B,QAAJ,IAAIA,GAAJ,UAAIA,EAAmBC,wBAAvB,aAAI,EAAqCxzB,SACnDuzB,EAAmBC,iBAAkBxzB,MAAOu0B,uBAAyB,MAGtB,QAA7C1vB,iKAAYyvB,+BAEdf,EAAmBiB,SAAW,0CAKzB76B,EAAiB45B,G,wBCnDpBxwB,GAAYC,YAAW,CAC3B4L,UAAW,CACTmO,UAAW,SAEb1L,MAAO,CACLoI,QAAS,OAEXgb,QAAS,CACPljB,aAAc,WAIH,SAASmjB,GAAT,GAAoF,IAA/Ch8B,EAA8C,EAA9CA,SAC5C+K,EAAUV,KAEhB,OAAKnF,IAAMmM,YAqCJrR,EAnCH,kBAAC,KAAD,KACE,kBAACiW,GAAA,EAAD,CAAMC,WAAS,EAACE,QAAQ,SAASlL,UAAWH,EAAQmL,WAClD,kBAACD,GAAA,EAAD,CAAMwL,MAAI,EAAC+B,GAAI,GAAIE,GAAI,GACrB,kBAACuY,GAAA,EAAD,CAAO/wB,UAAWH,EAAQ4N,OACxB,kBAAC5C,GAAA,EAAD,CAAYpE,QAAQ,KAAKzG,UAAWH,EAAQgxB,SAA5C,oCAGA,kBAAChmB,GAAA,EAAD,kDAC6C,IAC3C,kBAACoQ,GAAA,EAAD,CACE6J,KAAK,kEACL5uB,OAAO,SACP2uB,IAAI,YAHN,sBAFF,IAUE,6BAVF,qFAWqF,IACnF,kBAAC5J,GAAA,EAAD,CACE6J,KAAK,wEACL5uB,OAAO,SACP2uB,IAAI,YAHN,kBAMQ,IAlBV,kCCVd,IAAMmM,GAAW,WAAO,IAAD,EACOzrB,KAApBlL,EADa,EACbA,MAAOmK,EADM,EACNA,SACTmrB,EAAoBD,KAE1B,OACE,kBAACx1B,EAAD,CAAeC,QAASw1B,EAAmBj5B,QAAS8N,GAClD,kBAAC,GAAD,CAAayoB,aAAc,kBAAMzoB,EAAS,OAAOnK,MAAOA,IACxD,kBAAC,GAAD,KACE,kBAACoyB,GAAD,SAMRwE,IAASjD,OACP,kBAAC,IAAD,CAAkB3uB,MAAOA,IACvB,kBAAC6xB,EAAA,EAAD,MACA,kBAACJ,GAAD,KACE,kBAAC,KAAD,KACE,kBAACvsB,GAAD,KACE,kBAAC,IAAD,KACE,kBAACspB,GAAD,CAAc7yB,OAAK,EAACm2B,KAAK,KACvB,kBAAC,GAAD,OAEF,kBAACtD,GAAD,CAAcsD,KAAK,sBACjB,kBAAC,GAAD,OAEF,kBAAC,IAAD,CAAOA,KAAK,UACV,kBAAC3D,GAAD,OAEF,kBAAC,IAAD,CAAUS,GAAG,WAMvB/1B,SAASk5B,eAAe,W","file":"static/js/main.a2be6a8d.chunk.js","sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { Participant, Room } from 'twilio-video';\n\ntype selectedParticipantContextType = [Participant | null, (participant: Participant) => void];\n\nexport const selectedParticipantContext = createContext<selectedParticipantContextType>(null!);\n\nexport default function useSelectedParticipant() {\n  const [selectedParticipant, setSelectedParticipant] = useContext(selectedParticipantContext);\n  return [selectedParticipant, setSelectedParticipant] as const;\n}\n\ntype SelectedParticipantProviderProps = {\n  room: Room | null;\n  children: React.ReactNode;\n};\n\nexport function SelectedParticipantProvider({ room, children }: SelectedParticipantProviderProps) {\n  const [selectedParticipant, _setSelectedParticipant] = useState<Participant | null>(null);\n  const setSelectedParticipant = (participant: Participant) =>\n    _setSelectedParticipant(prevParticipant => (prevParticipant === participant ? null : participant));\n\n  useEffect(() => {\n    if (room) {\n      const onDisconnect = () => _setSelectedParticipant(null);\n      const handleParticipantDisconnected = (participant: Participant) =>\n        _setSelectedParticipant(prevParticipant => (prevParticipant === participant ? null : prevParticipant));\n\n      room.on('disconnected', onDisconnect);\n      room.on('participantDisconnected', handleParticipantDisconnected);\n      return () => {\n        room.off('disconnected', onDisconnect);\n        room.off('participantDisconnected', handleParticipantDisconnected);\n      };\n    }\n  }, [room]);\n\n  return (\n    <selectedParticipantContext.Provider value={[selectedParticipant, setSelectedParticipant]}>\n      {children}\n    </selectedParticipantContext.Provider>\n  );\n}\n","import isPlainObject from 'is-plain-object';\n\nexport const isMobile = (() => {\n  if (typeof navigator === 'undefined' || typeof navigator.userAgent !== 'string') {\n    return false;\n  }\n  return /Mobile/.test(navigator.userAgent);\n})();\n\n// Recursively removes any object keys with a value of undefined\nexport function removeUndefineds<T>(obj: T): T {\n  if (!isPlainObject(obj)) return obj;\n\n  const target: { [name: string]: any } = {};\n\n  for (const key in obj) {\n    const val = obj[key];\n    if (typeof val !== 'undefined') {\n      target[key] = removeUndefineds(val);\n    }\n  }\n\n  return target as T;\n}\n","import { LocalVideoTrack } from 'twilio-video';\nimport { useCallback, useState } from 'react';\nimport useVideoContext from '../useVideoContext/useVideoContext';\n\nexport default function useLocalVideoToggle() {\n  const { room, localTracks, getLocalVideoTrack, removeLocalVideoTrack, onError } = useVideoContext();\n  const localParticipant = room?.localParticipant;\n  const videoTrack = localTracks.find(track => track.name.includes('camera')) as LocalVideoTrack;\n  const [isPublishing, setIspublishing] = useState(false);\n\n  const toggleVideoEnabled = useCallback(() => {\n    if (!isPublishing) {\n      if (videoTrack) {\n        const localTrackPublication = localParticipant?.unpublishTrack(videoTrack);\n        // TODO: remove when SDK implements this event. See: https://issues.corp.twilio.com/browse/JSDK-2592\n        localParticipant?.emit('trackUnpublished', localTrackPublication);\n        removeLocalVideoTrack();\n      } else {\n        setIspublishing(true);\n        getLocalVideoTrack()\n          .then((track: LocalVideoTrack) => localParticipant?.publishTrack(track, { priority: 'low' }))\n          .catch(onError)\n          .finally(() => setIspublishing(false));\n      }\n    }\n  }, [videoTrack, localParticipant, getLocalVideoTrack, isPublishing, onError, removeLocalVideoTrack]);\n\n  return [!!videoTrack, toggleVideoEnabled] as const;\n}\n","import { isMobile } from '../../../utils';\nimport { useEffect, useRef } from 'react';\nimport useLocalVideoToggle from '../../../hooks/useLocalVideoToggle/useLocalVideoToggle';\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\n\n/* \n  This component adds a visibilitychange handler to the document when\n  the user is using a mobile device. When the handler detects that\n  the browser has been backgrounded, it unpublishes the users local\n  video track. The browser cannot send video to the room when it has\n  been backgrounded, so unpublishing the track stops video capture\n  on the device, and triggers a UI update for all other participants\n  to show that this user's video track has been turned off.\n*/\n\nexport default function AttachVisibilityHandler() {\n  const { room } = useVideoContext();\n  const [isVideoEnabled, toggleVideoEnabled] = useLocalVideoToggle();\n  const shouldRepublishVideoOnForeground = useRef(false);\n\n  useEffect(() => {\n    if (room && isMobile) {\n      const handleVisibilityChange = () => {\n        // We don't need to unpublish the local video track if it has already been unpublished\n        if (document.visibilityState === 'hidden' && isVideoEnabled) {\n          shouldRepublishVideoOnForeground.current = true;\n          toggleVideoEnabled();\n\n          // Don't publish the local video track if it wasn't published before the app was backgrounded\n        } else if (shouldRepublishVideoOnForeground.current) {\n          shouldRepublishVideoOnForeground.current = false;\n          toggleVideoEnabled();\n        }\n      };\n\n      document.addEventListener('visibilitychange', handleVisibilityChange);\n      return () => {\n        document.removeEventListener('visibilitychange', handleVisibilityChange);\n      };\n    }\n  }, [isVideoEnabled, room, toggleVideoEnabled]);\n\n  return null;\n}\n","export const DEFAULT_VIDEO_CONSTRAINTS: MediaStreamConstraints['video'] = {\n  width: 1280,\n  height: 720,\n  frameRate: 24,\n};\n\n// These are used to store the selected media devices in localStorage\nexport const SELECTED_AUDIO_INPUT_KEY = 'TwilioVideoApp-selectedAudioInput';\nexport const SELECTED_AUDIO_OUTPUT_KEY = 'TwilioVideoApp-selectedAudioOutput';\nexport const SELECTED_VIDEO_INPUT_KEY = 'TwilioVideoApp-selectedVideoInput';\n","import { useState, useEffect } from 'react';\n\nexport default function useDevices() {\n  const [devices, setDevices] = useState<MediaDeviceInfo[]>([]);\n\n  useEffect(() => {\n    const getDevices = () => navigator.mediaDevices.enumerateDevices().then(newDevices => setDevices(newDevices));\n    navigator.mediaDevices.addEventListener('devicechange', getDevices);\n    getDevices();\n\n    return () => {\n      navigator.mediaDevices.removeEventListener('devicechange', getDevices);\n    };\n  }, []);\n\n  return {\n    audioInputDevices: devices.filter(device => device.kind === 'audioinput'),\n    videoInputDevices: devices.filter(device => device.kind === 'videoinput'),\n    audioOutputDevices: devices.filter(device => device.kind === 'audiooutput'),\n    hasAudioInputDevices: devices.filter(device => device.kind === 'audioinput').length > 0,\n    hasVideoInputDevices: devices.filter(device => device.kind === 'videoinput').length > 0,\n  };\n}\n","import { Callback } from '../../../types';\nimport { isMobile } from '../../../utils';\nimport Video, { ConnectOptions, LocalTrack, Room } from 'twilio-video';\nimport { useCallback, useEffect, useRef, useState } from 'react';\n\n// @ts-ignore\nwindow.TwilioVideo = Video;\n\nexport default function useRoom(localTracks: LocalTrack[], onError: Callback, options?: ConnectOptions) {\n  const [room, setRoom] = useState<Room | null>(null);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const optionsRef = useRef(options);\n\n  useEffect(() => {\n    // This allows the connect function to always access the most recent version of the options object. This allows us to\n    // reliably use the connect function at any time.\n    optionsRef.current = options;\n  }, [options]);\n\n  const connect = useCallback(\n    token => {\n      setIsConnecting(true);\n      return Video.connect(token, { ...optionsRef.current, tracks: localTracks }).then(\n        newRoom => {\n          setRoom(newRoom);\n          const disconnect = () => newRoom.disconnect();\n\n          // This app can add up to 13 'participantDisconnected' listeners to the room object, which can trigger\n          // a warning from the EventEmitter object. Here we increase the max listeners to suppress the warning.\n          newRoom.setMaxListeners(15);\n\n          newRoom.once('disconnected', () => {\n            // Reset the room only after all other `disconnected` listeners have been called.\n            setTimeout(() => setRoom(null));\n            window.removeEventListener('beforeunload', disconnect);\n\n            if (isMobile) {\n              window.removeEventListener('pagehide', disconnect);\n            }\n          });\n\n          // @ts-ignore\n          window.twilioRoom = newRoom;\n\n          newRoom.localParticipant.videoTracks.forEach(publication =>\n            // All video tracks are published with 'low' priority because the video track\n            // that is displayed in the 'MainParticipant' component will have it's priority\n            // set to 'high' via track.setPriority()\n            publication.setPriority('low')\n          );\n\n          setIsConnecting(false);\n\n          // Add a listener to disconnect from the room when a user closes their browser\n          window.addEventListener('beforeunload', disconnect);\n\n          if (isMobile) {\n            // Add a listener to disconnect from the room when a mobile user closes their browser\n            window.addEventListener('pagehide', disconnect);\n          }\n        },\n        error => {\n          onError(error);\n          setIsConnecting(false);\n        }\n      );\n    },\n    [localTracks, onError]\n  );\n\n  return { room, isConnecting, connect };\n}\n","import React, { createContext, ReactNode, useCallback } from 'react';\nimport { CreateLocalTrackOptions, ConnectOptions, LocalAudioTrack, LocalVideoTrack, Room } from 'twilio-video';\nimport { ErrorCallback } from '../../types';\nimport { SelectedParticipantProvider } from './useSelectedParticipant/useSelectedParticipant';\n\nimport AttachVisibilityHandler from './AttachVisibilityHandler/AttachVisibilityHandler';\nimport useHandleRoomDisconnection from './useHandleRoomDisconnection/useHandleRoomDisconnection';\nimport useHandleTrackPublicationFailed from './useHandleTrackPublicationFailed/useHandleTrackPublicationFailed';\nimport useLocalTracks from './useLocalTracks/useLocalTracks';\nimport useRestartAudioTrackOnDeviceChange from './useRestartAudioTrackOnDeviceChange/useRestartAudioTrackOnDeviceChange';\nimport useRoom from './useRoom/useRoom';\nimport useScreenShareToggle from './useScreenShareToggle/useScreenShareToggle';\n\n/*\n *  The hooks used by the VideoProvider component are different than the hooks found in the 'hooks/' directory. The hooks\n *  in the 'hooks/' directory can be used anywhere in a video application, and they can be used any number of times.\n *  the hooks in the 'VideoProvider/' directory are intended to be used by the VideoProvider component only. Using these hooks\n *  elsewhere in the application may cause problems as these hooks should not be used more than once in an application.\n */\n\nexport interface IVideoContext {\n  room: Room | null;\n  localTracks: (LocalAudioTrack | LocalVideoTrack)[];\n  isConnecting: boolean;\n  connect: (token: string) => Promise<void>;\n  onError: ErrorCallback;\n  getLocalVideoTrack: (newOptions?: CreateLocalTrackOptions) => Promise<LocalVideoTrack>;\n  getLocalAudioTrack: (deviceId?: string) => Promise<LocalAudioTrack>;\n  isAcquiringLocalTracks: boolean;\n  removeLocalVideoTrack: () => void;\n  isSharingScreen: boolean;\n  toggleScreenShare: () => void;\n  getAudioAndVideoTracks: () => Promise<void>;\n}\n\nexport const VideoContext = createContext<IVideoContext>(null!);\n\ninterface VideoProviderProps {\n  options?: ConnectOptions;\n  onError: ErrorCallback;\n  children: ReactNode;\n}\n\nexport function VideoProvider({ options, children, onError = () => {} }: VideoProviderProps) {\n  const onErrorCallback: ErrorCallback = useCallback(\n    error => {\n      console.log(`ERROR: ${error.message}`, error);\n      onError(error);\n    },\n    [onError]\n  );\n\n  const {\n    localTracks,\n    getLocalVideoTrack,\n    getLocalAudioTrack,\n    isAcquiringLocalTracks,\n    removeLocalAudioTrack,\n    removeLocalVideoTrack,\n    getAudioAndVideoTracks,\n  } = useLocalTracks();\n  const { room, isConnecting, connect } = useRoom(localTracks, onErrorCallback, options);\n\n  const [isSharingScreen, toggleScreenShare] = useScreenShareToggle(room, onError);\n\n  // Register callback functions to be called on room disconnect.\n  useHandleRoomDisconnection(\n    room,\n    onError,\n    removeLocalAudioTrack,\n    removeLocalVideoTrack,\n    isSharingScreen,\n    toggleScreenShare\n  );\n  useHandleTrackPublicationFailed(room, onError);\n  useRestartAudioTrackOnDeviceChange(localTracks);\n\n  return (\n    <VideoContext.Provider\n      value={{\n        room,\n        localTracks,\n        isConnecting,\n        onError: onErrorCallback,\n        getLocalVideoTrack,\n        getLocalAudioTrack,\n        connect,\n        isAcquiringLocalTracks,\n        removeLocalVideoTrack,\n        isSharingScreen,\n        toggleScreenShare,\n        getAudioAndVideoTracks,\n      }}\n    >\n      <SelectedParticipantProvider room={room}>{children}</SelectedParticipantProvider>\n      {/* \n        The AttachVisibilityHandler component is using the useLocalVideoToggle hook\n        which must be used within the VideoContext Provider.\n      */}\n      <AttachVisibilityHandler />\n    </VideoContext.Provider>\n  );\n}\n","import { DEFAULT_VIDEO_CONSTRAINTS, SELECTED_AUDIO_INPUT_KEY, SELECTED_VIDEO_INPUT_KEY } from '../../../constants';\nimport { useCallback, useState } from 'react';\nimport Video, { LocalVideoTrack, LocalAudioTrack, CreateLocalTrackOptions } from 'twilio-video';\nimport useDevices from '../../../hooks/useDevices/useDevices';\n\nexport default function useLocalTracks() {\n  const [audioTrack, setAudioTrack] = useState<LocalAudioTrack>();\n  const [videoTrack, setVideoTrack] = useState<LocalVideoTrack>();\n  const [isAcquiringLocalTracks, setIsAcquiringLocalTracks] = useState(false);\n  const { audioInputDevices, videoInputDevices, hasAudioInputDevices, hasVideoInputDevices } = useDevices();\n\n  const getLocalAudioTrack = useCallback((deviceId?: string) => {\n    const options: CreateLocalTrackOptions = {};\n\n    if (deviceId) {\n      options.deviceId = { exact: deviceId };\n    }\n\n    return Video.createLocalAudioTrack(options).then(newTrack => {\n      setAudioTrack(newTrack);\n      return newTrack;\n    });\n  }, []);\n\n  const getLocalVideoTrack = useCallback(() => {\n    const selectedVideoDeviceId = window.localStorage.getItem(SELECTED_VIDEO_INPUT_KEY);\n\n    const hasSelectedVideoDevice = videoInputDevices.some(\n      device => selectedVideoDeviceId && device.deviceId === selectedVideoDeviceId\n    );\n\n    const options: CreateLocalTrackOptions = {\n      ...(DEFAULT_VIDEO_CONSTRAINTS as {}),\n      name: `camera-${Date.now()}`,\n      ...(hasSelectedVideoDevice && { deviceId: { exact: selectedVideoDeviceId! } }),\n    };\n\n    return Video.createLocalVideoTrack(options).then(newTrack => {\n      setVideoTrack(newTrack);\n      return newTrack;\n    });\n  }, [videoInputDevices]);\n\n  const removeLocalAudioTrack = useCallback(() => {\n    if (audioTrack) {\n      audioTrack.stop();\n      setAudioTrack(undefined);\n    }\n  }, [audioTrack]);\n\n  const removeLocalVideoTrack = useCallback(() => {\n    if (videoTrack) {\n      videoTrack.stop();\n      setVideoTrack(undefined);\n    }\n  }, [videoTrack]);\n\n  const getAudioAndVideoTracks = useCallback(() => {\n    if (!hasAudioInputDevices && !hasVideoInputDevices) return Promise.resolve();\n    if (isAcquiringLocalTracks || audioTrack || videoTrack) return Promise.resolve();\n\n    setIsAcquiringLocalTracks(true);\n\n    const selectedAudioDeviceId = window.localStorage.getItem(SELECTED_AUDIO_INPUT_KEY);\n    const selectedVideoDeviceId = window.localStorage.getItem(SELECTED_VIDEO_INPUT_KEY);\n\n    const hasSelectedAudioDevice = audioInputDevices.some(\n      device => selectedAudioDeviceId && device.deviceId === selectedAudioDeviceId\n    );\n    const hasSelectedVideoDevice = videoInputDevices.some(\n      device => selectedVideoDeviceId && device.deviceId === selectedVideoDeviceId\n    );\n\n    const localTrackConstraints = {\n      video: hasVideoInputDevices && {\n        ...(DEFAULT_VIDEO_CONSTRAINTS as {}),\n        name: `camera-${Date.now()}`,\n        ...(hasSelectedVideoDevice && { deviceId: { exact: selectedVideoDeviceId! } }),\n      },\n      audio: hasSelectedAudioDevice ? { deviceId: { exact: selectedAudioDeviceId! } } : hasAudioInputDevices,\n    };\n\n    return Video.createLocalTracks(localTrackConstraints)\n      .then(tracks => {\n        const newVideoTrack = tracks.find(track => track.kind === 'video');\n        const newAudioTrack = tracks.find(track => track.kind === 'audio');\n        if (newVideoTrack) {\n          setVideoTrack(newVideoTrack as LocalVideoTrack);\n        }\n        if (newAudioTrack) {\n          setAudioTrack(newAudioTrack as LocalAudioTrack);\n        }\n      })\n      .finally(() => setIsAcquiringLocalTracks(false));\n  }, [\n    hasAudioInputDevices,\n    hasVideoInputDevices,\n    audioTrack,\n    videoTrack,\n    audioInputDevices,\n    videoInputDevices,\n    isAcquiringLocalTracks,\n  ]);\n\n  const localTracks = [audioTrack, videoTrack].filter(track => track !== undefined) as (\n    | LocalAudioTrack\n    | LocalVideoTrack\n  )[];\n\n  return {\n    localTracks,\n    getLocalVideoTrack,\n    getLocalAudioTrack,\n    isAcquiringLocalTracks,\n    removeLocalAudioTrack,\n    removeLocalVideoTrack,\n    getAudioAndVideoTracks,\n  };\n}\n","import { useState, useCallback, useRef } from 'react';\nimport { LogLevels, Track, Room } from 'twilio-video';\nimport { ErrorCallback } from '../../../types';\n\ninterface MediaStreamTrackPublishOptions {\n  name?: string;\n  priority: Track.Priority;\n  logLevel: LogLevels;\n}\n\nexport default function useScreenShareToggle(room: Room | null, onError: ErrorCallback) {\n  const [isSharing, setIsSharing] = useState(false);\n  const stopScreenShareRef = useRef<() => void>(null!);\n\n  const shareScreen = useCallback(() => {\n    navigator.mediaDevices\n      .getDisplayMedia({\n        audio: false,\n        video: {\n          frameRate: 10,\n          height: 1080,\n          width: 1920,\n        },\n      })\n      .then(stream => {\n        const track = stream.getTracks()[0];\n\n        // All video tracks are published with 'low' priority. This works because the video\n        // track that is displayed in the 'MainParticipant' component will have it's priority\n        // set to 'high' via track.setPriority()\n        room!.localParticipant\n          .publishTrack(track, {\n            name: 'screen', // Tracks can be named to easily find them later\n            priority: 'low', // Priority is set to high by the subscriber when the video track is rendered\n          } as MediaStreamTrackPublishOptions)\n          .then(trackPublication => {\n            stopScreenShareRef.current = () => {\n              room!.localParticipant.unpublishTrack(track);\n              // TODO: remove this if the SDK is updated to emit this event\n              room!.localParticipant.emit('trackUnpublished', trackPublication);\n              track.stop();\n              setIsSharing(false);\n            };\n\n            track.onended = stopScreenShareRef.current;\n            setIsSharing(true);\n          })\n          .catch(onError);\n      })\n      .catch(error => {\n        // Don't display an error if the user closes the screen share dialog\n        if (error.name !== 'AbortError' && error.name !== 'NotAllowedError') {\n          onError(error);\n        }\n      });\n  }, [room, onError]);\n\n  const toggleScreenShare = useCallback(() => {\n    if (room) {\n      !isSharing ? shareScreen() : stopScreenShareRef.current();\n    }\n  }, [isSharing, shareScreen, stopScreenShareRef, room]);\n\n  return [isSharing, toggleScreenShare] as const;\n}\n","import { Room, TwilioError } from 'twilio-video';\nimport { useEffect } from 'react';\n\nimport { Callback } from '../../../types';\n\nexport default function useHandleRoomDisconnection(\n  room: Room | null,\n  onError: Callback,\n  removeLocalAudioTrack: () => void,\n  removeLocalVideoTrack: () => void,\n  isSharingScreen: boolean,\n  toggleScreenShare: () => void\n) {\n  useEffect(() => {\n    if (room) {\n      const onDisconnected = (_: Room, error: TwilioError) => {\n        if (error) {\n          onError(error);\n        }\n\n        removeLocalAudioTrack();\n        removeLocalVideoTrack();\n        if (isSharingScreen) {\n          toggleScreenShare();\n        }\n      };\n\n      room.on('disconnected', onDisconnected);\n      return () => {\n        room.off('disconnected', onDisconnected);\n      };\n    }\n  }, [room, onError, removeLocalAudioTrack, removeLocalVideoTrack, isSharingScreen, toggleScreenShare]);\n}\n","import { Room } from 'twilio-video';\nimport { useEffect } from 'react';\n\nimport { Callback } from '../../../types';\n\nexport default function useHandleTrackPublicationFailed(room: Room | null, onError: Callback) {\n  useEffect(() => {\n    if (room) {\n      room.localParticipant.on('trackPublicationFailed', onError);\n      return () => {\n        room.localParticipant.off('trackPublicationFailed', onError);\n      };\n    }\n  }, [room, onError]);\n}\n","import { LocalAudioTrack, LocalVideoTrack } from 'twilio-video';\nimport { useEffect } from 'react';\n\n/*\n * If a user has published an audio track from an external audio input device and\n * disconnects the device, the published audio track will be stopped and the user\n * will no longer be heard by other participants.\n *\n * To prevent this issue, this hook will re-acquire a mediaStreamTrack from the system's\n * default audio device when it detects that the published audio device has been disconnected.\n */\n\nexport default function useRestartAudioTrackOnDeviceChange(localTracks: (LocalAudioTrack | LocalVideoTrack)[]) {\n  const audioTrack = localTracks.find(track => track.kind === 'audio');\n\n  useEffect(() => {\n    const handleDeviceChange = () => {\n      if (audioTrack?.mediaStreamTrack.readyState === 'ended') {\n        audioTrack.restart({});\n      }\n    };\n\n    navigator.mediaDevices.addEventListener('devicechange', handleDeviceChange);\n\n    return () => {\n      navigator.mediaDevices.removeEventListener('devicechange', handleDeviceChange);\n    };\n  }, [audioTrack]);\n}\n","import { useContext } from 'react';\nimport { VideoContext } from '../../components/VideoProvider';\n\nexport default function useVideoContext() {\n  const context = useContext(VideoContext);\n  if (!context) {\n    throw new Error('useVideoContext must be used within a VideoProvider');\n  }\n  return context;\n}\n","import React from 'react';\nimport clsx from 'clsx';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nimport { Button } from '@material-ui/core';\n\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    button: {\n      background: theme.brand,\n      color: 'white',\n      '&:hover': {\n        background: '#600101',\n      },\n    },\n  })\n);\n\nexport default function EndCallButton(props: { className?: string }) {\n  const classes = useStyles();\n  const { room } = useVideoContext();\n\n  return (\n    <Button onClick={() => room!.disconnect()} className={clsx(classes.button, props.className)} data-cy-disconnect>\n      Disconnect\n    </Button>\n  );\n}\n","import { isMobile } from '../../utils';\nimport { RenderDimensionValue } from './renderDimensions';\nimport { Track, VideoBandwidthProfileOptions } from 'twilio-video';\n\nexport interface Settings {\n  trackSwitchOffMode: VideoBandwidthProfileOptions['trackSwitchOffMode'];\n  dominantSpeakerPriority?: Track.Priority;\n  bandwidthProfileMode: VideoBandwidthProfileOptions['mode'];\n  maxTracks: string;\n  maxAudioBitrate: string;\n  renderDimensionLow?: RenderDimensionValue;\n  renderDimensionStandard?: RenderDimensionValue;\n  renderDimensionHigh?: RenderDimensionValue;\n}\n\ntype SettingsKeys = keyof Settings;\n\nexport interface SettingsAction {\n  name: SettingsKeys;\n  value: string;\n}\n\nexport const initialSettings: Settings = {\n  trackSwitchOffMode: undefined,\n  dominantSpeakerPriority: 'standard',\n  bandwidthProfileMode: 'collaboration',\n  maxTracks: isMobile ? '5' : '10',\n  maxAudioBitrate: '16000',\n  renderDimensionLow: 'low',\n  renderDimensionStandard: '960p',\n  renderDimensionHigh: 'wide1080p',\n};\n\n// This inputLabels object is used by ConnectionOptions.tsx. It is used to populate the id, name, and label props\n// of the various input elements. Using a typed object like this (instead of strings) eliminates the possibility\n// of there being a typo.\nexport const inputLabels = (() => {\n  const target: any = {};\n  for (const setting in initialSettings) {\n    target[setting] = setting as SettingsKeys;\n  }\n  return target as { [key in SettingsKeys]: string };\n})();\n\nexport function settingsReducer(state: Settings, action: SettingsAction) {\n  return {\n    ...state,\n    [action.name]: action.value === 'default' ? undefined : action.value,\n  };\n}\n","import { useCallback, useEffect, useState } from 'react';\nimport * as firebase from 'firebase/app';\nimport 'firebase/auth';\n\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n};\n\nexport default function useFirebaseAuth() {\n  const [user, setUser] = useState<firebase.User | null>(null);\n  const [isAuthReady, setIsAuthReady] = useState(false);\n\n  const getToken = useCallback(\n    async (user_identity: string, room_name: string) => {\n      const headers = new window.Headers();\n\n      const idToken = await user!.getIdToken();\n      headers.set('Authorization', idToken);\n      headers.set('content-type', 'application/json');\n\n      const endpoint = process.env.REACT_APP_TOKEN_ENDPOINT || '/token';\n\n      return fetch(endpoint, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify({\n          user_identity,\n          room_name,\n          create_conversation: process.env.REACT_APP_DISABLE_TWILIO_CONVERSATIONS !== 'true',\n        }),\n      })\n        .then(res => res.json())\n        .then(res => res.token as string);\n    },\n    [user]\n  );\n\n  useEffect(() => {\n    firebase.initializeApp(firebaseConfig);\n    firebase.auth().onAuthStateChanged(newUser => {\n      setUser(newUser);\n      setIsAuthReady(true);\n    });\n  }, []);\n\n  const signIn = useCallback(() => {\n    const provider = new firebase.auth.GoogleAuthProvider();\n    provider.addScope('https://www.googleapis.com/auth/plus.login');\n\n    return firebase\n      .auth()\n      .signInWithPopup(provider)\n      .then(newUser => {\n        setUser(newUser.user);\n      });\n  }, []);\n\n  const signOut = useCallback(() => {\n    return firebase\n      .auth()\n      .signOut()\n      .then(() => {\n        setUser(null);\n      });\n  }, []);\n\n  return { user, signIn, signOut, isAuthReady, getToken };\n}\n","import { useCallback, useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { RoomType } from '../../types';\n\nexport function getPasscode() {\n  const match = window.location.search.match(/passcode=(.*)&?/);\n  const passcode = match ? match[1] : window.sessionStorage.getItem('passcode');\n  return passcode;\n}\n\nexport function fetchToken(\n  name: string,\n  room: string,\n  passcode: string,\n  create_room = true,\n  create_conversation = process.env.REACT_APP_DISABLE_TWILIO_CONVERSATIONS !== 'true'\n) {\n  return fetch(`/token`, {\n    method: 'POST',\n    headers: {\n      'content-type': 'application/json',\n    },\n    body: JSON.stringify({\n      user_identity: name,\n      room_name: room,\n      passcode,\n      create_room,\n      create_conversation,\n    }),\n  });\n}\n\nexport function verifyPasscode(passcode: string) {\n  return fetchToken('temp-name', 'temp-room', passcode, false /* create_room */, false /* create_conversation */).then(\n    async res => {\n      const jsonResponse = await res.json();\n      if (res.status === 401) {\n        return { isValid: false, error: jsonResponse.error?.message };\n      }\n\n      if (res.ok && jsonResponse.token) {\n        return { isValid: true };\n      }\n    }\n  );\n}\n\nexport function getErrorMessage(message: string) {\n  switch (message) {\n    case 'passcode incorrect':\n      return 'Passcode is incorrect';\n    case 'passcode expired':\n      return 'Passcode has expired';\n    default:\n      return message;\n  }\n}\n\nexport default function usePasscodeAuth() {\n  const history = useHistory();\n\n  const [user, setUser] = useState<{ displayName: undefined; photoURL: undefined; passcode: string } | null>(null);\n  const [isAuthReady, setIsAuthReady] = useState(false);\n  const [roomType, setRoomType] = useState<RoomType>();\n\n  const getToken = useCallback(\n    (name: string, room: string) => {\n      return fetchToken(name, room, user!.passcode)\n        .then(async res => {\n          if (res.ok) {\n            return res;\n          }\n          const json = await res.json();\n          const errorMessage = getErrorMessage(json.error?.message || res.statusText);\n          throw Error(errorMessage);\n        })\n        .then(res => res.json())\n        .then(res => {\n          setRoomType(res.room_type);\n          return res.token as string;\n        });\n    },\n    [user]\n  );\n\n  useEffect(() => {\n    const passcode = getPasscode();\n\n    if (passcode) {\n      verifyPasscode(passcode)\n        .then(verification => {\n          if (verification?.isValid) {\n            setUser({ passcode } as any);\n            window.sessionStorage.setItem('passcode', passcode);\n            history.replace(window.location.pathname);\n          }\n        })\n        .then(() => setIsAuthReady(true));\n    } else {\n      setIsAuthReady(true);\n    }\n  }, [history]);\n\n  const signIn = useCallback((passcode: string) => {\n    return verifyPasscode(passcode).then(verification => {\n      if (verification?.isValid) {\n        setUser({ passcode } as any);\n        window.sessionStorage.setItem('passcode', passcode);\n      } else {\n        throw new Error(getErrorMessage(verification?.error));\n      }\n    });\n  }, []);\n\n  const signOut = useCallback(() => {\n    setUser(null);\n    window.sessionStorage.removeItem('passcode');\n    return Promise.resolve();\n  }, []);\n\n  return { user, isAuthReady, getToken, signIn, signOut, roomType };\n}\n","import React, { createContext, useContext, useReducer, useState } from 'react';\nimport { RoomType } from '../types';\nimport { TwilioError } from 'twilio-video';\nimport { settingsReducer, initialSettings, Settings, SettingsAction } from './settings/settingsReducer';\nimport useActiveSinkId from './useActiveSinkId/useActiveSinkId';\nimport useFirebaseAuth from './useFirebaseAuth/useFirebaseAuth';\nimport usePasscodeAuth from './usePasscodeAuth/usePasscodeAuth';\nimport { User } from 'firebase';\n\nexport interface StateContextType {\n  error: TwilioError | Error | null;\n  setError(error: TwilioError | Error | null): void;\n  getToken(name: string, room: string, passcode?: string): Promise<string>;\n  user?: User | null | { displayName: undefined; photoURL: undefined; passcode?: string };\n  signIn?(passcode?: string): Promise<void>;\n  signOut?(): Promise<void>;\n  isAuthReady?: boolean;\n  isFetching: boolean;\n  activeSinkId: string;\n  setActiveSinkId(sinkId: string): void;\n  settings: Settings;\n  dispatchSetting: React.Dispatch<SettingsAction>;\n  roomType?: RoomType;\n}\n\nexport const StateContext = createContext<StateContextType>(null!);\n\n/*\n  The 'react-hooks/rules-of-hooks' linting rules prevent React Hooks fron being called\n  inside of if() statements. This is because hooks must always be called in the same order\n  every time a component is rendered. The 'react-hooks/rules-of-hooks' rule is disabled below\n  because the \"if (process.env.REACT_APP_SET_AUTH === 'firebase')\" statements are evaluated\n  at build time (not runtime). If the statement evaluates to false, then the code is not\n  included in the bundle that is produced (due to tree-shaking). Thus, in this instance, it\n  is ok to call hooks inside if() statements.\n*/\nexport default function AppStateProvider(props: React.PropsWithChildren<{}>) {\n  const [error, setError] = useState<TwilioError | null>(null);\n  const [isFetching, setIsFetching] = useState(false);\n  const [activeSinkId, setActiveSinkId] = useActiveSinkId();\n  const [settings, dispatchSetting] = useReducer(settingsReducer, initialSettings);\n\n  let contextValue = {\n    error,\n    setError,\n    isFetching,\n    activeSinkId,\n    setActiveSinkId,\n    settings,\n    dispatchSetting,\n  } as StateContextType;\n\n  if (process.env.REACT_APP_SET_AUTH === 'firebase') {\n    contextValue = {\n      ...contextValue,\n      ...useFirebaseAuth(), // eslint-disable-line react-hooks/rules-of-hooks\n    };\n  } else if (process.env.REACT_APP_SET_AUTH === 'passcode') {\n    contextValue = {\n      ...contextValue,\n      ...usePasscodeAuth(), // eslint-disable-line react-hooks/rules-of-hooks\n    };\n  } else {\n    contextValue = {\n      ...contextValue,\n      getToken: async (user_identity, room_name) => {\n        const endpoint = process.env.REACT_APP_TOKEN_ENDPOINT || '/token';\n\n        return fetch(endpoint, {\n          method: 'POST',\n          headers: {\n            'content-type': 'application/json',\n          },\n          body: JSON.stringify({\n            user_identity,\n            room_name,\n            create_conversation: process.env.REACT_APP_DISABLE_TWILIO_CONVERSATIONS !== 'true',\n          }),\n        })\n          .then(res => res.json())\n          .then(res => res.token as string);\n      },\n    };\n  }\n\n  const getToken: StateContextType['getToken'] = (name, room) => {\n    setIsFetching(true);\n    return contextValue\n      .getToken(name, room)\n      .then(res => {\n        setIsFetching(false);\n        return res;\n      })\n      .catch(err => {\n        setError(err);\n        setIsFetching(false);\n        return Promise.reject(err);\n      });\n  };\n\n  return <StateContext.Provider value={{ ...contextValue, getToken }}>{props.children}</StateContext.Provider>;\n}\n\nexport function useAppState() {\n  const context = useContext(StateContext);\n  if (!context) {\n    throw new Error('useAppState must be used within the AppStateProvider');\n  }\n  return context;\n}\n","import { useCallback, useEffect, useState } from 'react';\nimport { SELECTED_AUDIO_OUTPUT_KEY } from '../../constants';\nimport useDevices from '../../hooks/useDevices/useDevices';\n\nexport default function useActiveSinkId() {\n  const { audioOutputDevices } = useDevices();\n  const [activeSinkId, _setActiveSinkId] = useState('default');\n\n  const setActiveSinkId = useCallback(\n    (sinkId: string) => {\n      window.localStorage.setItem(SELECTED_AUDIO_OUTPUT_KEY, sinkId);\n      _setActiveSinkId(sinkId);\n    },\n    [_setActiveSinkId]\n  );\n\n  useEffect(() => {\n    const selectedSinkId = window.localStorage.getItem(SELECTED_AUDIO_OUTPUT_KEY);\n    const hasSelectedAudioOutputDevice = audioOutputDevices.some(\n      device => selectedSinkId && device.deviceId === selectedSinkId\n    );\n    if (hasSelectedAudioOutputDevice) {\n      _setActiveSinkId(selectedSinkId!);\n    }\n  }, [audioOutputDevices]);\n\n  return [activeSinkId, setActiveSinkId] as const;\n}\n","import React, { PropsWithChildren } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Divider from '@material-ui/core/Divider';\n\nimport { version as appVersion } from '../../../package.json';\nimport Video from 'twilio-video';\nimport { useAppState } from '../../state';\n\ninterface AboutDialogProps {\n  open: boolean;\n  onClose(): void;\n}\n\nfunction AboutDialog({ open, onClose }: PropsWithChildren<AboutDialogProps>) {\n  const { roomType } = useAppState();\n  return (\n    <Dialog open={open} onClose={onClose} fullWidth={true} maxWidth=\"xs\">\n      <DialogTitle>About</DialogTitle>\n      <Divider />\n      <DialogContent>\n        <DialogContentText>Browser supported: {String(Video.isSupported)}</DialogContentText>\n        <DialogContentText>SDK Version: {Video.version}</DialogContentText>\n        <DialogContentText>App Version: {appVersion}</DialogContentText>\n        <DialogContentText>Deployed Tag: {process.env.REACT_APP_GIT_TAG || 'N/A'}</DialogContentText>\n        <DialogContentText>Deployed Commit Hash: {process.env.REACT_APP_GIT_COMMIT || 'N/A'}</DialogContentText>\n        {roomType && <DialogContentText>Room Type: {roomType}</DialogContentText>}\n      </DialogContent>\n      <Divider />\n      <DialogActions>\n        <Button onClick={onClose} color=\"primary\" variant=\"contained\" autoFocus>\n          OK\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n\nexport default AboutDialog;\n","import { useState, useEffect } from 'react';\nimport { LocalAudioTrack, LocalVideoTrack, RemoteAudioTrack, RemoteVideoTrack } from 'twilio-video';\n\ntype TrackType = LocalAudioTrack | LocalVideoTrack | RemoteAudioTrack | RemoteVideoTrack | undefined;\n\nexport default function useIsTrackEnabled(track: TrackType) {\n  const [isEnabled, setIsEnabled] = useState(track ? track.isEnabled : false);\n\n  useEffect(() => {\n    setIsEnabled(track ? track.isEnabled : false);\n\n    if (track) {\n      const setEnabled = () => setIsEnabled(true);\n      const setDisabled = () => setIsEnabled(false);\n      track.on('enabled', setEnabled);\n      track.on('disabled', setDisabled);\n      return () => {\n        track.off('enabled', setEnabled);\n        track.off('disabled', setDisabled);\n      };\n    }\n  }, [track]);\n\n  return isEnabled;\n}\n","import { useState, useEffect } from 'react';\nimport { AudioTrack, VideoTrack } from 'twilio-video';\n\n/*\n * This hook allows components to reliably use the 'mediaStreamTrack' property of\n * an AudioTrack or a VideoTrack. Whenever 'localTrack.restart(...)' is called, it\n * will replace the mediaStreamTrack property of the localTrack, but the localTrack\n * object will stay the same. Therefore this hook is needed in order for components\n * to rerender in response to the mediaStreamTrack changing.\n */\nexport default function useMediaStreamTrack(track?: AudioTrack | VideoTrack) {\n  const [mediaStreamTrack, setMediaStreamTrack] = useState(track?.mediaStreamTrack);\n\n  useEffect(() => {\n    setMediaStreamTrack(track?.mediaStreamTrack);\n\n    if (track) {\n      const handleStarted = () => setMediaStreamTrack(track.mediaStreamTrack);\n      track.on('started', handleStarted);\n      return () => {\n        track.off('started', handleStarted);\n      };\n    }\n  }, [track]);\n\n  return mediaStreamTrack;\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport { AudioTrack, LocalAudioTrack, RemoteAudioTrack } from 'twilio-video';\nimport { interval } from 'd3-timer';\nimport useIsTrackEnabled from '../../hooks/useIsTrackEnabled/useIsTrackEnabled';\nimport useMediaStreamTrack from '../../hooks/useMediaStreamTrack/useMediaStreamTrack';\n\nlet clipId = 0;\nconst getUniqueClipId = () => clipId++;\n\n// @ts-ignore\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\nlet audioContext: AudioContext;\n\nexport function initializeAnalyser(stream: MediaStream) {\n  audioContext = audioContext || new AudioContext();\n  const audioSource = audioContext.createMediaStreamSource(stream);\n\n  const analyser = audioContext.createAnalyser();\n  analyser.smoothingTimeConstant = 0.2;\n  analyser.fftSize = 256;\n\n  audioSource.connect(analyser);\n  return analyser;\n}\n\nfunction AudioLevelIndicator({ audioTrack, color = 'white' }: { audioTrack?: AudioTrack; color?: string }) {\n  const SVGRectRef = useRef<SVGRectElement>(null);\n  const [analyser, setAnalyser] = useState<AnalyserNode>();\n  const isTrackEnabled = useIsTrackEnabled(audioTrack as LocalAudioTrack | RemoteAudioTrack);\n  const mediaStreamTrack = useMediaStreamTrack(audioTrack);\n\n  useEffect(() => {\n    if (audioTrack && mediaStreamTrack && isTrackEnabled) {\n      // Here we create a new MediaStream from a clone of the mediaStreamTrack.\n      // A clone is created to allow multiple instances of this component for a single\n      // AudioTrack on iOS Safari.\n      let newMediaStream = new MediaStream([mediaStreamTrack.clone()]);\n\n      // Here we listen for the 'stopped' event on the audioTrack. When the audioTrack is stopped,\n      // we stop the cloned track that is stored in 'newMediaStream'. It is important that we stop\n      // all tracks when they are not in use. Browsers like Firefox don't let you create a new stream\n      // from a new audio device while the active audio device still has active tracks.\n      const stopAllMediaStreamTracks = () => newMediaStream.getTracks().forEach(track => track.stop());\n      audioTrack.on('stopped', stopAllMediaStreamTracks);\n\n      const reinitializeAnalyser = () => {\n        stopAllMediaStreamTracks();\n        newMediaStream = new MediaStream([mediaStreamTrack.clone()]);\n        setAnalyser(initializeAnalyser(newMediaStream));\n      };\n\n      setAnalyser(initializeAnalyser(newMediaStream));\n\n      // Here we reinitialize the AnalyserNode on focus to avoid an issue in Safari\n      // where the analysers stop functioning when the user switches to a new tab\n      // and switches back to the app.\n      window.addEventListener('focus', reinitializeAnalyser);\n\n      return () => {\n        stopAllMediaStreamTracks();\n        window.removeEventListener('focus', reinitializeAnalyser);\n        audioTrack.off('stopped', stopAllMediaStreamTracks);\n      };\n    }\n  }, [isTrackEnabled, mediaStreamTrack, audioTrack]);\n\n  useEffect(() => {\n    const SVGClipElement = SVGRectRef.current;\n\n    if (isTrackEnabled && SVGClipElement && analyser) {\n      const sampleArray = new Uint8Array(analyser.frequencyBinCount);\n\n      const timer = interval(() => {\n        analyser.getByteFrequencyData(sampleArray);\n        let values = 0;\n\n        const length = sampleArray.length;\n        for (let i = 0; i < length; i++) {\n          values += sampleArray[i];\n        }\n\n        const volume = Math.min(14, Math.max(0, Math.log10(values / length / 3) * 7));\n\n        SVGClipElement?.setAttribute('y', String(14 - volume));\n      }, 100);\n\n      return () => {\n        SVGClipElement.setAttribute('y', '14');\n        timer.stop();\n      };\n    }\n  }, [isTrackEnabled, analyser]);\n\n  // Each instance of this component will need a unique HTML ID\n  const clipPathId = `audio-level-clip-${getUniqueClipId()}`;\n\n  return isTrackEnabled ? (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" data-test-audio-indicator>\n      <defs>\n        <clipPath id={clipPathId}>\n          <rect ref={SVGRectRef} x=\"0\" y=\"14\" width=\"24\" height=\"24\" />\n        </clipPath>\n      </defs>\n      <g fill=\"none\" fillRule=\"evenodd\" transform=\"translate(.5)\">\n        <rect\n          clipPath={`url(#${clipPathId})`}\n          width=\"5.2\"\n          height=\"10\"\n          x=\"9.5\"\n          y=\"3.5\"\n          rx=\"6\"\n          ry=\"3\"\n          fill=\"#23BF6E\"\n        ></rect>\n        <path\n          fill={color}\n          strokeWidth=\"0\"\n          d=\"M17.389 10.667c.276 0 .5.224.5.5 0 3.114-2.396 5.67-5.445 5.923v2.632c0 .276-.223.5-.5.5-.245 0-.45-.177-.491-.41l-.009-.09V17.09C8.395 16.836 6 14.281 6 11.167c0-.276.224-.5.5-.5s.5.224.5.5c0 2.73 2.214 4.944 4.944 4.944 2.731 0 4.945-2.214 4.945-4.944 0-.276.224-.5.5-.5zM11.944 4c1.566 0 2.834 1.268 2.834 2.833v4.334c0 1.564-1.268 2.833-2.834 2.833-1.564 0-2.833-1.27-2.833-2.833V6.833C9.111 5.268 10.38 4 11.944 4zm0 1c-1.012 0-1.833.82-1.833 1.833v4.334c0 1.012.822 1.833 1.833 1.833 1.013 0 1.834-.82 1.834-1.833V6.833c0-1.013-.82-1.833-1.834-1.833z\"\n        />\n      </g>\n    </svg>\n  ) : (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"24\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      transform=\"translate(-0.5, 0)\"\n      data-test-audio-mute-icon\n    >\n      <g fill=\"none\" fillRule=\"evenodd\">\n        <path\n          fill={color}\n          strokeWidth=\"0\"\n          d=\"M11.889 6.667c.276 0 .5.224.5.5 0 3.114-2.396 5.67-5.445 5.923v2.632c0 .276-.223.5-.5.5-.245 0-.45-.177-.491-.41l-.009-.09V13.09c-1.116-.093-2.145-.494-3-1.119l.717-.717c.793.54 1.751.857 2.783.857 2.731 0 4.945-2.214 4.945-4.944 0-.276.224-.5.5-.5zM1 6.667c.276 0 .5.224.5.5 0 .975.282 1.884.77 2.65l-.722.721C.888 9.58.5 8.418.5 7.167c0-.276.224-.5.5-.5zm8.277-1.031v1.53C9.278 8.732 8.01 10 6.445 10c-.446 0-.868-.103-1.243-.287l.776-.773c.149.039.306.06.467.06.963 0 1.751-.74 1.828-1.683l.006-.15v-.531l1-1zM6.444 0C8.01 0 9.278 1.268 9.278 2.833l-.002-.025-.999.999v-.974c0-.962-.74-1.75-1.682-1.827L6.445 1c-.962 0-1.751.74-1.828 1.683l-.006.15v4.334c0 .097.008.192.022.285l-.804.805c-.112-.269-.184-.558-.209-.86l-.009-.23V2.833C3.611 1.268 4.88 0 6.444 0z\"\n          transform=\"translate(6.5 4)\"\n        />\n        <path\n          fill=\"red\"\n          strokeWidth=\"0\"\n          d=\"M12.146.646c.196-.195.512-.195.708 0 .173.174.192.443.057.638l-.057.07-12 12c-.196.195-.512.195-.708 0-.173-.174-.192-.443-.057-.638l.057-.07 12-12z\"\n          transform=\"translate(6.5 4)\"\n        />\n      </g>\n    </svg>\n  );\n}\n\nexport default React.memo(AudioLevelIndicator);\n","import React from 'react';\nimport AudioLevelIndicator from '../../AudioLevelIndicator/AudioLevelIndicator';\nimport { LocalAudioTrack } from 'twilio-video';\nimport { FormControl, MenuItem, Typography, Select, Grid } from '@material-ui/core';\nimport { SELECTED_AUDIO_INPUT_KEY } from '../../../constants';\nimport useDevices from '../../../hooks/useDevices/useDevices';\nimport useMediaStreamTrack from '../../../hooks/useMediaStreamTrack/useMediaStreamTrack';\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\n\nexport default function AudioInputList() {\n  const { audioInputDevices } = useDevices();\n  const { localTracks } = useVideoContext();\n\n  const localAudioTrack = localTracks.find(track => track.kind === 'audio') as LocalAudioTrack;\n  const mediaStreamTrack = useMediaStreamTrack(localAudioTrack);\n  const localAudioInputDeviceId = mediaStreamTrack?.getSettings().deviceId;\n\n  function replaceTrack(newDeviceId: string) {\n    window.localStorage.setItem(SELECTED_AUDIO_INPUT_KEY, newDeviceId);\n    localAudioTrack?.restart({ deviceId: { exact: newDeviceId } });\n  }\n\n  return (\n    <div>\n      <Typography variant=\"subtitle2\" gutterBottom>\n        Audio Input\n      </Typography>\n      <Grid container alignItems=\"center\" justify=\"space-between\">\n        <div className=\"inputSelect\">\n          {audioInputDevices.length > 1 ? (\n            <FormControl fullWidth>\n              <Select\n                onChange={e => replaceTrack(e.target.value as string)}\n                value={localAudioInputDeviceId || ''}\n                variant=\"outlined\"\n              >\n                {audioInputDevices.map(device => (\n                  <MenuItem value={device.deviceId} key={device.deviceId}>\n                    {device.label}\n                  </MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n          ) : (\n            <Typography>{localAudioTrack?.mediaStreamTrack.label || 'No Local Audio'}</Typography>\n          )}\n        </div>\n        <AudioLevelIndicator audioTrack={localAudioTrack} color=\"black\" />\n      </Grid>\n    </div>\n  );\n}\n","import React from 'react';\nimport { FormControl, MenuItem, Typography, Select } from '@material-ui/core';\nimport { useAppState } from '../../../state';\nimport useDevices from '../../../hooks/useDevices/useDevices';\n\nexport default function AudioOutputList() {\n  const { audioOutputDevices } = useDevices();\n  const { activeSinkId, setActiveSinkId } = useAppState();\n  const activeOutputLabel = audioOutputDevices.find(device => device.deviceId === activeSinkId)?.label;\n\n  return (\n    <div className=\"inputSelect\">\n      {audioOutputDevices.length > 1 ? (\n        <FormControl fullWidth>\n          <Typography variant=\"subtitle2\" gutterBottom>\n            Audio Output\n          </Typography>\n          <Select onChange={e => setActiveSinkId(e.target.value as string)} value={activeSinkId} variant=\"outlined\">\n            {audioOutputDevices.map(device => (\n              <MenuItem value={device.deviceId} key={device.deviceId}>\n                {device.label}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n      ) : (\n        <>\n          <Typography variant=\"subtitle2\">Audio Output</Typography>\n          <Typography>{activeOutputLabel || 'System Default Audio Output'}</Typography>\n        </>\n      )}\n    </div>\n  );\n}\n","import React, { useRef, useEffect } from 'react';\nimport { IVideoTrack } from '../../types';\nimport { styled } from '@material-ui/core/styles';\nimport { Track } from 'twilio-video';\nimport useMediaStreamTrack from '../../hooks/useMediaStreamTrack/useMediaStreamTrack';\nimport useVideoTrackDimensions from '../../hooks/useVideoTrackDimensions/useVideoTrackDimensions';\n\nconst Video = styled('video')({\n  width: '100%',\n  height: '100%',\n});\n\ninterface VideoTrackProps {\n  track: IVideoTrack;\n  isLocal?: boolean;\n  priority?: Track.Priority | null;\n}\n\nexport default function VideoTrack({ track, isLocal, priority }: VideoTrackProps) {\n  const ref = useRef<HTMLVideoElement>(null!);\n  const mediaStreamTrack = useMediaStreamTrack(track);\n  const dimensions = useVideoTrackDimensions(track);\n  const isPortrait = (dimensions?.height ?? 0) > (dimensions?.width ?? 0);\n\n  useEffect(() => {\n    const el = ref.current;\n    el.muted = true;\n    if (track.setPriority && priority) {\n      track.setPriority(priority);\n    }\n    track.attach(el);\n    return () => {\n      track.detach(el);\n      if (track.setPriority && priority) {\n        // Passing `null` to setPriority will set the track's priority to that which it was published with.\n        track.setPriority(null);\n      }\n    };\n  }, [track, priority]);\n\n  // The local video track is mirrored if it is not facing the environment.\n  const isFrontFacing = mediaStreamTrack?.getSettings().facingMode !== 'environment';\n  const style = {\n    transform: isLocal && isFrontFacing ? 'rotateY(180deg)' : '',\n    objectFit: isPortrait || track.name.includes('screen') ? ('contain' as const) : ('cover' as const),\n  };\n\n  return <Video ref={ref} style={style} />;\n}\n","import { useState, useEffect } from 'react';\nimport { LocalVideoTrack, RemoteVideoTrack } from 'twilio-video';\n\ntype TrackType = LocalVideoTrack | RemoteVideoTrack;\n\nexport default function useVideoTrackDimensions(track?: TrackType) {\n  const [dimensions, setDimensions] = useState(track?.dimensions);\n\n  useEffect(() => {\n    setDimensions(track?.dimensions);\n\n    if (track) {\n      const handleDimensionsChanged = (newTrack: TrackType) =>\n        setDimensions({\n          width: newTrack.dimensions.width,\n          height: newTrack.dimensions.height,\n        });\n      track.on('dimensionsChanged', handleDimensionsChanged);\n      return () => {\n        track.off('dimensionsChanged', handleDimensionsChanged);\n      };\n    }\n  }, [track]);\n\n  return dimensions;\n}\n","import React, { useState } from 'react';\nimport { DEFAULT_VIDEO_CONSTRAINTS, SELECTED_VIDEO_INPUT_KEY } from '../../../constants';\nimport { FormControl, MenuItem, Typography, Select } from '@material-ui/core';\nimport { LocalVideoTrack } from 'twilio-video';\nimport { makeStyles } from '@material-ui/core/styles';\nimport VideoTrack from '../../VideoTrack/VideoTrack';\nimport useDevices from '../../../hooks/useDevices/useDevices';\nimport useMediaStreamTrack from '../../../hooks/useMediaStreamTrack/useMediaStreamTrack';\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\n\nconst useStyles = makeStyles({\n  preview: {\n    width: '300px',\n    maxHeight: '200px',\n    margin: '0.5em auto',\n    '& video': {\n      maxHeight: '200px',\n    },\n  },\n});\n\nexport default function VideoInputList() {\n  const classes = useStyles();\n  const { videoInputDevices } = useDevices();\n  const { localTracks } = useVideoContext();\n\n  const localVideoTrack = localTracks.find(track => track.kind === 'video') as LocalVideoTrack | undefined;\n  const mediaStreamTrack = useMediaStreamTrack(localVideoTrack);\n  const [storedLocalVideoDeviceId, setStoredLocalVideoDeviceId] = useState(\n    window.localStorage.getItem(SELECTED_VIDEO_INPUT_KEY)\n  );\n  const localVideoInputDeviceId = mediaStreamTrack?.getSettings().deviceId || storedLocalVideoDeviceId;\n\n  function replaceTrack(newDeviceId: string) {\n    // Here we store the device ID in the component state. This is so we can re-render this component display\n    // to display the name of the selected device when it is changed while the users camera is off.\n    setStoredLocalVideoDeviceId(newDeviceId);\n    window.localStorage.setItem(SELECTED_VIDEO_INPUT_KEY, newDeviceId);\n    localVideoTrack?.restart({\n      ...(DEFAULT_VIDEO_CONSTRAINTS as {}),\n      deviceId: { exact: newDeviceId },\n    });\n  }\n\n  return (\n    <div>\n      {localVideoTrack && (\n        <div className={classes.preview}>\n          <VideoTrack isLocal track={localVideoTrack} />\n        </div>\n      )}\n      {videoInputDevices.length > 1 ? (\n        <FormControl fullWidth>\n          <Typography variant=\"subtitle2\" gutterBottom>\n            Video Input\n          </Typography>\n          <Select\n            onChange={e => replaceTrack(e.target.value as string)}\n            value={localVideoInputDeviceId || ''}\n            variant=\"outlined\"\n          >\n            {videoInputDevices.map(device => (\n              <MenuItem value={device.deviceId} key={device.deviceId}>\n                {device.label}\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n      ) : (\n        <>\n          <Typography variant=\"subtitle2\" gutterBottom>\n            Video Input\n          </Typography>\n          <Typography>{localVideoTrack?.mediaStreamTrack.label || 'No Local Video'}</Typography>\n        </>\n      )}\n    </div>\n  );\n}\n","import React from 'react';\n\nimport AudioInputList from './AudioInputList/AudioInputList';\nimport AudioOutputList from './AudioOutputList/AudioOutputList';\nimport {\n  DialogContent,\n  Typography,\n  Divider,\n  Dialog,\n  DialogActions,\n  Button,\n  Theme,\n  DialogTitle,\n} from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport VideoInputList from './VideoInputList/VideoInputList';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  container: {\n    width: '600px',\n    minHeight: '400px',\n    [theme.breakpoints.down('xs')]: {\n      width: 'calc(100vw - 32px)',\n    },\n    '& .inputSelect': {\n      width: 'calc(100% - 35px)',\n    },\n  },\n  button: {\n    float: 'right',\n  },\n  paper: {\n    [theme.breakpoints.down('xs')]: {\n      margin: '16px',\n    },\n  },\n  headline: {\n    marginBottom: '1.3em',\n    fontSize: '1.1rem',\n  },\n  listSection: {\n    margin: '2em 0 0.8em',\n    '&:first-child': {\n      margin: '1em 0 2em 0',\n    },\n  },\n}));\n\nexport default function DeviceSelectionDialog({ open, onClose }: { open: boolean; onClose: () => void }) {\n  const classes = useStyles();\n\n  return (\n    <Dialog open={open} onClose={onClose} classes={{ paper: classes.paper }}>\n      <DialogTitle>Audio and Video Settings</DialogTitle>\n      <Divider />\n      <DialogContent className={classes.container}>\n        <div className={classes.listSection}>\n          <Typography variant=\"h6\" className={classes.headline}>\n            Video\n          </Typography>\n          <VideoInputList />\n        </div>\n        <Divider />\n        <div className={classes.listSection}>\n          <Typography variant=\"h6\" className={classes.headline}>\n            Audio\n          </Typography>\n          <AudioInputList />\n        </div>\n        <div className={classes.listSection}>\n          <AudioOutputList />\n        </div>\n      </DialogContent>\n      <Divider />\n      <DialogActions>\n        <Button color=\"primary\" variant=\"contained\" className={classes.button} onClick={onClose}>\n          Done\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import React from 'react';\n\nexport default function FlipCameraIcon() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"25\" height=\"24\" viewBox=\"0 0 25 24\">\n      <g fill=\"none\" fillRule=\"evenodd\">\n        <g fill=\"#707578\">\n          <path\n            d=\"M12 3.5c4.694 0 8.5 3.806 8.5 8.5s-3.806 8.5-8.5 8.5-8.5-3.806-8.5-8.5S7.306 3.5 12 3.5zm0 1c-4.142 0-7.5 3.358-7.5 7.5 0 4.142 3.358 7.5 7.5 7.5 4.142 0 7.5-3.358 7.5-7.5 0-4.142-3.358-7.5-7.5-7.5zm1.367 3.429C14.959 8.492 16.1 10.215 16.1 12c0 1.16-.481 2.294-1.256 3.1h.356c.245 0 .45.177.492.41l.008.09c0 .245-.177.45-.41.492l-.09.008h-2.008l-.048-.003-.034-.005c-.088-.017-.167-.055-.233-.11l-.06-.06c-.037-.044-.067-.096-.087-.151l-.001-.004-.012-.04c-.004-.012-.007-.024-.009-.037v-.005c-.005-.024-.006-.042-.007-.06L12.7 13.6c0-.276.224-.5.5-.5.245 0 .45.177.492.41l.008.09v1.176c.833-.6 1.4-1.676 1.4-2.776 0-1.373-.886-2.71-2.067-3.129-.26-.092-.396-.377-.304-.638.092-.26.378-.396.638-.304zm-2.559-.03c.03.001.058.004.086.01l.062.016.018.006c.04.015.075.034.108.056.086.059.152.143.188.242l.001.004.008.025c.006.017.01.034.013.052l.008.09v2c0 .276-.224.5-.5.5-.245 0-.45-.177-.492-.41l-.008-.09V9.224c-.833.6-1.4 1.676-1.4 2.776 0 1.373.886 2.71 2.067 3.129.26.092.396.377.304.638-.092.26-.378.396-.638.304C9.041 15.508 7.9 13.785 7.9 12c0-1.16.481-2.294 1.255-3.1H8.8c-.245 0-.45-.177-.492-.41L8.3 8.4c0-.245.177-.45.41-.492L8.8 7.9h2.008z\"\n            transform=\"translate(-233 -689) translate(-1 673) translate(37 16) translate(197.298)\"\n          />\n        </g>\n      </g>\n    </svg>\n  );\n}\n","import React from 'react';\n\nexport default function InfoIconOutlined() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n      <g fill=\"none\" fillRule=\"evenodd\">\n        <g fill=\"#707578\">\n          <path\n            d=\"M10 2c4.418 0 8 3.582 8 8s-3.582 8-8 8-8-3.582-8-8 3.582-8 8-8zm0 1.25c-3.728 0-6.75 3.022-6.75 6.75s3.022 6.75 6.75 6.75 6.75-3.022 6.75-6.75S13.728 3.25 10 3.25zM10 9c.552 0 1 .448 1 1v3c0 .552-.448 1-1 1s-1-.448-1-1v-3c0-.552.448-1 1-1zm0-3c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1z\"\n            transform=\"translate(-1107 -888) translate(1082 799) translate(1 81) translate(24 8)\"\n          />\n        </g>\n      </g>\n    </svg>\n  );\n}\n","import React from 'react';\n\nexport default function SettingsIcon() {\n  return (\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M16.774 14.14L16.3413 13.2506C16.3286 13.2244 16.3173 13.1974 16.3075 13.17C16.1465 12.7274 16.3736 12.2377 16.8155 12.0749L17.7467 11.7347C18.5055 11.4566 19.0077 10.7311 19.0011 9.92278C18.9944 9.11441 18.4804 8.39788 17.7172 8.13314L16.7859 7.81039C16.758 7.80094 16.7306 7.7894 16.7056 7.77843C16.2794 7.57999 16.0942 7.07384 16.2915 6.64668L16.7082 5.74887C17.049 5.01563 16.8921 4.14738 16.3163 3.58049C15.7405 3.0136 14.8703 2.87065 14.1431 3.2235L13.246 3.65462C13.2199 3.66744 13.1931 3.67882 13.1658 3.68869C12.954 3.76821 12.7189 3.75812 12.5148 3.66073C12.3097 3.56606 12.1511 3.39306 12.0746 3.18044L12.0741 3.17844L11.7334 2.25081C11.4547 1.49408 10.7313 0.994061 9.92513 1.00105C9.119 1.00804 8.40369 1.52053 8.13727 2.28199L7.8091 3.22223C7.79964 3.25006 7.78863 3.27733 7.7761 3.30391C7.57656 3.73058 7.06934 3.91499 6.64288 3.71592L5.74485 3.29868C5.01263 2.96105 4.14713 3.11998 3.58195 3.69585C3.01677 4.27171 2.87367 5.14046 3.22434 5.86685L3.65571 6.76067C3.66851 6.78686 3.67999 6.81368 3.69009 6.84103C3.85069 7.28399 3.62314 7.77372 3.18105 7.9366L2.25109 8.27683C1.74395 8.46368 1.33939 8.85649 1.13749 9.3581C0.935598 9.8597 0.955223 10.4232 1.19151 10.9093C1.41059 11.3666 1.80499 11.7159 2.28525 11.878L3.21579 12.2005C3.24614 12.2114 3.27565 12.2233 3.30063 12.2343C3.72728 12.4329 3.91226 12.9399 3.7139 13.3671L3.29483 14.2675C3.07772 14.742 3.06371 15.2845 3.25603 15.7693C3.44835 16.2542 3.83032 16.6393 4.31342 16.8354C4.34216 16.847 4.3712 16.8578 4.40056 16.8679C4.87879 17.0366 5.40471 17.0069 5.86112 16.7853L6.75557 16.3531C6.78218 16.3402 6.81093 16.3286 6.8356 16.3194C7.04851 16.2445 7.282 16.2542 7.48788 16.3465C7.6933 16.4413 7.85223 16.6144 7.92922 16.8273L8.27064 17.7606C8.55155 18.5147 9.27456 19.0117 10.079 19.0036C10.8834 18.9955 11.5969 18.4841 11.8635 17.7245L12.1864 16.7928C12.1968 16.7627 12.2087 16.7332 12.2201 16.7083C12.4211 16.2836 12.9258 16.099 13.3529 16.2939L14.2494 16.7105C14.9825 17.0512 15.8508 16.8933 16.4177 16.3161C16.9845 15.7389 17.1272 14.8675 16.774 14.14ZM15.4272 15.7438C15.1965 15.8557 14.9279 15.8582 14.6953 15.7505L13.7992 15.334C13.3395 15.1185 12.8127 15.0956 12.3358 15.2705C11.8589 15.4453 11.4714 15.8035 11.2594 16.2653C11.2334 16.3231 11.21 16.381 11.1879 16.4434L10.8648 17.3755C10.7896 17.5889 10.6327 17.7637 10.4286 17.8613C10.2245 17.959 9.9901 17.9714 9.77695 17.8959C9.53792 17.8159 9.34868 17.6308 9.26323 17.3935L8.92318 16.4634C8.74891 15.9867 8.39229 15.5989 7.93192 15.3856C7.47155 15.1724 6.94522 15.1511 6.46891 15.3264C6.40896 15.349 6.35008 15.3734 6.29456 15.4005L5.4017 15.832C5.198 15.9306 4.96337 15.9438 4.75003 15.8685C4.53569 15.7956 4.36017 15.6387 4.26376 15.4338C4.15381 15.2059 4.15081 14.9409 4.25558 14.7105L4.6727 13.8138C4.88722 13.3534 4.9098 12.8267 4.73547 12.3499C4.56113 11.8731 4.20422 11.4855 3.74357 11.2726C3.71568 11.26 3.68725 11.2477 3.65813 11.2359C3.62824 11.2238 3.59766 11.2124 3.56562 11.2012L2.6307 10.8774C2.29028 10.7597 2.06067 10.4405 2.0571 10.0801C2.05353 9.71966 2.27677 9.39575 2.61479 9.2709L3.54421 8.93088C4.05237 8.74551 4.45826 8.35329 4.66113 7.8516C4.864 7.34991 4.8448 6.7858 4.60832 6.29933L4.17719 5.40605C4.0208 5.08228 4.08434 4.69501 4.33601 4.43805C4.58769 4.18109 4.97337 4.1097 5.30004 4.2596L6.19629 4.67569C6.65433 4.89215 7.1799 4.91661 7.65626 4.74364C8.13263 4.57067 8.52036 4.21458 8.73335 3.75445C8.7625 3.69314 8.78809 3.6302 8.80997 3.56594L9.13622 2.6316C9.29214 2.18707 9.77837 1.95273 10.2227 2.10793C10.4645 2.18868 10.6555 2.37645 10.7405 2.61689L11.0804 3.54291C11.2533 4.01887 11.6082 4.40647 12.067 4.62043C12.5257 4.83438 13.0507 4.85716 13.5265 4.68374C13.5885 4.66176 13.6492 4.63608 13.7082 4.60683L14.6033 4.17624C14.8065 4.07688 15.0408 4.06283 15.2542 4.13722C15.4693 4.20945 15.6456 4.36621 15.7425 4.57137C15.8549 4.80183 15.8573 5.07079 15.749 5.30333L15.3321 6.20153C15.1187 6.66179 15.0968 7.18798 15.2714 7.66415C15.446 8.14033 15.8026 8.52742 16.2627 8.74013C16.3185 8.76535 16.3747 8.78849 16.4369 8.81002L17.3702 9.13315C17.7106 9.2515 17.9398 9.57117 17.9428 9.93176C17.9458 10.2924 17.722 10.6161 17.3836 10.7405L16.4524 11.0806C15.4631 11.4445 14.9535 12.54 15.3125 13.5312C15.335 13.5933 15.3607 13.6541 15.3895 13.7135L15.8224 14.6035C15.9214 14.807 15.9353 15.0416 15.8612 15.2555C15.787 15.4694 15.6309 15.6451 15.4272 15.7438L15.4272 15.7438ZM11.3877 6.5684C9.49155 5.80233 7.33291 6.71966 6.5662 8.61733C5.79949 10.515 6.71505 12.6744 8.61116 13.4405C10.5073 14.2065 12.6659 13.2892 13.4326 11.3915C14.197 9.49389 13.2821 7.33617 11.3877 6.5684ZM9.00779 12.4587C7.65343 11.9115 6.99946 10.3691 7.54711 9.01364C8.09476 7.65816 9.63664 7.00292 10.991 7.55012C12.3454 8.09732 12.9993 9.63974 12.4517 10.9952C11.9028 12.3495 10.3621 13.0042 9.00779 12.4587Z\"\n        fill=\"#606B85\"\n      />\n    </svg>\n  );\n}\n","import React, { useState, useRef } from 'react';\nimport AboutDialog from '../../AboutDialog/AboutDialog';\nimport Button from '@material-ui/core/Button';\nimport DeviceSelectionDialog from '../../DeviceSelectionDialog/DeviceSelectionDialog';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport FlipCameraIcon from '../../../icons/FlipCameraIcon';\nimport InfoIconOutlined from '../../../icons/InfoIconOutlined';\nimport MenuContainer from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MoreIcon from '@material-ui/icons/MoreVert';\nimport SettingsIcon from '../../../icons/SettingsIcon';\nimport Typography from '@material-ui/core/Typography';\nimport { styled, Theme, useMediaQuery } from '@material-ui/core';\nimport useFlipCameraToggle from '../../../hooks/useFlipCameraToggle/useFlipCameraToggle';\n\nexport const IconContainer = styled('div')({\n  display: 'flex',\n  justifyContent: 'center',\n  width: '1.5em',\n  marginRight: '0.3em',\n});\n\nexport default function Menu(props: { buttonClassName?: string }) {\n  const isMobile = useMediaQuery((theme: Theme) => theme.breakpoints.down('sm'));\n  const [aboutOpen, setAboutOpen] = useState(false);\n  const [menuOpen, setMenuOpen] = useState(false);\n  const [settingsOpen, setSettingsOpen] = useState(false);\n\n  const anchorRef = useRef<HTMLButtonElement>(null);\n  const { flipCameraDisabled, toggleFacingMode, flipCameraSupported } = useFlipCameraToggle();\n\n  return (\n    <>\n      <Button onClick={() => setMenuOpen(isOpen => !isOpen)} ref={anchorRef} className={props.buttonClassName}>\n        {isMobile ? (\n          <MoreIcon />\n        ) : (\n          <>\n            Settings\n            <ExpandMoreIcon />\n          </>\n        )}\n      </Button>\n      <MenuContainer\n        open={menuOpen}\n        onClose={() => setMenuOpen(isOpen => !isOpen)}\n        anchorEl={anchorRef.current}\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: isMobile ? -55 : 'bottom',\n          horizontal: 'center',\n        }}\n      >\n        {flipCameraSupported && (\n          <MenuItem disabled={flipCameraDisabled} onClick={toggleFacingMode}>\n            <IconContainer>\n              <FlipCameraIcon />\n            </IconContainer>\n            <Typography variant=\"body1\">Flip Camera</Typography>\n          </MenuItem>\n        )}\n\n        <MenuItem onClick={() => setSettingsOpen(true)}>\n          <IconContainer>\n            <SettingsIcon />\n          </IconContainer>\n          <Typography variant=\"body1\">Audio and Video Settings</Typography>\n        </MenuItem>\n\n        <MenuItem onClick={() => setAboutOpen(true)}>\n          <IconContainer>\n            <InfoIconOutlined />\n          </IconContainer>\n          <Typography variant=\"body1\">About</Typography>\n        </MenuItem>\n      </MenuContainer>\n      <AboutDialog\n        open={aboutOpen}\n        onClose={() => {\n          setAboutOpen(false);\n          setMenuOpen(false);\n        }}\n      />\n      <DeviceSelectionDialog\n        open={settingsOpen}\n        onClose={() => {\n          setSettingsOpen(false);\n          setMenuOpen(false);\n        }}\n      />\n    </>\n  );\n}\n","import { useCallback, useEffect, useState } from 'react';\nimport { DEFAULT_VIDEO_CONSTRAINTS } from '../../constants';\nimport { LocalVideoTrack } from 'twilio-video';\nimport useDevices from '../useDevices/useDevices';\nimport useMediaStreamTrack from '../useMediaStreamTrack/useMediaStreamTrack';\nimport useVideoContext from '../useVideoContext/useVideoContext';\n\nexport default function useFlipCameraToggle() {\n  const { localTracks } = useVideoContext();\n  const [supportsFacingMode, setSupportsFacingMode] = useState(false);\n  const videoTrack = localTracks.find(track => track.name.includes('camera')) as LocalVideoTrack | undefined;\n  const mediaStreamTrack = useMediaStreamTrack(videoTrack);\n  const { videoInputDevices } = useDevices();\n\n  useEffect(() => {\n    // The 'supportsFacingMode' variable determines if this component is rendered\n    // If 'facingMode' exists, we will set supportsFacingMode to true.\n    // However, if facingMode is ever undefined again (when the user unpublishes video), we\n    // won't set 'supportsFacingMode' to false. This prevents the icon from briefly\n    // disappearing when the user switches their front/rear camera.\n    const currentFacingMode = mediaStreamTrack?.getSettings().facingMode;\n    if (currentFacingMode && supportsFacingMode === false) {\n      setSupportsFacingMode(true);\n    }\n  }, [mediaStreamTrack, supportsFacingMode]);\n\n  const toggleFacingMode = useCallback(() => {\n    const newFacingMode = mediaStreamTrack?.getSettings().facingMode === 'user' ? 'environment' : 'user';\n    videoTrack?.restart({\n      ...(DEFAULT_VIDEO_CONSTRAINTS as {}),\n      facingMode: newFacingMode,\n    });\n  }, [mediaStreamTrack, videoTrack]);\n\n  return {\n    flipCameraDisabled: !videoTrack,\n    toggleFacingMode,\n    flipCameraSupported: supportsFacingMode && videoInputDevices.length > 1,\n  };\n}\n","import { useEffect, useState } from 'react';\nimport useVideoContext from '../useVideoContext/useVideoContext';\n\ntype RoomStateType = 'disconnected' | 'connected' | 'reconnecting';\n\nexport default function useRoomState() {\n  const { room } = useVideoContext();\n  const [state, setState] = useState<RoomStateType>('disconnected');\n\n  useEffect(() => {\n    if (room) {\n      const setRoomState = () => setState(room.state as RoomStateType);\n      setRoomState();\n      room\n        .on('disconnected', setRoomState)\n        .on('reconnected', setRoomState)\n        .on('reconnecting', setRoomState);\n      return () => {\n        room\n          .off('disconnected', setRoomState)\n          .off('reconnected', setRoomState)\n          .off('reconnecting', setRoomState);\n      };\n    }\n  }, [room]);\n\n  return state;\n}\n","import React from 'react';\n\nexport default function MicIcon() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"17\" viewBox=\"0 0 12 17\">\n      <path\n        fill=\"#707578\"\n        fillRule=\"evenodd\"\n        d=\"M11.389 6.667c.276 0 .5.224.5.5 0 3.114-2.396 5.67-5.445 5.923v2.632c0 .276-.223.5-.5.5-.245 0-.45-.177-.491-.41l-.009-.09V13.09C2.395 12.836 0 10.281 0 7.167c0-.276.224-.5.5-.5s.5.224.5.5c0 2.73 2.214 4.944 4.944 4.944 2.731 0 4.945-2.214 4.945-4.944 0-.276.224-.5.5-.5zM5.944 0C7.51 0 8.778 1.268 8.778 2.833v4.334C8.778 8.73 7.51 10 5.944 10 4.38 10 3.111 8.73 3.111 7.167V2.833C3.111 1.268 4.38 0 5.944 0zm0 1c-1.012 0-1.833.82-1.833 1.833v4.334C4.111 8.179 4.933 9 5.944 9c1.013 0 1.834-.82 1.834-1.833V2.833C7.778 1.82 6.958 1 5.944 1z\"\n      />\n    </svg>\n  );\n}\n","import React from 'react';\n\nexport default function MicOffIcon() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"25\" height=\"24\" viewBox=\"0 0 25 24\">\n      <g fill=\"none\" fillRule=\"evenodd\">\n        <path\n          fill=\"#707578\"\n          d=\"M11.889 6.667c.276 0 .5.224.5.5 0 3.114-2.396 5.67-5.445 5.923v2.632c0 .276-.223.5-.5.5-.245 0-.45-.177-.491-.41l-.009-.09V13.09c-1.116-.093-2.145-.494-3-1.119l.717-.717c.793.54 1.751.857 2.783.857 2.731 0 4.945-2.214 4.945-4.944 0-.276.224-.5.5-.5zM1 6.667c.276 0 .5.224.5.5 0 .975.282 1.884.77 2.65l-.722.721C.888 9.58.5 8.418.5 7.167c0-.276.224-.5.5-.5zm8.277-1.031v1.53C9.278 8.732 8.01 10 6.445 10c-.446 0-.868-.103-1.243-.287l.776-.773c.149.039.306.06.467.06.963 0 1.751-.74 1.828-1.683l.006-.15v-.531l1-1zM6.444 0C8.01 0 9.278 1.268 9.278 2.833l-.002-.025-.999.999v-.974c0-.962-.74-1.75-1.682-1.827L6.445 1c-.962 0-1.751.74-1.828 1.683l-.006.15v4.334c0 .097.008.192.022.285l-.804.805c-.112-.269-.184-.558-.209-.86l-.009-.23V2.833C3.611 1.268 4.88 0 6.444 0z\"\n          transform=\"translate(6.5 4)\"\n        />\n        <path\n          fill=\"red\"\n          d=\"M12.146.646c.196-.195.512-.195.708 0 .173.174.192.443.057.638l-.057.07-12 12c-.196.195-.512.195-.708 0-.173-.174-.192-.443-.057-.638l.057-.07 12-12z\"\n          transform=\"translate(6.5 4)\"\n        />\n      </g>\n    </svg>\n  );\n}\n","import React from 'react';\n\nimport Button from '@material-ui/core/Button';\nimport MicIcon from '../../../icons/MicIcon';\nimport MicOffIcon from '../../../icons/MicOffIcon';\n\nimport useLocalAudioToggle from '../../../hooks/useLocalAudioToggle/useLocalAudioToggle';\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\n\nexport default function ToggleAudioButton(props: { disabled?: boolean; className?: string }) {\n  const [isAudioEnabled, toggleAudioEnabled] = useLocalAudioToggle();\n  const { localTracks } = useVideoContext();\n  const hasAudioTrack = localTracks.some(track => track.kind === 'audio');\n\n  return (\n    <Button\n      className={props.className}\n      onClick={toggleAudioEnabled}\n      disabled={!hasAudioTrack || props.disabled}\n      startIcon={isAudioEnabled ? <MicIcon /> : <MicOffIcon />}\n      data-cy-audio-toggle\n    >\n      {!hasAudioTrack ? 'No Audio' : isAudioEnabled ? 'Mute' : 'Unmute'}\n    </Button>\n  );\n}\n","import { LocalAudioTrack } from 'twilio-video';\nimport { useCallback } from 'react';\nimport useIsTrackEnabled from '../useIsTrackEnabled/useIsTrackEnabled';\nimport useVideoContext from '../useVideoContext/useVideoContext';\n\nexport default function useLocalAudioToggle() {\n  const { localTracks } = useVideoContext();\n  const audioTrack = localTracks.find(track => track.kind === 'audio') as LocalAudioTrack;\n  const isEnabled = useIsTrackEnabled(audioTrack);\n\n  const toggleAudioEnabled = useCallback(() => {\n    if (audioTrack) {\n      audioTrack.isEnabled ? audioTrack.disable() : audioTrack.enable();\n    }\n  }, [audioTrack]);\n\n  return [isEnabled, toggleAudioEnabled] as const;\n}\n","import React from 'react';\n\nexport default function ChatIcon() {\n  return (\n    <svg width=\"19\" height=\"17\" viewBox=\"0 0 19 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M0 1C0 0.723858 0.223858 0.5 0.5 0.5H18.5C18.7761 0.5 19 0.723858 19 1V13C19 13.2761 18.7761 13.5 18.5 13.5H9.3096L6.32421 16.361C6.1796 16.4996 5.96624 16.5385 5.78202 16.4599C5.59779 16.3813 5.47826 16.2003 5.47826 16V13.5H0.5C0.223858 13.5 0 13.2761 0 13V1ZM1 1.5V12.5H5.97826C6.2544 12.5 6.47826 12.7239 6.47826 13V14.8283L8.76274 12.639C8.85583 12.5498 8.97977 12.5 9.1087 12.5H18V1.5H1Z\"\n        fill=\"#707578\"\n      />\n    </svg>\n  );\n}\n","import React, { createContext, useCallback, useEffect, useRef, useState } from 'react';\nimport { Client } from '@twilio/conversations';\nimport { Conversation } from '@twilio/conversations/lib/conversation';\nimport { Message } from '@twilio/conversations/lib/message';\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\n\ntype ChatContextType = {\n  isChatWindowOpen: boolean;\n  setIsChatWindowOpen: (isChatWindowOpen: boolean) => void;\n  connect: (token: string) => void;\n  hasUnreadMessages: boolean;\n  messages: Message[];\n  conversation: Conversation | null;\n};\n\nexport const ChatContext = createContext<ChatContextType>(null!);\n\nexport const ChatProvider: React.FC = ({ children }) => {\n  const { room, onError } = useVideoContext();\n  const isChatWindowOpenRef = useRef(false);\n  const [isChatWindowOpen, setIsChatWindowOpen] = useState(false);\n  const [conversation, setConversation] = useState<Conversation | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [hasUnreadMessages, setHasUnreadMessages] = useState(false);\n  const [chatClient, setChatClient] = useState<Client>();\n\n  const connect = useCallback(\n    (token: string) => {\n      Client.create(token)\n        .then(client => {\n          //@ts-ignore\n          window.chatClient = client;\n          setChatClient(client);\n        })\n        .catch(() => {\n          onError(new Error(\"There was a problem connecting to Twilio's conversation service.\"));\n        });\n    },\n    [onError]\n  );\n\n  useEffect(() => {\n    if (conversation) {\n      const handleMessageAdded = (message: Message) => setMessages(oldMessages => [...oldMessages, message]);\n      conversation.getMessages().then(newMessages => setMessages(newMessages.items));\n      conversation.on('messageAdded', handleMessageAdded);\n      return () => {\n        conversation.off('messageAdded', handleMessageAdded);\n      };\n    }\n  }, [conversation]);\n\n  useEffect(() => {\n    // If the chat window is closed and there are new messages, set hasUnreadMessages to true\n    if (!isChatWindowOpenRef.current && messages.length) {\n      setHasUnreadMessages(true);\n    }\n  }, [messages]);\n\n  useEffect(() => {\n    isChatWindowOpenRef.current = isChatWindowOpen;\n    if (isChatWindowOpen) setHasUnreadMessages(false);\n  }, [isChatWindowOpen]);\n\n  useEffect(() => {\n    if (room && chatClient) {\n      chatClient\n        .getConversationByUniqueName(room.sid)\n        .then(newConversation => {\n          //@ts-ignore\n          window.chatConversation = newConversation;\n          setConversation(newConversation);\n        })\n        .catch(() => {\n          onError(new Error('There was a problem getting the Conversation associated with this room.'));\n        });\n    }\n  }, [room, chatClient, onError]);\n\n  return (\n    <ChatContext.Provider\n      value={{ isChatWindowOpen, setIsChatWindowOpen, connect, hasUnreadMessages, messages, conversation }}\n    >\n      {children}\n    </ChatContext.Provider>\n  );\n};\n","import { useContext } from 'react';\nimport { ChatContext } from '../../components/ChatProvider';\n\nexport default function useChatContext() {\n  const context = useContext(ChatContext);\n  if (!context) {\n    throw new Error('useChatContext must be used within a ChatProvider');\n  }\n  return context;\n}\n","import React, { useEffect, useState } from 'react';\nimport Button from '@material-ui/core/Button';\nimport ChatIcon from '../../../icons/ChatIcon';\nimport clsx from 'clsx';\nimport { makeStyles } from '@material-ui/core';\nimport useChatContext from '../../../hooks/useChatContext/useChatContext';\n\nexport const ANIMATION_DURATION = 700;\n\nconst useStyles = makeStyles({\n  iconContainer: {\n    position: 'relative',\n    display: 'flex',\n  },\n  circle: {\n    width: '10px',\n    height: '10px',\n    backgroundColor: '#5BB75B',\n    borderRadius: '50%',\n    position: 'absolute',\n    top: '-3px',\n    left: '13px',\n    opacity: 0,\n    transition: `opacity ${ANIMATION_DURATION * 0.5}ms ease-in`,\n  },\n  hasUnreadMessages: {\n    opacity: 1,\n  },\n  ring: {\n    border: '3px solid #5BB75B',\n    borderRadius: '30px',\n    height: '14px',\n    width: '14px',\n    position: 'absolute',\n    left: '11px',\n    top: '-5px',\n    opacity: 0,\n  },\n  animateRing: {\n    animation: `$expand ${ANIMATION_DURATION}ms ease-out`,\n    animationIterationCount: 1,\n  },\n  '@keyframes expand': {\n    '0%': {\n      transform: 'scale(0.1, 0.1)',\n      opacity: 0,\n    },\n    '50%': {\n      opacity: 1,\n    },\n    '100%': {\n      transform: 'scale(1.4, 1.4)',\n      opacity: 0,\n    },\n  },\n});\n\nexport default function ToggleChatButton() {\n  const classes = useStyles();\n  const [shouldAnimate, setShouldAnimate] = useState(false);\n  const { isChatWindowOpen, setIsChatWindowOpen, conversation, hasUnreadMessages } = useChatContext();\n\n  const toggleChatWindow = () => {\n    setIsChatWindowOpen(!isChatWindowOpen);\n  };\n\n  useEffect(() => {\n    if (shouldAnimate) {\n      setTimeout(() => setShouldAnimate(false), ANIMATION_DURATION);\n    }\n  }, [shouldAnimate]);\n\n  useEffect(() => {\n    if (conversation && !isChatWindowOpen) {\n      const handleNewMessage = () => setShouldAnimate(true);\n      conversation.on('messageAdded', handleNewMessage);\n      return () => {\n        conversation.off('messageAdded', handleNewMessage);\n      };\n    }\n  }, [conversation, isChatWindowOpen]);\n\n  return (\n    <Button\n      data-cy-chat-button\n      onClick={toggleChatWindow}\n      disabled={!conversation}\n      startIcon={\n        <div className={classes.iconContainer}>\n          <ChatIcon />\n          <div className={clsx(classes.ring, { [classes.animateRing]: shouldAnimate })} />\n          <div className={clsx(classes.circle, { [classes.hasUnreadMessages]: hasUnreadMessages })} />\n        </div>\n      }\n    >\n      Chat\n    </Button>\n  );\n}\n","import React from 'react';\n\nexport default function VideoOffIcon() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n      <g fill=\"none\" fillRule=\"evenodd\">\n        <path\n          fill=\"#707578\"\n          d=\"M10.503.85c.32 0 .611.125.827.329l-.696.697c-.025-.018-.053-.032-.084-.038l-.047-.006H1.207c-.102 0-.19.071-.216.165l-.008.059v7.866c0 .101.07.189.165.215l.059.008h1.156l-.983.983h-.173c-.624 0-1.139-.476-1.2-1.083L0 9.922V2.056C0 1.433.476.917 1.084.856l.123-.007h9.296zm5.49 1.124l.007.082v7.866c0 .337-.328.566-.635.47l-.076-.03-3.58-1.79v1.35c0 .623-.476 1.138-1.083 1.2l-.123.006H4.16l.984-.983h5.359c.101 0 .189-.07.215-.164l.008-.06V4.564l.983-.982.353-.353 3.227-1.612c.301-.15.652.04.704.358zm-.977.876L11.71 4.504v2.967l3.307 1.654V2.85z\"\n          transform=\"translate(4 6)\"\n        />\n        <path\n          fill=\"red\"\n          fillRule=\"nonzero\"\n          d=\"M13.06.144c.192-.192.503-.192.695 0 .171.17.19.436.057.627l-.057.068-12.29 12.29c-.192.193-.503.193-.695 0-.171-.17-.19-.435-.057-.626l.057-.069L13.06.144z\"\n          transform=\"translate(4 6)\"\n        />\n      </g>\n    </svg>\n  );\n}\n","import React from 'react';\n\nexport default function VideoOnIcon() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"25\" height=\"24\" viewBox=\"0 0 25 24\">\n      <path\n        fill=\"#707578\"\n        fillRule=\"evenodd\"\n        d=\"M15.003 7c.665 0 1.206.542 1.206 1.207v1.349l3.58-1.789c.301-.15.652.04.704.358l.007.082v7.866c0 .365-.385.603-.711.44l-3.58-1.79v1.35c0 .623-.476 1.138-1.083 1.2l-.123.006H5.707c-.665 0-1.207-.542-1.207-1.206V8.207C4.5 7.542 5.042 7 5.707 7zm0 .983H5.707c-.122 0-.224.102-.224.224v7.866c0 .121.102.223.224.223h9.296c.122 0 .223-.102.223-.223V8.207c0-.122-.101-.224-.223-.224zm4.513 1.019l-3.307 1.654v2.968l3.307 1.653V9.002z\"\n      />\n    </svg>\n  );\n}\n","import React, { useCallback, useRef } from 'react';\n\nimport Button from '@material-ui/core/Button';\nimport VideoOffIcon from '../../../icons/VideoOffIcon';\nimport VideoOnIcon from '../../../icons/VideoOnIcon';\n\nimport useDevices from '../../../hooks/useDevices/useDevices';\nimport useLocalVideoToggle from '../../../hooks/useLocalVideoToggle/useLocalVideoToggle';\n\nexport default function ToggleVideoButton(props: { disabled?: boolean; className?: string }) {\n  const [isVideoEnabled, toggleVideoEnabled] = useLocalVideoToggle();\n  const lastClickTimeRef = useRef(0);\n  const { hasVideoInputDevices } = useDevices();\n\n  const toggleVideo = useCallback(() => {\n    if (Date.now() - lastClickTimeRef.current > 500) {\n      lastClickTimeRef.current = Date.now();\n      toggleVideoEnabled();\n    }\n  }, [toggleVideoEnabled]);\n\n  return (\n    <Button\n      className={props.className}\n      onClick={toggleVideo}\n      disabled={!hasVideoInputDevices || props.disabled}\n      startIcon={isVideoEnabled ? <VideoOnIcon /> : <VideoOffIcon />}\n    >\n      {!hasVideoInputDevices ? 'No Video' : isVideoEnabled ? 'Stop Video' : 'Start Video'}\n    </Button>\n  );\n}\n","import React from 'react';\n\nexport default function ScreenShareIcon() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n      <path\n        fill=\"#707578\"\n        fillRule=\"evenodd\"\n        d=\"M17.657 6.343c3.124 3.124 3.124 8.19 0 11.314-3.124 3.124-8.19 3.124-11.314 0-3.124-3.124-3.124-8.19 0-11.314 3.124-3.124 8.19-3.124 11.314 0zm-10.444.87c-2.643 2.644-2.643 6.93 0 9.574 2.644 2.643 6.93 2.643 9.574 0 2.57-2.57 2.641-6.693.214-9.35l-.214-.224L16.563 7c-2.657-2.427-6.78-2.356-9.35.214zm4.865.484l.02.003.026.005.041.01c.025.007.045.014.063.021l.043.019c.018.009.036.019.053.03.01.005.02.012.03.02.027.019.053.04.077.063l2.773 2.774c.24.24.24.63 0 .87-.213.214-.545.237-.785.071l-.085-.07-1.719-1.72v5.9c0 .34-.275.615-.615.615-.302 0-.553-.218-.605-.505l-.01-.11-.001-5.9-1.718 1.72c-.24.24-.63.24-.87 0-.214-.215-.238-.546-.072-.786l.072-.085 2.769-2.77.015-.014c.02-.018.04-.035.062-.05l.005-.004.008-.006c.027-.018.055-.034.085-.048l.034-.015.059-.02.032-.008c.021-.005.044-.008.068-.011l.038-.003H12.025l.027.002.026.002z\"\n      />\n    </svg>\n  );\n}\n","import { useEffect, useState } from 'react';\nimport useVideoContext from '../useVideoContext/useVideoContext';\n\nimport { Participant, TrackPublication } from 'twilio-video';\n\n/*\n  Returns the participant that is sharing their screen (if any). This hook assumes that only one participant\n  can share their screen at a time.\n*/\nexport default function useScreenShareParticipant() {\n  const { room } = useVideoContext();\n  const [screenShareParticipant, setScreenShareParticipant] = useState<Participant>();\n\n  useEffect(() => {\n    if (room) {\n      const updateScreenShareParticipant = () => {\n        setScreenShareParticipant(\n          Array.from<Participant>(room.participants.values())\n            // the screenshare participant could be the localParticipant\n            .concat(room.localParticipant)\n            .find((participant: Participant) =>\n              Array.from<TrackPublication>(participant.tracks.values()).find(track =>\n                track.trackName.includes('screen')\n              )\n            )\n        );\n      };\n      updateScreenShareParticipant();\n\n      room.on('trackPublished', updateScreenShareParticipant);\n      room.on('trackUnpublished', updateScreenShareParticipant);\n      room.on('participantDisconnected', updateScreenShareParticipant);\n\n      // the room object does not emit 'trackPublished' events for the localParticipant,\n      // so we need to listen for them here.\n      room.localParticipant.on('trackPublished', updateScreenShareParticipant);\n      room.localParticipant.on('trackUnpublished', updateScreenShareParticipant);\n      return () => {\n        room.off('trackPublished', updateScreenShareParticipant);\n        room.off('trackUnpublished', updateScreenShareParticipant);\n        room.off('participantDisconnected', updateScreenShareParticipant);\n\n        room.localParticipant.off('trackPublished', updateScreenShareParticipant);\n        room.localParticipant.off('trackUnpublished', updateScreenShareParticipant);\n      };\n    }\n  }, [room]);\n\n  return screenShareParticipant;\n}\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nimport Button from '@material-ui/core/Button';\nimport ScreenShareIcon from '../../../icons/ScreenShareIcon';\nimport Tooltip from '@material-ui/core/Tooltip';\n\nimport useScreenShareParticipant from '../../../hooks/useScreenShareParticipant/useScreenShareParticipant';\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\n\nexport const SCREEN_SHARE_TEXT = 'Share Screen';\nexport const STOP_SCREEN_SHARE_TEXT = 'Stop Sharing Screen';\nexport const SHARE_IN_PROGRESS_TEXT = 'Cannot share screen when another user is sharing';\nexport const SHARE_NOT_SUPPORTED_TEXT = 'Screen sharing is not supported with this browser';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    button: {\n      '&[disabled]': {\n        color: '#bbb',\n        '& svg *': {\n          fill: '#bbb',\n        },\n      },\n    },\n  })\n);\n\nexport default function ToggleScreenShareButton(props: { disabled?: boolean }) {\n  const classes = useStyles();\n  const screenShareParticipant = useScreenShareParticipant();\n  const { toggleScreenShare } = useVideoContext();\n  const disableScreenShareButton = Boolean(screenShareParticipant);\n  const isScreenShareSupported = navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia;\n  const isDisabled = props.disabled || disableScreenShareButton || !isScreenShareSupported;\n\n  let tooltipMessage = '';\n\n  if (disableScreenShareButton) {\n    tooltipMessage = SHARE_IN_PROGRESS_TEXT;\n  }\n\n  if (!isScreenShareSupported) {\n    tooltipMessage = SHARE_NOT_SUPPORTED_TEXT;\n  }\n\n  return (\n    <Tooltip\n      title={tooltipMessage}\n      placement=\"top\"\n      PopperProps={{ disablePortal: true }}\n      style={{ cursor: isDisabled ? 'not-allowed' : 'pointer' }}\n    >\n      <span>\n        {/* The span element is needed because a disabled button will not emit hover events and we want to display\n          a tooltip when screen sharing is disabled */}\n        <Button\n          className={classes.button}\n          onClick={toggleScreenShare}\n          disabled={isDisabled}\n          startIcon={<ScreenShareIcon />}\n          data-cy-share-screen\n        >\n          {SCREEN_SHARE_TEXT}\n        </Button>\n      </span>\n    </Tooltip>\n  );\n}\n","import React from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nimport Button from '@material-ui/core/Button';\nimport EndCallButton from '../Buttons/EndCallButton/EndCallButton';\nimport { isMobile } from '../../utils';\nimport Menu from './Menu/Menu';\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\nimport { Typography, Grid, Hidden } from '@material-ui/core';\nimport ToggleAudioButton from '../Buttons/ToggleAudioButton/ToggleAudioButton';\nimport ToggleChatButton from '../Buttons/ToggleChatButton/ToggleChatButton';\nimport ToggleVideoButton from '../Buttons/ToggleVideoButton/ToggleVideoButton';\nimport ToggleScreenShareButton from '../Buttons/ToogleScreenShareButton/ToggleScreenShareButton';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    container: {\n      backgroundColor: theme.palette.background.default,\n      bottom: 0,\n      left: 0,\n      right: 0,\n      height: `${theme.footerHeight}px`,\n      position: 'fixed',\n      display: 'flex',\n      padding: '0 1.43em',\n      zIndex: 10,\n      [theme.breakpoints.down('sm')]: {\n        height: `${theme.mobileFooterHeight}px`,\n        padding: 0,\n      },\n    },\n    screenShareBanner: {\n      position: 'fixed',\n      zIndex: 10,\n      bottom: `${theme.footerHeight}px`,\n      left: 0,\n      right: 0,\n      height: '104px',\n      background: 'rgba(0, 0, 0, 0.5)',\n      '& h6': {\n        color: 'white',\n      },\n      '& button': {\n        background: 'white',\n        color: theme.brand,\n        border: `2px solid ${theme.brand}`,\n        margin: '0 2em',\n        '&:hover': {\n          color: '#600101',\n          border: `2px solid #600101`,\n          background: '#FFE9E7',\n        },\n      },\n    },\n    hideMobile: {\n      display: 'initial',\n      [theme.breakpoints.down('sm')]: {\n        display: 'none',\n      },\n    },\n  })\n);\n\nexport default function MenuBar() {\n  const classes = useStyles();\n  const { isSharingScreen, toggleScreenShare } = useVideoContext();\n  const roomState = useRoomState();\n  const isReconnecting = roomState === 'reconnecting';\n  const { room } = useVideoContext();\n\n  return (\n    <>\n      {isSharingScreen && (\n        <Grid container justify=\"center\" alignItems=\"center\" className={classes.screenShareBanner}>\n          <Typography variant=\"h6\">You are sharing your screen</Typography>\n          <Button onClick={() => toggleScreenShare()}>Stop Sharing</Button>\n        </Grid>\n      )}\n      <footer className={classes.container}>\n        <Grid container justify=\"space-around\" alignItems=\"center\">\n          <Hidden smDown>\n            <Grid style={{ flex: 1 }}>\n              <Typography variant=\"body1\">{room!.name}</Typography>\n            </Grid>\n          </Hidden>\n          <Grid item>\n            <Grid container justify=\"center\">\n              <ToggleAudioButton disabled={isReconnecting} />\n              <ToggleVideoButton disabled={isReconnecting} />\n              {!isSharingScreen && !isMobile && <ToggleScreenShareButton disabled={isReconnecting} />}\n              {process.env.REACT_APP_DISABLE_TWILIO_CONVERSATIONS !== 'true' && <ToggleChatButton />}\n            </Grid>\n          </Grid>\n          <Hidden smDown>\n            <Grid style={{ flex: 1 }}>\n              <Grid container justify=\"flex-end\">\n                <Menu />\n                <EndCallButton />\n              </Grid>\n            </Grid>\n          </Hidden>\n        </Grid>\n      </footer>\n    </>\n  );\n}\n","import { Grid, makeStyles, Theme, Typography } from '@material-ui/core';\nimport React from 'react';\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\nimport EndCallButton from '../Buttons/EndCallButton/EndCallButton';\nimport Menu from '../MenuBar/Menu/Menu';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  container: {\n    background: 'white',\n    paddingLeft: '1em',\n    display: 'none',\n    height: `${theme.mobileTopBarHeight}px`,\n    [theme.breakpoints.down('sm')]: {\n      display: 'flex',\n    },\n  },\n  endCallButton: {\n    height: '28px',\n    fontSize: '0.85rem',\n    padding: '0 0.6em',\n  },\n  settingsButton: {\n    [theme.breakpoints.down('sm')]: {\n      height: '28px',\n      minWidth: '28px',\n      border: '1px solid rgb(136, 140, 142)',\n      padding: 0,\n      margin: '0 1em',\n    },\n  },\n}));\n\nexport default function MobileTopMenuBar() {\n  const classes = useStyles();\n  const { room } = useVideoContext();\n\n  return (\n    <Grid container alignItems=\"center\" justify=\"space-between\" className={classes.container}>\n      <Typography variant=\"subtitle1\">{room!.name}</Typography>\n      <div>\n        <EndCallButton className={classes.endCallButton} />\n        <Menu buttonClassName={classes.settingsButton} />\n      </div>\n    </Grid>\n  );\n}\n","import React from 'react';\n\nexport default function AvatarIcon() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"73\" height=\"73\" viewBox=\"0 0 73 73\">\n      <g fill=\"none\" fillRule=\"evenodd\">\n        <circle cx=\"36.5\" cy=\"36.5\" r=\"36.5\" fill=\"#FFF\" />\n        <path\n          fill=\"#282A2B\"\n          strokeLinejoin=\"round\"\n          d=\"M30.973 23.925c-3.162 3.794-3.162 9.886 0 13.68l.262.301c.266.293.548.564.842.812l.192.154v2.95l-6.71 2.397-.213.082c-2.03.834-3.346 2.793-3.346 4.97v2.766c0 .532.431.963.963.963h27.874c.531 0 .962-.431.962-.963V49.27l-.005-.228-.015-.233c-.187-2.092-1.562-3.883-3.539-4.59l-6.71-2.397v-2.95l.192-.154c.393-.33.762-.702 1.104-1.112 3.162-3.795 3.162-9.887 0-13.681-3.25-3.9-8.603-3.9-11.853 0zm10.374 1.232c2.567 3.08 2.567 8.135 0 11.216-.404.484-.85.894-1.328 1.226-.26.18-.414.476-.414.791v4.111c0 .407.255.77.639.907l7.348 2.625c1.314.47 2.213 1.687 2.278 3.077l.004.183v1.781h-25.95l.002-1.804c0-1.394.843-2.65 2.131-3.18l.172-.065 7.327-2.617c.383-.137.639-.5.639-.907v-4.11c0-.316-.155-.612-.415-.792-.478-.332-.924-.742-1.328-1.226-2.567-3.08-2.567-8.135 0-11.216 2.427-2.912 6.248-2.974 8.735-.186l.16.186z\"\n        />\n      </g>\n    </svg>\n  );\n}\n","import React from 'react';\nimport { LocalAudioTrack } from 'twilio-video';\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\nimport AudioLevelIndicator from '../AudioLevelIndicator/AudioLevelIndicator';\n\nexport default function LocalAudioLevelIndicator() {\n  const { localTracks } = useVideoContext();\n  const audioTrack = localTracks.find(track => track.kind === 'audio') as LocalAudioTrack;\n\n  return <AudioLevelIndicator audioTrack={audioTrack} />;\n}\n","import React from 'react';\nimport AvatarIcon from '../../../../icons/AvatarIcon';\nimport { makeStyles, Theme, Typography } from '@material-ui/core';\nimport LocalAudioLevelIndicator from '../../../LocalAudioLevelIndicator/LocalAudioLevelIndicator';\nimport { LocalVideoTrack } from 'twilio-video';\nimport VideoTrack from '../../../VideoTrack/VideoTrack';\nimport useVideoContext from '../../../../hooks/useVideoContext/useVideoContext';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  container: {\n    position: 'relative',\n    height: 0,\n    overflow: 'hidden',\n    paddingTop: `${(9 / 16) * 100}%`,\n    background: 'black',\n  },\n  innerContainer: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n  },\n  identityContainer: {\n    position: 'absolute',\n    bottom: 0,\n    zIndex: 1,\n  },\n  identity: {\n    background: 'rgba(0, 0, 0, 0.5)',\n    color: 'white',\n    padding: '0.18em 0.3em',\n    margin: 0,\n    display: 'flex',\n    alignItems: 'center',\n  },\n  avatarContainer: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    background: 'black',\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    zIndex: 1,\n    [theme.breakpoints.down('sm')]: {\n      '& svg': {\n        transform: 'scale(0.7)',\n      },\n    },\n  },\n}));\n\nexport default function LocalVideoPreview({ identity }: { identity: string }) {\n  const classes = useStyles();\n  const { localTracks } = useVideoContext();\n\n  const videoTrack = localTracks.find(track => track.name.includes('camera')) as LocalVideoTrack;\n\n  return (\n    <div className={classes.container}>\n      <div className={classes.innerContainer}>\n        {videoTrack ? (\n          <VideoTrack track={videoTrack} isLocal />\n        ) : (\n          <div className={classes.avatarContainer}>\n            <AvatarIcon />\n          </div>\n        )}\n      </div>\n\n      <div className={classes.identityContainer}>\n        <span className={classes.identity}>\n          <LocalAudioLevelIndicator />\n          <Typography variant=\"body1\" color=\"inherit\" component=\"span\">\n            {identity}\n          </Typography>\n        </span>\n      </div>\n    </div>\n  );\n}\n","import { VideoTrack } from 'twilio-video';\n\nexport type RenderDimensionValue =\n  | 'low'\n  | 'cif'\n  | 'vga'\n  | 'wvga'\n  | '540p'\n  | '720p'\n  | '960p'\n  | 'standard1080p'\n  | 'wide1080p'\n  | 'default';\n\nexport interface RenderDimension {\n  label: string;\n  value: RenderDimensionValue;\n  resolution?: VideoTrack.Dimensions;\n}\n\nexport const RenderDimensions: RenderDimension[] = [\n  {\n    label: 'Low (160 x 90)',\n    value: 'low',\n    resolution: { width: 160, height: 90 },\n  },\n  {\n    label: 'CIF (352 x 288)',\n    value: 'cif',\n    resolution: { width: 352, height: 288 },\n  },\n  {\n    label: 'VGA (640 x 480)',\n    value: 'vga',\n    resolution: { width: 640, height: 480 },\n  },\n  {\n    label: 'WVGA (800 x 480)',\n    value: 'wvga',\n    resolution: { width: 800, height: 480 },\n  },\n  {\n    label: 'HD 540P (960 x 540)',\n    value: '540p',\n    resolution: { width: 960, height: 540 },\n  },\n  {\n    label: 'HD 720P (1280 x 720)',\n    value: '720p',\n    resolution: { width: 1280, height: 720 },\n  },\n  {\n    label: 'HD 960P (1280 x 960)',\n    value: '960p',\n    resolution: { width: 1280, height: 960 },\n  },\n  {\n    label: 'HD Standard 1080P (1440 x 1080)',\n    value: 'standard1080p',\n    resolution: { width: 1440, height: 1080 },\n  },\n  {\n    label: 'HD Widescreen 1080P (1920 x 1080)',\n    value: 'wide1080p',\n    resolution: { width: 1920, height: 1080 },\n  },\n  {\n    label: 'Server Default',\n    value: 'default',\n    resolution: undefined,\n  },\n];\n\nexport function getResolution(value?: RenderDimensionValue) {\n  if (typeof value === 'undefined') {\n    return undefined;\n  }\n\n  return RenderDimensions.find(item => item.value === value)?.resolution;\n}\n","import React, { useCallback } from 'react';\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  Divider,\n  FormControl,\n  Grid,\n  InputLabel,\n  MenuItem,\n  Select,\n  TextField,\n  Theme,\n  Typography,\n} from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { inputLabels, Settings } from '../../state/settings/settingsReducer';\nimport { RenderDimensions } from '../../state/settings/renderDimensions';\nimport { useAppState } from '../../state';\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  container: {\n    width: '600px',\n    minHeight: '400px',\n    [theme.breakpoints.down('xs')]: {\n      width: 'calc(100vw - 32px)',\n    },\n    '& .inputSelect': {\n      width: 'calc(100% - 35px)',\n    },\n  },\n  button: {\n    float: 'right',\n  },\n  paper: {\n    [theme.breakpoints.down('xs')]: {\n      margin: '16px',\n    },\n  },\n  formControl: {\n    display: 'block',\n    margin: '1.5em 0',\n    '&:first-child': {\n      margin: '0 0 1.5em 0',\n    },\n  },\n  label: {\n    width: '133%', // Labels have scale(0.75) applied to them, so this effectively makes the width 100%\n  },\n}));\n\nconst withDefault = (val?: string) => (typeof val === 'undefined' ? 'default' : val);\n\nconst RenderDimensionItems = RenderDimensions.map(({ label, value }) => (\n  <MenuItem value={value} key={value}>\n    {label}\n  </MenuItem>\n));\n\nexport default function ConnectionOptionsDialog({ open, onClose }: { open: boolean; onClose: () => void }) {\n  const classes = useStyles();\n  const { settings, dispatchSetting } = useAppState();\n  const roomState = useRoomState();\n  const isDisabled = roomState !== 'disconnected';\n\n  const handleChange = useCallback(\n    (e: React.ChangeEvent<{ value: unknown; name?: string }>) => {\n      dispatchSetting({ name: e.target.name as keyof Settings, value: e.target.value as string });\n    },\n    [dispatchSetting]\n  );\n\n  const handleNumberChange = useCallback(\n    (e: React.ChangeEvent<{ value: unknown; name?: string }>) => {\n      if (!/[^\\d]/.test(e.target.value as string)) handleChange(e);\n    },\n    [handleChange]\n  );\n\n  return (\n    <Dialog open={open} onClose={onClose} classes={{ paper: classes.paper }}>\n      <DialogTitle>Connection Settings</DialogTitle>\n      <Divider />\n      <DialogContent className={classes.container}>\n        <Grid container spacing={2}>\n          <Grid item xs={12}>\n            <Typography hidden={!isDisabled} variant=\"body2\">\n              These settings cannot be changed when connected to a room.\n            </Typography>\n          </Grid>\n\n          <Grid item sm={6} xs={12}>\n            <FormControl className={classes.formControl}>\n              <InputLabel id={inputLabels.dominantSpeakerPriority}>Dominant Speaker Priority:</InputLabel>\n              <Select\n                fullWidth\n                disabled={isDisabled}\n                name={inputLabels.dominantSpeakerPriority}\n                label={inputLabels.dominantSpeakerPriority}\n                value={withDefault(settings.dominantSpeakerPriority)}\n                onChange={handleChange}\n              >\n                <MenuItem value=\"low\">Low</MenuItem>\n                <MenuItem value=\"standard\">Standard</MenuItem>\n                <MenuItem value=\"high\">High</MenuItem>\n                <MenuItem value=\"default\">Server Default</MenuItem>\n              </Select>\n            </FormControl>\n\n            <FormControl className={classes.formControl}>\n              <InputLabel id={inputLabels.trackSwitchOffMode}>Track Switch Off Mode:</InputLabel>\n              <Select\n                fullWidth\n                disabled={isDisabled}\n                name={inputLabels.trackSwitchOffMode}\n                label={inputLabels.trackSwitchOffMode}\n                value={withDefault(settings.trackSwitchOffMode)}\n                onChange={handleChange}\n              >\n                <MenuItem value=\"predicted\">Predicted</MenuItem>\n                <MenuItem value=\"detected\">Detected</MenuItem>\n                <MenuItem value=\"disabled\">Disabled</MenuItem>\n                <MenuItem value=\"default\">Server Default</MenuItem>\n              </Select>\n            </FormControl>\n\n            <FormControl className={classes.formControl}>\n              <InputLabel id={inputLabels.bandwidthProfileMode}>Mode:</InputLabel>\n              <Select\n                fullWidth\n                disabled={isDisabled}\n                name={inputLabels.bandwidthProfileMode}\n                label={inputLabels.bandwidthProfileMode}\n                value={withDefault(settings.bandwidthProfileMode)}\n                onChange={handleChange}\n              >\n                <MenuItem value=\"grid\">Grid</MenuItem>\n                <MenuItem value=\"collaboration\">Collaboration</MenuItem>\n                <MenuItem value=\"presentation\">Presentation</MenuItem>\n                <MenuItem value=\"default\">Server Default</MenuItem>\n              </Select>\n            </FormControl>\n\n            <FormControl className={classes.formControl}>\n              <TextField\n                disabled={isDisabled}\n                fullWidth\n                id={inputLabels.maxTracks}\n                label=\"Max Tracks\"\n                placeholder=\"Leave blank for no limit\"\n                name={inputLabels.maxTracks}\n                value={withDefault(settings.maxTracks)}\n                onChange={handleNumberChange}\n              />\n            </FormControl>\n\n            <FormControl className={classes.formControl}>\n              <TextField\n                disabled={isDisabled}\n                fullWidth\n                id={inputLabels.maxAudioBitrate}\n                label=\"Max Audio Bitrate\"\n                placeholder=\"Leave blank for no limit\"\n                name={inputLabels.maxAudioBitrate}\n                value={withDefault(settings.maxAudioBitrate)}\n                onChange={handleNumberChange}\n              />\n            </FormControl>\n          </Grid>\n          <Grid item sm={6} xs={12}>\n            <FormControl fullWidth className={classes.formControl}>\n              <InputLabel id={inputLabels.renderDimensionLow} className={classes.label}>\n                Render Dimension (Low Priority):\n              </InputLabel>\n              <Select\n                fullWidth\n                disabled={isDisabled}\n                name={inputLabels.renderDimensionLow}\n                label={inputLabels.renderDimensionLow}\n                value={withDefault(settings.renderDimensionLow)}\n                onChange={handleChange}\n              >\n                {RenderDimensionItems}\n              </Select>\n            </FormControl>\n\n            <FormControl fullWidth className={classes.formControl}>\n              <InputLabel id={inputLabels.renderDimensionStandard} className={classes.label}>\n                Render Dimension (Standard Priority):\n              </InputLabel>\n              <Select\n                fullWidth\n                disabled={isDisabled}\n                name={inputLabels.renderDimensionStandard}\n                label={inputLabels.renderDimensionStandard}\n                value={withDefault(settings.renderDimensionStandard)}\n                onChange={handleChange}\n              >\n                {RenderDimensionItems}\n              </Select>\n            </FormControl>\n\n            <FormControl fullWidth className={classes.formControl}>\n              <InputLabel id={inputLabels.renderDimensionHigh} className={classes.label}>\n                Render Dimension (High Priority):\n              </InputLabel>\n              <Select\n                fullWidth\n                disabled={isDisabled}\n                name={inputLabels.renderDimensionHigh}\n                label={inputLabels.renderDimensionHigh}\n                value={withDefault(settings.renderDimensionHigh)}\n                onChange={handleChange}\n              >\n                {RenderDimensionItems}\n              </Select>\n            </FormControl>\n          </Grid>\n        </Grid>\n      </DialogContent>\n      <Divider />\n      <DialogActions>\n        <Button className={classes.button} color=\"primary\" variant=\"contained\" onClick={onClose}>\n          Done\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import React, { useState, useRef } from 'react';\nimport Button from '@material-ui/core/Button';\nimport MenuContainer from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MoreIcon from '@material-ui/icons/MoreVert';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles, Theme, useMediaQuery } from '@material-ui/core';\n\nimport AboutDialog from '../../../AboutDialog/AboutDialog';\nimport ConnectionOptionsDialog from '../../../ConnectionOptionsDialog/ConnectionOptionsDialog';\nimport DeviceSelectionDialog from '../../../DeviceSelectionDialog/DeviceSelectionDialog';\nimport SettingsIcon from '../../../../icons/SettingsIcon';\nimport { useAppState } from '../../../../state';\n\nconst useStyles = makeStyles({\n  settingsButton: {\n    margin: '1.8em 0 0',\n  },\n});\n\nexport default function SettingsMenu({ mobileButtonClass }: { mobileButtonClass?: string }) {\n  const classes = useStyles();\n  const { roomType } = useAppState();\n  const isMobile = useMediaQuery((theme: Theme) => theme.breakpoints.down('sm'));\n  const [menuOpen, setMenuOpen] = useState(false);\n  const [aboutOpen, setAboutOpen] = useState(false);\n  const [deviceSettingsOpen, setDeviceSettingsOpen] = useState(false);\n  const [connectionSettingsOpen, setConnectionSettingsOpen] = useState(false);\n\n  const anchorRef = useRef<HTMLButtonElement>(null);\n\n  return (\n    <>\n      {isMobile ? (\n        <Button\n          ref={anchorRef}\n          onClick={() => setMenuOpen(true)}\n          startIcon={<MoreIcon />}\n          className={mobileButtonClass}\n        >\n          More\n        </Button>\n      ) : (\n        <Button\n          ref={anchorRef}\n          onClick={() => setMenuOpen(true)}\n          startIcon={<SettingsIcon />}\n          className={classes.settingsButton}\n        >\n          Settings\n        </Button>\n      )}\n      <MenuContainer\n        open={menuOpen}\n        onClose={() => setMenuOpen(isOpen => !isOpen)}\n        anchorEl={anchorRef.current}\n        getContentAnchorEl={null}\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: isMobile ? 'left' : 'right',\n        }}\n        transformOrigin={{\n          vertical: isMobile ? -55 : -45,\n          horizontal: 'center',\n        }}\n      >\n        <MenuItem onClick={() => setAboutOpen(true)}>\n          <Typography variant=\"body1\">About</Typography>\n        </MenuItem>\n        <MenuItem onClick={() => setDeviceSettingsOpen(true)}>\n          <Typography variant=\"body1\">Audio and Video Settings</Typography>\n        </MenuItem>\n        {roomType !== 'peer-to-peer' && roomType !== 'go' && (\n          <MenuItem onClick={() => setConnectionSettingsOpen(true)}>\n            <Typography variant=\"body1\">Connection Settings</Typography>\n          </MenuItem>\n        )}\n      </MenuContainer>\n      <AboutDialog\n        open={aboutOpen}\n        onClose={() => {\n          setAboutOpen(false);\n          setMenuOpen(false);\n        }}\n      />\n      <DeviceSelectionDialog\n        open={deviceSettingsOpen}\n        onClose={() => {\n          setDeviceSettingsOpen(false);\n          setMenuOpen(false);\n        }}\n      />\n      <ConnectionOptionsDialog\n        open={connectionSettingsOpen}\n        onClose={() => {\n          setConnectionSettingsOpen(false);\n          setMenuOpen(false);\n        }}\n      />\n    </>\n  );\n}\n","import React from 'react';\nimport { makeStyles, Typography, Grid, Button, Theme, Hidden } from '@material-ui/core';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport LocalVideoPreview from './LocalVideoPreview/LocalVideoPreview';\nimport SettingsMenu from './SettingsMenu/SettingsMenu';\nimport { Steps } from '../PreJoinScreens';\nimport ToggleAudioButton from '../../Buttons/ToggleAudioButton/ToggleAudioButton';\nimport ToggleVideoButton from '../../Buttons/ToggleVideoButton/ToggleVideoButton';\nimport { useAppState } from '../../../state';\nimport useChatContext from '../../../hooks/useChatContext/useChatContext';\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  gutterBottom: {\n    marginBottom: '1em',\n  },\n  marginTop: {\n    marginTop: '1em',\n  },\n  deviceButton: {\n    width: '100%',\n    border: '2px solid #aaa',\n    margin: '1em 0',\n  },\n  localPreviewContainer: {\n    paddingRight: '2em',\n    [theme.breakpoints.down('sm')]: {\n      padding: '0 2.5em',\n    },\n  },\n  joinButtons: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    [theme.breakpoints.down('sm')]: {\n      flexDirection: 'column-reverse',\n      width: '100%',\n      '& button': {\n        margin: '0.5em 0',\n      },\n    },\n  },\n  mobileButtonBar: {\n    [theme.breakpoints.down('sm')]: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      margin: '1.5em 0 1em',\n    },\n  },\n  mobileButton: {\n    padding: '0.8em 0',\n    margin: 0,\n  },\n}));\n\ninterface DeviceSelectionScreenProps {\n  name: string;\n  roomName: string;\n  setStep: (step: Steps) => void;\n}\n\nexport default function DeviceSelectionScreen({ name, roomName, setStep }: DeviceSelectionScreenProps) {\n  const classes = useStyles();\n  const { getToken, isFetching } = useAppState();\n  const { connect: chatConnect } = useChatContext();\n  const { connect: videoConnect, isAcquiringLocalTracks, isConnecting } = useVideoContext();\n  const disableButtons = isFetching || isAcquiringLocalTracks || isConnecting;\n\n  const handleJoin = () => {\n    getToken(name, roomName).then(token => {\n      videoConnect(token);\n      process.env.REACT_APP_DISABLE_TWILIO_CONVERSATIONS !== 'true' && chatConnect(token);\n    });\n  };\n\n  if (isFetching || isConnecting) {\n    return (\n      <Grid container justify=\"center\" alignItems=\"center\" direction=\"column\" style={{ height: '100%' }}>\n        <div>\n          <CircularProgress variant=\"indeterminate\" />\n        </div>\n        <div>\n          <Typography variant=\"body2\" style={{ fontWeight: 'bold', fontSize: '16px' }}>\n            Joining Meeting\n          </Typography>\n        </div>\n      </Grid>\n    );\n  }\n\n  return (\n    <>\n      <Typography variant=\"h5\" className={classes.gutterBottom}>\n        Join {roomName}\n      </Typography>\n\n      <Grid container justify=\"center\">\n        <Grid item md={7} sm={12} xs={12}>\n          <div className={classes.localPreviewContainer}>\n            <LocalVideoPreview identity={name} />\n          </div>\n          <div className={classes.mobileButtonBar}>\n            <Hidden mdUp>\n              <ToggleAudioButton className={classes.mobileButton} disabled={disableButtons} />\n              <ToggleVideoButton className={classes.mobileButton} disabled={disableButtons} />\n            </Hidden>\n            <SettingsMenu mobileButtonClass={classes.mobileButton} />\n          </div>\n        </Grid>\n        <Grid item md={5} sm={12} xs={12}>\n          <Grid container direction=\"column\" justify=\"space-between\" style={{ height: '100%' }}>\n            <div>\n              <Hidden smDown>\n                <ToggleAudioButton className={classes.deviceButton} disabled={disableButtons} />\n                <ToggleVideoButton className={classes.deviceButton} disabled={disableButtons} />\n              </Hidden>\n            </div>\n            <div className={classes.joinButtons}>\n              <Button variant=\"outlined\" color=\"primary\" onClick={() => setStep(Steps.roomNameStep)}>\n                Cancel\n              </Button>\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                data-cy-join-now\n                onClick={handleJoin}\n                disabled={disableButtons}\n              >\n                Join Now\n              </Button>\n            </div>\n          </Grid>\n        </Grid>\n      </Grid>\n    </>\n  );\n}\n","import React from 'react';\n\nexport default function VideoLogo() {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"96\" height=\"96\" viewBox=\"0 0 96 96\">\n      <g fill=\"none\" fillRule=\"evenodd\">\n        <path\n          fill=\"#FFF\"\n          d=\"M43.86 0h8.28c11.661 0 18.564 1.74 24.675 5.01 6.112 3.267 10.908 8.063 14.175 14.175C94.26 25.295 96 32.197 96 43.86v8.28c0 11.661-1.74 18.564-5.01 24.675-3.267 6.112-8.063 10.908-14.175 14.175C70.704 94.26 63.801 96 52.14 96h-8.28c-11.661 0-18.564-1.74-24.675-5.01-6.112-3.267-10.908-8.063-14.175-14.175C1.74 70.705 0 63.803 0 52.14v-8.28c0-11.661 1.74-18.564 5.01-24.675C8.277 13.073 13.073 8.277 19.185 5.01 25.295 1.74 32.197 0 43.86 0z\"\n        />\n        <path\n          fill=\"#F22F46\"\n          d=\"M53.25 63h-25.5C25.679 63 24 61.321 24 59.25v-22.5c0-2.071 1.679-3.75 3.75-3.75h25.5c2.071 0 3.75 1.679 3.75 3.75v5.82l9.57-4.785c1.164-.583 2.546-.521 3.653.164 1.107.685 1.78 1.894 1.777 3.196V54.87c.008 1.3-.66 2.512-1.766 3.198-1.105.686-2.487.747-3.65.162L57 53.49v5.76C57 61.321 55.32 63 53.25 63zm-25.5-27c-.414 0-.75.336-.75.75v22.5c0 .414.336.75.75.75h25.5c.414 0 .75-.336.75-.75v-8.175c-.001-.518.266-1 .705-1.275.44-.275.99-.303 1.455-.075L67.92 55.5c.224.123.496.123.72 0 .22-.141.356-.383.36-.645v-13.71c-.004-.262-.14-.504-.36-.645-.224-.123-.496-.123-.72 0l-11.745 5.865c-.47.236-1.028.21-1.473-.069-.445-.28-.711-.77-.702-1.296v-8.25c0-.414-.336-.75-.75-.75h-25.5z\"\n        />\n      </g>\n    </svg>\n  );\n}\n","import React, { SVGProps } from 'react';\n\nexport default function TwilioLogo(props: SVGProps<SVGSVGElement>) {\n  return (\n    <svg fill=\"#F22F46\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" {...props}>\n      <path d=\"M15 0C6.7 0 0 6.7 0 15s6.7 15 15 15 15-6.7 15-15S23.3 0 15 0zm0 26C8.9 26 4 21.1 4 15S8.9 4 15 4s11 4.9 11 11-4.9 11-11 11zm6.8-14.7c0 1.7-1.4 3.1-3.1 3.1s-3.1-1.4-3.1-3.1 1.4-3.1 3.1-3.1 3.1 1.4 3.1 3.1zm0 7.4c0 1.7-1.4 3.1-3.1 3.1s-3.1-1.4-3.1-3.1c0-1.7 1.4-3.1 3.1-3.1s3.1 1.4 3.1 3.1zm-7.4 0c0 1.7-1.4 3.1-3.1 3.1s-3.1-1.4-3.1-3.1c0-1.7 1.4-3.1 3.1-3.1s3.1 1.4 3.1 3.1zm0-7.4c0 1.7-1.4 3.1-3.1 3.1S8.2 13 8.2 11.3s1.4-3.1 3.1-3.1 3.1 1.4 3.1 3.1z\" />\n    </svg>\n  );\n}\n","import React from 'react';\nimport Avatar from '@material-ui/core/Avatar';\nimport makeStyles from '@material-ui/styles/makeStyles';\nimport Person from '@material-ui/icons/Person';\nimport { StateContextType } from '../../../../state';\n\nconst useStyles = makeStyles({\n  red: {\n    color: 'white',\n    backgroundColor: '#F22F46',\n  },\n});\n\nexport function getInitials(name: string) {\n  return name\n    .split(' ')\n    .map(text => text[0])\n    .join('')\n    .toUpperCase();\n}\n\nexport default function UserAvatar({ user }: { user: StateContextType['user'] }) {\n  const classes = useStyles();\n  const { displayName, photoURL } = user!;\n\n  return photoURL ? (\n    <Avatar src={photoURL} />\n  ) : (\n    <Avatar className={classes.red}>{displayName ? getInitials(displayName) : <Person />}</Avatar>\n  );\n}\n","import React, { useState, useRef, useCallback } from 'react';\nimport { makeStyles, Typography, Button, MenuItem, Link } from '@material-ui/core';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { useAppState } from '../../../state';\nimport UserAvatar from './UserAvatar/UserAvatar';\nimport Menu from '@material-ui/core/Menu';\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\n\nconst useStyles = makeStyles({\n  userContainer: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    margin: '1em',\n    display: 'flex',\n    alignItems: 'center',\n  },\n  userButton: {\n    color: 'white',\n  },\n  logoutLink: {\n    color: 'white',\n    cursor: 'pointer',\n    padding: '10px 20px',\n  },\n});\n\nconst UserMenu: React.FC = () => {\n  const classes = useStyles();\n  const { user, signOut } = useAppState();\n  const { localTracks } = useVideoContext();\n\n  const [menuOpen, setMenuOpen] = useState(false);\n  const anchorRef = useRef<HTMLButtonElement>(null);\n\n  const handleSignOut = useCallback(() => {\n    localTracks.forEach(track => track.stop());\n    signOut?.();\n  }, [localTracks, signOut]);\n\n  if (process.env.REACT_APP_SET_AUTH === 'passcode') {\n    return (\n      <div className={classes.userContainer}>\n        <Link onClick={handleSignOut} className={classes.logoutLink}>\n          Logout\n        </Link>\n      </div>\n    );\n  }\n\n  if (process.env.REACT_APP_SET_AUTH === 'firebase') {\n    return (\n      <div className={classes.userContainer}>\n        <UserAvatar user={user} />\n        <Button onClick={() => setMenuOpen(isOpen => !isOpen)} ref={anchorRef} className={classes.userButton}>\n          {user!.displayName}\n          <ExpandMoreIcon />\n        </Button>\n        <Menu\n          open={menuOpen}\n          onClose={() => setMenuOpen(isOpen => !isOpen)}\n          anchorEl={anchorRef.current}\n          getContentAnchorEl={null}\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'center',\n          }}\n          transformOrigin={{\n            vertical: 'top',\n            horizontal: 'center',\n          }}\n        >\n          <MenuItem onClick={handleSignOut}>\n            <Typography variant=\"body1\">Logout</Typography>\n          </MenuItem>\n        </Menu>\n      </div>\n    );\n  }\n\n  return null;\n};\n\nexport default UserMenu;\n","import React from 'react';\nimport { makeStyles, Theme, Typography } from '@material-ui/core';\nimport Swoosh from './swoosh';\nimport VideoLogo from './VideoLogo';\nimport TwilioLogo from './TwilioLogo';\nimport { useAppState } from '../../state';\nimport UserMenu from './UserMenu/UserMenu';\nimport { useLocation } from 'react-router-dom';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  background: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    background: 'rgb(40, 42, 43)',\n    height: '100%',\n  },\n  container: {\n    position: 'relative',\n    flex: '1',\n  },\n  innerContainer: {\n    display: 'flex',\n    width: '888px',\n    height: '379px',\n    borderRadius: '8px',\n    boxShadow: '0px 2px 4px 0px rgba(40, 42, 43, 0.3)',\n    overflow: 'hidden',\n    position: 'relative',\n    margin: 'auto',\n    [theme.breakpoints.down('sm')]: {\n      display: 'block',\n      height: 'auto',\n      width: 'calc(100% - 40px)',\n      margin: 'auto',\n      maxWidth: '400px',\n    },\n  },\n  swooshContainer: {\n    position: 'relative',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundImage: Swoosh,\n    backgroundSize: 'cover',\n    width: '296px',\n    [theme.breakpoints.down('sm')]: {\n      width: '100%',\n      height: '100px',\n      backgroundPositionY: '140px',\n    },\n  },\n  logoContainer: {\n    position: 'absolute',\n    width: '210px',\n    textAlign: 'center',\n    [theme.breakpoints.down('sm')]: {\n      display: 'flex',\n      alignItems: 'center',\n      width: '90%',\n      textAlign: 'initial',\n      '& svg': {\n        height: '64px',\n      },\n    },\n  },\n  twilioLogo: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    margin: '20px',\n  },\n  content: {\n    background: 'white',\n    width: '100%',\n    padding: '4em',\n    flex: 1,\n    [theme.breakpoints.down('sm')]: {\n      padding: '2em',\n    },\n  },\n  title: {\n    color: 'white',\n    margin: '1em 0 0',\n    [theme.breakpoints.down('sm')]: {\n      margin: 0,\n      fontSize: '1.1rem',\n    },\n  },\n}));\n\ninterface IntroContainerProps {\n  children: React.ReactNode;\n}\n\nconst IntroContainer = (props: IntroContainerProps) => {\n  const classes = useStyles();\n  const { user } = useAppState();\n  const location = useLocation();\n\n  return (\n    <div className={classes.background}>\n      <TwilioLogo className={classes.twilioLogo} />\n      {user && location.pathname !== '/login' && <UserMenu />}\n      <div className={classes.container}>\n        <div className={classes.innerContainer}>\n          <div className={classes.swooshContainer}>\n            <div className={classes.logoContainer}>\n              <VideoLogo />\n              <Typography variant=\"h6\" className={classes.title}>\n                Twilio Programmable Video\n              </Typography>\n            </div>\n          </div>\n          <div className={classes.content}>{props.children}</div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default IntroContainer;\n","const Swoosh = `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='296' height='378' viewBox='0 0 296 378'%3E%3Cdefs%3E%3ClinearGradient id='utbttnlrpc' x1='78.976%25' x2='63.882%25' y1='60.873%25' y2='45.554%25'%3E%3Cstop offset='0%25' stop-opacity='0'/%3E%3Cstop offset='100%25'/%3E%3C/linearGradient%3E%3ClinearGradient id='aim8r3oczd' x1='78.976%25' x2='63.882%25' y1='56.106%25' y2='47.503%25'%3E%3Cstop offset='0%25' stop-opacity='0'/%3E%3Cstop offset='100%25'/%3E%3C/linearGradient%3E%3Cpath id='5tk4i6f80a' d='M0 0H296V378H0z'/%3E%3C/defs%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cmask id='m1ihwluuxb' fill='%23fff'%3E%3Cuse xlink:href='%235tk4i6f80a'/%3E%3C/mask%3E%3Cuse fill='%23DE5858' xlink:href='%235tk4i6f80a'/%3E%3Cg mask='url(%23m1ihwluuxb)'%3E%3Cg%3E%3Cpath fill='url(%23utbttnlrpc)' d='M0 286.83c87.695-83.937 175.802-132.682 264.323-146.233 132.78-20.328 183.24 4.255 225.143-23.414 73.409-48.471 93.039-15.154 148.326-20.892 44.84-4.654 98.48-77.401 135.81-91.717C795.596-3.86 821.469.801 851.22 18.56L891 476.5H0V286.83z' opacity='.06' transform='translate(-457 -22.5)'/%3E%3Cpath fill='url(%23aim8r3oczd)' d='M137 604.5c63.759-109.686 155.8-165.124 276.126-166.315 180.488-1.786 157.888-146.686 387.11-146.33 229.223.356 170.665-151.786 341.36-166.888 113.797-10.068 180.265 10.685 199.404 62.26V604.5H137z' opacity='.08' transform='translate(-457 -22.5)'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");`;\nexport default Swoosh;\n","import React from 'react';\n\nexport default function ErrorIcon() {\n  return (\n    <svg width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n      <g stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\n        <g transform=\"translate(-299.000000, -723.000000)\" fill=\"#D61F1F\">\n          <g transform=\"translate(276.000000, 704.000000)\">\n            <g transform=\"translate(23.000000, 19.000000)\">\n              <path\n                d=\"M8.03935839,0.763849674 L13.2361503,5.96064161 C13.8101721,6.5346634 13.8101721,7.4653366 13.2361503,8.03935839 L8.03935839,13.2361503 C7.4653366,13.8101721 6.5346634,13.8101721 5.96064161,13.2361503 L0.763849674,8.03935839 C0.189827887,7.4653366 0.189827887,6.5346634 0.763849674,5.96064161 L5.96064161,0.763849674 C6.5346634,0.189827887 7.4653366,0.189827887 8.03935839,0.763849674 Z M7,8.66666667 C6.53976271,8.66666667 6.16666667,9.03976271 6.16666667,9.5 C6.16666667,9.96023729 6.53976271,10.3333333 7,10.3333333 C7.46023729,10.3333333 7.83333333,9.96023729 7.83333333,9.5 C7.83333333,9.03976271 7.46023729,8.66666667 7,8.66666667 Z M7.00842529,4.5 L6.99145559,4.5 C6.48802096,4.5 6.09771771,4.99363437 6.17690967,5.53663218 L6.53327351,7.40140326 C6.56721292,7.64822044 6.76519283,7.83333333 6.99711216,7.83333333 L7.00276873,7.83333333 C7.23468805,7.83333333 7.43266796,7.64822044 7.46660737,7.40140326 L7.82297121,5.53663218 C7.90216317,4.99363437 7.51751649,4.50617043 7.00842529,4.5 Z\"\n                id=\"Error\"\n              ></path>\n            </g>\n          </g>\n        </g>\n      </g>\n    </svg>\n  );\n}\n","import React from 'react';\n\nexport default function WarningIcon() {\n  return (\n    <svg width=\"16px\" height=\"14px\" viewBox=\"0 0 16 14\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n      <g stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\n        <g transform=\"translate(-273.000000, -162.000000)\" fill=\"#E46216\">\n          <g transform=\"translate(251.000000, 143.000000)\">\n            <g transform=\"translate(22.000000, 19.000000)\">\n              <path d=\"M6.68405227,0.743750848 C7.26590697,-0.247916949 8.73410873,-0.247916949 9.31596344,0.743750848 L9.31596344,0.743750848 L15.7980583,11.7915293 C16.3754418,12.775573 15.6458879,14 14.4821027,14 L14.4821027,14 L1.5178827,14 C0.354135396,14 -0.375441293,12.775573 0.201934693,11.7915293 L0.201934693,11.7915293 Z M8,10 C7.44771525,10 7,10.4477153 7,11 C7,11.5522847 7.44771525,12 8,12 C8.55228475,12 9,11.5522847 9,11 C9,10.4477153 8.55228475,10 8,10 Z M8.01011035,5 L7.98974671,5 L7.87816923,5.00681158 C7.32928042,5.07427655 6.92320065,5.63308608 7.01229161,6.24395862 L7.01229161,6.24395862 L7.43992821,8.48168391 L7.46058982,8.57746523 C7.53403676,8.82448556 7.74990819,9 8.00332247,9 L8.00332247,9 L8.09436762,8.9919759 C8.33199007,8.94972242 8.5237268,8.74495557 8.55992884,8.48168391 L8.55992884,8.48168391 L8.98756545,6.24395862 L8.99896034,6.12268979 C9.02431547,5.52149772 8.58283795,5.00694173 8.01011035,5 L8.01011035,5 Z\"></path>\n            </g>\n          </g>\n        </g>\n      </g>\n    </svg>\n  );\n}\n","import React from 'react';\nimport clsx from 'clsx';\nimport CloseIcon from '@material-ui/icons/Close';\nimport ErrorIcon from '../../icons/ErrorIcon';\nimport { IconButton, makeStyles, Theme, Typography } from '@material-ui/core';\nimport MUISnackbar from '@material-ui/core/Snackbar';\nimport WarningIcon from '../../icons/WarningIcon';\n\ninterface SnackbarProps {\n  headline: string;\n  message: string;\n  variant?: 'error' | 'warning';\n  open: boolean;\n  handleClose?: () => void;\n}\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  container: {\n    display: 'flex',\n    alignItems: 'baseline',\n    justifyContent: 'space-between',\n    width: '400px',\n    minHeight: '50px',\n    background: 'white',\n    padding: '1em',\n    borderRadius: '3px',\n    boxShadow: '0 12px 24px 4px rgba(40,42,43,0.2)',\n    [theme.breakpoints.down('sm')]: {\n      width: '100%',\n    },\n  },\n  contentContainer: {\n    display: 'flex',\n  },\n  iconContainer: {\n    display: 'flex',\n    padding: '0 1.3em 0 0.3em',\n    transform: 'translateY(4px)',\n  },\n  headline: {\n    fontWeight: 'bold',\n  },\n  error: {\n    borderLeft: '4px solid #D61F1F',\n  },\n  warning: {\n    borderLeft: '4px solid #E46216',\n  },\n}));\n\nexport default function Snackbar({ headline, message, variant, open, handleClose }: SnackbarProps) {\n  const classes = useStyles();\n\n  const handleOnClose = (_: React.SyntheticEvent | React.MouseEvent, reason?: string) => {\n    if (reason === 'clickaway') {\n      return;\n    }\n\n    handleClose?.();\n  };\n\n  return (\n    <MUISnackbar\n      anchorOrigin={{\n        vertical: 'top',\n        horizontal: 'right',\n      }}\n      open={open}\n      onClose={handleOnClose}\n    >\n      <div\n        className={clsx(classes.container, {\n          [classes.error]: variant === 'error',\n          [classes.warning]: variant === 'warning',\n        })}\n      >\n        <div className={classes.contentContainer}>\n          <div className={classes.iconContainer}>\n            {variant === 'warning' && <WarningIcon />}\n            {variant === 'error' && <ErrorIcon />}\n          </div>\n          <div>\n            <Typography variant=\"body1\" className={classes.headline} component=\"span\">\n              {headline}\n            </Typography>\n            <Typography variant=\"body1\" component=\"span\">\n              {' '}\n              {message}\n            </Typography>\n          </div>\n        </div>\n        <div>\n          {handleClose && (\n            <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={handleClose}>\n              <CloseIcon fontSize=\"small\" />\n            </IconButton>\n          )}\n        </div>\n      </div>\n    </MUISnackbar>\n  );\n}\n","import React, { useState } from 'react';\nimport Snackbar from '../../Snackbar/Snackbar';\nimport useDevices from '../../../hooks/useDevices/useDevices';\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\n\nexport function getSnackbarContent(hasAudio: boolean, hasVideo: boolean, error?: Error) {\n  let headline = '';\n  let message = '';\n\n  switch (true) {\n    // This error is emitted when the user or the user's system has denied permission to use the media devices\n    case error?.name === 'NotAllowedError':\n      headline = 'Unable to Access Media:';\n\n      if (error!.message === 'Permission denied by system') {\n        // Chrome only\n        message =\n          'The operating system has blocked the browser from accessing the microphone or camera. Please check your operating system settings.';\n      } else {\n        message =\n          'The user has denied permission to use audio and video. Please grant permission to the browser to access the microphone and camera.';\n      }\n\n      break;\n\n    // This error is emitted when input devices are not connected or disabled in the OS settings\n    case error?.name === 'NotFoundError':\n      headline = 'Cannot Find Microphone or Camera:';\n      message =\n        'The browser cannot access the microphone or camera. Please make sure all input devices are connected and enabled.';\n      break;\n\n    // Other getUserMedia errors are less likely to happen in this app. Here we will display\n    // the system's error message directly to the user.\n    case Boolean(error):\n      headline = 'Error Acquiring Media:';\n      message = `${error!.name} ${error!.message}`;\n      break;\n\n    case !hasAudio && !hasVideo:\n      headline = 'No Camera or Microphone Detected:';\n      message = 'Other participants in the room will be unable to see and hear you.';\n      break;\n\n    case !hasVideo:\n      headline = 'No Camera Detected:';\n      message = 'Other participants in the room will be unable to see you.';\n      break;\n\n    case !hasAudio:\n      headline = 'No Microphone Detected:';\n      message = 'Other participants in the room will be unable to hear you.';\n  }\n\n  return {\n    headline,\n    message,\n  };\n}\n\nexport default function MediaErrorSnackbar({ error }: { error?: Error }) {\n  const { hasAudioInputDevices, hasVideoInputDevices } = useDevices();\n\n  const { isAcquiringLocalTracks } = useVideoContext();\n\n  const [isSnackbarDismissed, setIsSnackbarDismissed] = useState(false);\n\n  const isSnackbarOpen =\n    !isSnackbarDismissed &&\n    !isAcquiringLocalTracks &&\n    (Boolean(error) || !hasAudioInputDevices || !hasVideoInputDevices);\n\n  const { headline, message } = getSnackbarContent(hasAudioInputDevices, hasVideoInputDevices, error);\n\n  return (\n    <Snackbar\n      open={isSnackbarOpen}\n      handleClose={() => setIsSnackbarDismissed(true)}\n      headline={headline}\n      message={message}\n      variant=\"warning\"\n    />\n  );\n}\n","import React, { ChangeEvent, FormEvent } from 'react';\nimport { Typography, makeStyles, TextField, Grid, Button, InputLabel, Theme } from '@material-ui/core';\nimport { useAppState } from '../../../state';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  gutterBottom: {\n    marginBottom: '1em',\n  },\n  inputContainer: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    margin: '1.5em 0 3.5em',\n    '& div:not(:last-child)': {\n      marginRight: '1em',\n    },\n    [theme.breakpoints.down('sm')]: {\n      margin: '1.5em 0 2em',\n    },\n  },\n  textFieldContainer: {\n    width: '100%',\n  },\n  continueButton: {\n    [theme.breakpoints.down('sm')]: {\n      width: '100%',\n    },\n  },\n}));\n\ninterface RoomNameScreenProps {\n  name: string;\n  roomName: string;\n  setName: (name: string) => void;\n  setRoomName: (roomName: string) => void;\n  handleSubmit: (event: FormEvent<HTMLFormElement>) => void;\n}\n\nexport default function RoomNameScreen({ name, roomName, setName, setRoomName, handleSubmit }: RoomNameScreenProps) {\n  const classes = useStyles();\n  const { user } = useAppState();\n\n  const handleNameChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setName(event.target.value);\n  };\n\n  const handleRoomNameChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setRoomName(event.target.value);\n  };\n\n  const hasUsername = !window.location.search.includes('customIdentity=true') && user?.displayName;\n\n  return (\n    <>\n      <Typography variant=\"h5\" className={classes.gutterBottom}>\n        Join a Room\n      </Typography>\n      <Typography variant=\"body1\">\n        {hasUsername\n          ? \"Enter the name of a room you'd like to join.\"\n          : \"Enter your name and the name of a room you'd like to join\"}\n      </Typography>\n      <form onSubmit={handleSubmit}>\n        <div className={classes.inputContainer}>\n          {!hasUsername && (\n            <div className={classes.textFieldContainer}>\n              <InputLabel shrink htmlFor=\"input-user-name\">\n                Your Name\n              </InputLabel>\n              <TextField\n                id=\"input-user-name\"\n                variant=\"outlined\"\n                fullWidth\n                size=\"small\"\n                value={name}\n                onChange={handleNameChange}\n              />\n            </div>\n          )}\n          <div className={classes.textFieldContainer}>\n            <InputLabel shrink htmlFor=\"input-room-name\">\n              Room Name\n            </InputLabel>\n            <TextField\n              autoCapitalize=\"false\"\n              id=\"input-room-name\"\n              variant=\"outlined\"\n              fullWidth\n              size=\"small\"\n              value={roomName}\n              onChange={handleRoomNameChange}\n            />\n          </div>\n        </div>\n        <Grid container justify=\"flex-end\">\n          <Button\n            variant=\"contained\"\n            type=\"submit\"\n            color=\"primary\"\n            disabled={!name || !roomName}\n            className={classes.continueButton}\n          >\n            Continue\n          </Button>\n        </Grid>\n      </form>\n    </>\n  );\n}\n","import React, { useState, useEffect, FormEvent } from 'react';\nimport DeviceSelectionScreen from './DeviceSelectionScreen/DeviceSelectionScreen';\nimport IntroContainer from '../IntroContainer/IntroContainer';\nimport MediaErrorSnackbar from './MediaErrorSnackbar/MediaErrorSnackbar';\nimport RoomNameScreen from './RoomNameScreen/RoomNameScreen';\nimport { useAppState } from '../../state';\nimport { useParams } from 'react-router-dom';\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\n\nexport enum Steps {\n  roomNameStep,\n  deviceSelectionStep,\n}\n\nexport default function PreJoinScreens() {\n  const { user } = useAppState();\n  const { getAudioAndVideoTracks } = useVideoContext();\n  const { URLRoomName } = useParams();\n  const [step, setStep] = useState(Steps.roomNameStep);\n\n  const [name, setName] = useState<string>(user?.displayName || '');\n  const [roomName, setRoomName] = useState<string>('');\n\n  const [mediaError, setMediaError] = useState<Error>();\n\n  useEffect(() => {\n    if (URLRoomName) {\n      setRoomName(URLRoomName);\n      if (user?.displayName) {\n        setStep(Steps.deviceSelectionStep);\n      }\n    }\n  }, [user, URLRoomName]);\n\n  useEffect(() => {\n    if (step === Steps.deviceSelectionStep && !mediaError) {\n      getAudioAndVideoTracks().catch(error => {\n        console.log('Error acquiring local media:');\n        console.dir(error);\n        setMediaError(error);\n      });\n    }\n  }, [getAudioAndVideoTracks, step, mediaError]);\n\n  const handleSubmit = (event: FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    // If this app is deployed as a twilio function, don't change the URL because routing isn't supported.\n    if (!window.location.origin.includes('twil.io')) {\n      window.history.replaceState(null, '', window.encodeURI(`/room/${roomName}${window.location.search || ''}`));\n    }\n    setStep(Steps.deviceSelectionStep);\n  };\n\n  return (\n    <IntroContainer>\n      <MediaErrorSnackbar error={mediaError} />\n      {step === Steps.roomNameStep && (\n        <RoomNameScreen\n          name={name}\n          roomName={roomName}\n          setName={setName}\n          setRoomName={setRoomName}\n          handleSubmit={handleSubmit}\n        />\n      )}\n\n      {step === Steps.deviceSelectionStep && (\n        <DeviceSelectionScreen name={name} roomName={roomName} setStep={setStep} />\n      )}\n    </IntroContainer>\n  );\n}\n","import React from 'react';\nimport Snackbar from '../Snackbar/Snackbar';\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\n\nexport default function ReconnectingNotification() {\n  const roomState = useRoomState();\n\n  return (\n    <Snackbar\n      variant=\"error\"\n      headline=\"Connection Lost:\"\n      message=\"Reconnecting to room...\"\n      open={roomState === 'reconnecting'}\n    />\n  );\n}\n","import React from 'react';\n\nexport default function CloseIcon() {\n  return (\n    <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M2.64645 2.64645C2.84171 2.45118 3.15829 2.45118 3.35355 2.64645L21.3536 20.6464C21.5488 20.8417 21.5488 21.1583 21.3536 21.3536C21.1583 21.5488 20.8417 21.5488 20.6464 21.3536L2.64645 3.35355C2.45118 3.15829 2.45118 2.84171 2.64645 2.64645Z\"\n        fill=\"#707578\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M21.3536 2.64645C21.5488 2.84171 21.5488 3.15829 21.3536 3.35355L3.35355 21.3536C3.15829 21.5488 2.84171 21.5488 2.64645 21.3536C2.45118 21.1583 2.45118 20.8417 2.64645 20.6464L20.6464 2.64645C20.8417 2.45118 21.1583 2.45118 21.3536 2.64645Z\"\n        fill=\"#707578\"\n      />\n    </svg>\n  );\n}\n","import React from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport CloseIcon from '../../../icons/CloseIcon';\n\nimport useChatContext from '../../../hooks/useChatContext/useChatContext';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    container: {\n      height: '56px',\n      background: '#F4F4F6',\n      borderBottom: '1px solid #E4E7E9',\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      padding: '0 1em',\n    },\n    text: {\n      fontWeight: 'bold',\n    },\n    closeChatWindow: {\n      cursor: 'pointer',\n      display: 'flex',\n      background: 'transparent',\n      border: '0',\n      padding: '0.4em',\n    },\n  })\n);\n\nexport default function ChatWindowHeader() {\n  const classes = useStyles();\n  const { setIsChatWindowOpen } = useChatContext();\n\n  return (\n    <div className={classes.container}>\n      <div className={classes.text}>Chat</div>\n      <button className={classes.closeChatWindow} onClick={() => setIsChatWindowOpen(false)}>\n        <CloseIcon />\n      </button>\n    </div>\n  );\n}\n","import React from 'react';\n\nexport default function FileAttachmentIcon() {\n  return (\n    <svg width=\"24\" height=\"24\" viewBox=\"-1 0 24 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M18.7992 3.24259C16.6912 1.13458 13.5645 1.40622 11.3746 3.59615L2.53575 12.435C1.72631 13.2444 1.26254 14.2015 1.18557 15.1283C1.10946 16.0447 1.4074 16.9635 2.1822 17.7383C2.957 18.5131 3.87575 18.811 4.7922 18.7349C5.71899 18.6579 6.67606 18.1942 7.4855 17.3847L14.203 10.6672C14.7335 10.1367 15.0455 9.55355 15.116 9.01193C15.184 8.48967 15.035 7.9637 14.5566 7.48523C14.0781 7.00677 13.5521 6.85777 13.0299 6.92578C12.4883 6.99631 11.9051 7.30826 11.3746 7.83879L6.07128 13.1421C5.87602 13.3374 5.55944 13.3374 5.36418 13.1421C5.16891 12.9468 5.16892 12.6302 5.36418 12.435L10.6675 7.13168C11.3079 6.49124 12.0835 6.04058 12.9007 5.93415C13.7374 5.82521 14.5705 6.08492 15.2637 6.77813C15.9569 7.47134 16.2166 8.30442 16.1076 9.14105C16.0012 9.95832 15.5506 10.7339 14.9101 11.3743L8.1926 18.0918C7.24417 19.0403 6.07462 19.6318 4.87496 19.7315C3.66496 19.832 2.45745 19.4278 1.47509 18.4454C0.492729 17.463 0.0885105 16.2555 0.189 15.0455C0.288631 13.8459 0.880211 12.6763 1.82864 11.7279L10.6675 2.88904C13.1643 0.392265 16.929 -0.0417833 19.5063 2.53549C22.0836 5.11276 21.6495 8.87755 19.1528 11.3743L12.7888 17.7383C12.5935 17.9335 12.277 17.9335 12.0817 17.7383C11.8864 17.543 11.8864 17.2264 12.0817 17.0312L18.4457 10.6672C20.6356 8.47729 20.9072 5.35061 18.7992 3.24259Z\"\n        fill=\"#707578\"\n      />\n    </svg>\n  );\n}\n","import React from 'react';\n\nexport default function ScreenShareIcon() {\n  return (\n    <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M22.3539 1.64645C22.5491 1.84171 22.5491 2.15829 22.3539 2.35355L9.74515 14.9622C9.54989 15.1575 9.23331 15.1575 9.03805 14.9622C8.84279 14.767 8.84279 14.4504 9.03805 14.2551L21.6467 1.64645C21.842 1.45118 22.1586 1.45118 22.3539 1.64645Z\"\n        fill=\"#D8D8D8\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M22.3536 1.64646C22.4988 1.79171 22.5404 2.011 22.4585 2.19938L13.7629 22.1994C13.6863 22.3756 13.5155 22.4923 13.3235 22.4996C13.1316 22.507 12.9523 22.4037 12.8625 22.234L9.02139 14.9786L1.76606 11.1376C1.59627 11.0477 1.493 10.8685 1.50037 10.6765C1.50774 10.4845 1.62446 10.3137 1.80064 10.2371L21.8006 1.54148C21.989 1.45958 22.2083 1.50122 22.3536 1.64646ZM3.15222 10.7399L9.62525 14.1668C9.71385 14.2137 9.7863 14.2862 9.8332 14.3748L13.2601 20.8478L21.0354 2.96463L3.15222 10.7399Z\"\n        fill=\"#D8D8D8\"\n      />\n    </svg>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport { Button, CircularProgress, Grid, makeStyles } from '@material-ui/core';\nimport { Conversation } from '@twilio/conversations/lib/conversation';\nimport FileAttachmentIcon from '../../../icons/FileAttachmentIcon';\nimport { isMobile } from '../../../utils';\nimport SendMessageIcon from '../../../icons/SendMessageIcon';\nimport Snackbar from '../../Snackbar/Snackbar';\nimport TextareaAutosize from '@material-ui/core/TextareaAutosize';\n\nconst useStyles = makeStyles({\n  chatInputContainer: {\n    borderTop: '1px solid #e4e7e9',\n    borderBottom: '1px solid #e4e7e9',\n    padding: '1em 1.2em 1em',\n  },\n  textArea: {\n    padding: '0.75em 1em',\n    marginTop: '0.4em',\n    width: '100%',\n    border: '0',\n    resize: 'none',\n    fontSize: '14px',\n    fontFamily: 'Inter',\n  },\n  button: {\n    padding: '0.56em',\n    minWidth: 'auto',\n    '&:disabled': {\n      background: 'none',\n      '& path': {\n        fill: '#d8d8d8',\n      },\n    },\n  },\n  buttonContainer: {\n    margin: '1em 0 0 1em',\n    display: 'flex',\n  },\n  fileButtonContainer: {\n    position: 'relative',\n    marginRight: '1em',\n  },\n  fileButtonLoadingSpinner: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    marginTop: -12,\n    marginLeft: -12,\n  },\n});\n\ninterface ChatInputProps {\n  conversation: Conversation;\n  isChatWindowOpen: boolean;\n}\n\nconst ALLOWED_FILE_TYPES =\n  'audio/*, image/*, text/*, video/*, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document .xslx, .ppt, .pdf, .key, .svg, .csv';\n\nexport default function ChatInput({ conversation, isChatWindowOpen }: ChatInputProps) {\n  const classes = useStyles();\n  const [messageBody, setMessageBody] = useState('');\n  const [isSendingFile, setIsSendingFile] = useState(false);\n  const [fileSendError, setFileSendError] = useState<string | null>(null);\n  const isValidMessage = /\\S/.test(messageBody);\n  const textInputRef = useRef<HTMLTextAreaElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    if (isChatWindowOpen) {\n      // When the chat window is opened, we will focus on the text input.\n      // This is so the user doesn't have to click on it to begin typing a message.\n      textInputRef.current?.focus();\n    }\n  }, [isChatWindowOpen]);\n\n  const handleChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setMessageBody(event.target.value);\n  };\n\n  // ensures pressing enter + shift creates a new line, so that enter on its own only sends the message:\n  const handleReturnKeyPress = (event: React.KeyboardEvent) => {\n    if (!isMobile && event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n      handleSendMessage(messageBody);\n    }\n  };\n\n  const handleSendMessage = (message: string) => {\n    if (isValidMessage) {\n      conversation.sendMessage(message.trim());\n      setMessageBody('');\n    }\n  };\n\n  const handleSendFile = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      var formData = new FormData();\n      formData.append('userfile', file);\n      setIsSendingFile(true);\n      setFileSendError(null);\n      conversation\n        .sendMessage(formData)\n        .catch(e => {\n          if (e.code === 413) {\n            setFileSendError('File size is too large. Maximum file size is 150MB.');\n          } else {\n            setFileSendError('There was a problem uploading the file. Please try again.');\n          }\n          console.log('Problem sending file: ', e);\n        })\n        .finally(() => {\n          setIsSendingFile(false);\n        });\n    }\n  };\n\n  return (\n    <div className={classes.chatInputContainer}>\n      <Snackbar\n        open={Boolean(fileSendError)}\n        headline=\"Error\"\n        message={fileSendError || ''}\n        variant=\"error\"\n        handleClose={() => setFileSendError(null)}\n      />\n\n      <TextareaAutosize\n        rowsMin={1}\n        rowsMax={3}\n        className={classes.textArea}\n        aria-label=\"chat input\"\n        placeholder=\"Write a message...\"\n        onKeyPress={handleReturnKeyPress}\n        onChange={handleChange}\n        value={messageBody}\n        data-cy-chat-input\n        ref={textInputRef}\n      />\n\n      <Grid container alignItems=\"flex-end\" justify=\"flex-end\" wrap=\"nowrap\">\n        {/* Since the file input element is invisible, we can hardcode an empty string as its value.\n        This allows users to upload the same file multiple times. */}\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          style={{ display: 'none' }}\n          onChange={handleSendFile}\n          value={''}\n          accept={ALLOWED_FILE_TYPES}\n        />\n        <div className={classes.buttonContainer}>\n          <div className={classes.fileButtonContainer}>\n            <Button className={classes.button} onClick={() => fileInputRef.current?.click()} disabled={isSendingFile}>\n              <FileAttachmentIcon />\n            </Button>\n\n            {isSendingFile && <CircularProgress size={24} className={classes.fileButtonLoadingSpinner} />}\n          </div>\n\n          <Button\n            className={classes.button}\n            onClick={() => handleSendMessage(messageBody)}\n            color=\"primary\"\n            variant=\"contained\"\n            disabled={!isValidMessage}\n            data-cy-send-message-button\n          >\n            <SendMessageIcon />\n          </Button>\n        </div>\n      </Grid>\n    </div>\n  );\n}\n","import React from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    messageInfoContainer: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      alignItems: 'center',\n      padding: '1.425em 0 0.083em',\n      fontSize: '12px',\n      color: '#606B85',\n    },\n  })\n);\n\ninterface MessageInfoProps {\n  author: string;\n  dateCreated: string;\n  isLocalParticipant: boolean;\n}\n\nexport default function MessageInfo({ author, dateCreated, isLocalParticipant }: MessageInfoProps) {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.messageInfoContainer}>\n      <div>{isLocalParticipant ? `${author} (You)` : author}</div>\n      <div>{dateCreated}</div>\n    </div>\n  );\n}\n","/* istanbul ignore file */\nimport React from 'react';\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport Button from '@material-ui/core/Button';\nimport clsx from 'clsx';\nimport { Message } from '@twilio/conversations/lib/message';\nimport throttle from 'lodash.throttle';\nimport { withStyles, WithStyles, createStyles } from '@material-ui/core/styles';\n\nconst styles = createStyles({\n  outerContainer: {\n    minHeight: 0,\n    flex: 1,\n    position: 'relative',\n  },\n  innerScrollContainer: {\n    height: '100%',\n    overflowY: 'auto',\n    padding: '0 1.2em 0',\n  },\n  messageListContainer: {\n    overflowY: 'auto',\n    flex: '1',\n    paddingBottom: '1em',\n  },\n  button: {\n    position: 'absolute',\n    bottom: '14px',\n    right: '2em',\n    zIndex: 100,\n    padding: '0.5em 0.9em',\n    visibility: 'hidden',\n    opacity: 0,\n    boxShadow: '0px 4px 16px rgba(18, 28, 45, 0.2)',\n    transition: 'all 0.5s ease',\n  },\n  showButton: {\n    visibility: 'visible',\n    opacity: 1,\n    bottom: '24px',\n  },\n});\n\ninterface MessageListScrollContainerProps extends WithStyles<typeof styles> {\n  messages: Message[];\n}\n\ninterface MessageListScrollContainerState {\n  isScrolledToBottom: boolean;\n  showButton: boolean;\n  messageNotificationCount: number;\n}\n\n/*\n * This component is a scrollable container that wraps around the 'MessageList' component.\n * The MessageList will ultimately grow taller than its container as it continues to receive\n * new messages, and users will need to have the ability to scroll up and down the chat window.\n * A \"new message\" button will be displayed when the user receives a new message, and is not scrolled\n * to the bottom. This button will be hidden if the user clicks on it, or manually scrolls\n * to the bottom. Otherwise, this component will auto-scroll to the bottom when a new message is\n * received, and the user is already scrolled to the bottom.\n *\n * Note that this component is tested with Cypress only.\n */\nexport class MessageListScrollContainer extends React.Component<\n  MessageListScrollContainerProps,\n  MessageListScrollContainerState\n> {\n  chatThreadRef = React.createRef<HTMLDivElement>();\n  state = { isScrolledToBottom: true, showButton: false, messageNotificationCount: 0 };\n\n  scrollToBottom() {\n    const innerScrollContainerEl = this.chatThreadRef.current!;\n    innerScrollContainerEl.scrollTop = innerScrollContainerEl!.scrollHeight;\n  }\n\n  componentDidMount() {\n    this.scrollToBottom();\n    this.chatThreadRef.current!.addEventListener('scroll', this.handleScroll);\n  }\n\n  // This component updates as users send new messages:\n  componentDidUpdate(prevProps: MessageListScrollContainerProps, prevState: MessageListScrollContainerState) {\n    const hasNewMessages = this.props.messages.length !== prevProps.messages.length;\n\n    if (prevState.isScrolledToBottom && hasNewMessages) {\n      this.scrollToBottom();\n    } else if (hasNewMessages) {\n      const numberOfNewMessages = this.props.messages.length - prevProps.messages.length;\n\n      this.setState(previousState => ({\n        // If there's at least one new message, show the 'new message' button:\n        showButton: !previousState.isScrolledToBottom,\n        // If 'new message' button is visible,\n        // messageNotificationCount will be the number of previously unread messages + the number of new messages.\n        // Otherwise, messageNotificationCount is set to 1:\n        messageNotificationCount: previousState.showButton\n          ? previousState.messageNotificationCount + numberOfNewMessages\n          : 1,\n      }));\n    }\n  }\n\n  handleScroll = throttle(() => {\n    const innerScrollContainerEl = this.chatThreadRef.current!;\n    // Because this.handleScroll() is a throttled method,\n    // it's possible that it can be called after this component unmounts, and this element will be null.\n    // Therefore, if it doesn't exist, don't do anything:\n    if (!innerScrollContainerEl) return;\n\n    // On systems using display scaling, scrollTop may return a decimal value, so we need to account for this in the\n    // \"isScrolledToBottom\" calculation.\n    const isScrolledToBottom =\n      Math.abs(\n        innerScrollContainerEl.clientHeight + innerScrollContainerEl.scrollTop - innerScrollContainerEl!.scrollHeight\n      ) < 1;\n\n    this.setState(prevState => ({\n      isScrolledToBottom,\n      showButton: isScrolledToBottom ? false : prevState.showButton,\n    }));\n  }, 300);\n\n  handleClick = () => {\n    const innerScrollContainerEl = this.chatThreadRef.current!;\n\n    innerScrollContainerEl.scrollTo({ top: innerScrollContainerEl.scrollHeight, behavior: 'smooth' });\n\n    this.setState({ showButton: false });\n  };\n\n  componentWillUnmount() {\n    const innerScrollContainerEl = this.chatThreadRef.current!;\n\n    innerScrollContainerEl.removeEventListener('scroll', this.handleScroll);\n  }\n\n  render() {\n    const { classes } = this.props;\n\n    return (\n      <div className={classes.outerContainer}>\n        <div className={classes.innerScrollContainer} ref={this.chatThreadRef} data-cy-message-list-inner-scroll>\n          <div className={classes.messageListContainer}>\n            {this.props.children}\n            <Button\n              className={clsx(classes.button, { [classes.showButton]: this.state.showButton })}\n              onClick={this.handleClick}\n              startIcon={<ArrowDownwardIcon />}\n              color=\"primary\"\n              variant=\"contained\"\n              data-cy-new-message-button\n            >\n              {this.state.messageNotificationCount} new message\n              {this.state.messageNotificationCount > 1 && 's'}\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withStyles(styles)(MessageListScrollContainer);\n","import React from 'react';\nimport clsx from 'clsx';\nimport { Link } from '@material-ui/core';\nimport linkify from 'linkify-it';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles({\n  messageContainer: {\n    borderRadius: '16px',\n    display: 'inline-flex',\n    alignItems: 'center',\n    padding: '0.5em 0.8em 0.6em',\n    margin: '0.3em 0 0',\n    wordBreak: 'break-word',\n    backgroundColor: '#E1E3EA',\n    hyphens: 'auto',\n    whiteSpace: 'pre-wrap',\n  },\n  isLocalParticipant: {\n    backgroundColor: '#CCE4FF',\n  },\n});\n\ninterface TextMessageProps {\n  body: string;\n  isLocalParticipant: boolean;\n}\n\nfunction addLinks(text: string) {\n  const matches = linkify().match(text);\n  if (!matches) return text;\n\n  const results = [];\n  let lastIndex = 0;\n\n  matches.forEach((match, i) => {\n    results.push(text.slice(lastIndex, match.index));\n    results.push(\n      <Link target=\"_blank\" rel=\"noreferrer\" href={match.url} key={i}>\n        {match.text}\n      </Link>\n    );\n    lastIndex = match.lastIndex;\n  });\n\n  results.push(text.slice(lastIndex, text.length));\n\n  return results;\n}\n\nexport default function TextMessage({ body, isLocalParticipant }: TextMessageProps) {\n  const classes = useStyles();\n\n  return (\n    <div>\n      <div\n        className={clsx(classes.messageContainer, {\n          [classes.isLocalParticipant]: isLocalParticipant,\n        })}\n      >\n        <div>{addLinks(body)}</div>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\n\nexport default function FileDownloadIcon() {\n  return (\n    <svg width=\"40\" height=\"41\" viewBox=\"0 0 40 41\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M24.4111 30.2441C24.7365 29.9186 25.2641 29.9186 25.5896 30.2441L29.167 33.8215L32.7444 30.2441C33.0698 29.9186 33.5975 29.9186 33.9229 30.2441C34.2484 30.5695 34.2484 31.0972 33.9229 31.4226L29.7562 35.5893C29.4308 35.9147 28.9032 35.9147 28.5777 35.5893L24.4111 31.4226C24.0856 31.0972 24.0856 30.5695 24.4111 30.2441Z\"\n        fill=\"#14B053\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M29.1663 20.8334C24.1037 20.8334 19.9997 24.9375 19.9997 30.0001C19.9997 35.0627 24.1037 39.1667 29.1663 39.1667C34.229 39.1667 38.333 35.0627 38.333 30.0001C38.333 24.9375 34.229 20.8334 29.1663 20.8334ZM18.333 30.0001C18.333 24.017 23.1833 19.1667 29.1663 19.1667C35.1494 19.1667 39.9997 24.017 39.9997 30.0001C39.9997 35.9832 35.1494 40.8334 29.1663 40.8334C23.1833 40.8334 18.333 35.9832 18.333 30.0001Z\"\n        fill=\"#14B053\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M29.1663 24.1667C29.6266 24.1667 29.9997 24.5398 29.9997 25.0001V35.0001C29.9997 35.4603 29.6266 35.8334 29.1663 35.8334C28.7061 35.8334 28.333 35.4603 28.333 35.0001V25.0001C28.333 24.5398 28.7061 24.1667 29.1663 24.1667Z\"\n        fill=\"#14B053\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M18.3786 14.168C18.6994 14.1854 18.9816 14.3857 19.1039 14.6828L20.5389 18.1678C20.7141 18.5934 20.5112 19.0804 20.0856 19.2557C19.6601 19.4309 19.173 19.228 18.9978 18.8024L18.2281 16.9332L14.0649 24.5658C13.9392 24.7964 13.7121 24.9541 13.4521 24.9916C13.1922 25.029 12.9298 24.9417 12.7441 24.756L10.2283 22.2402L7.1817 28.3334H14.9317C15.3919 28.3334 15.765 28.7065 15.765 29.1668C15.765 29.627 15.3919 30.0001 14.9317 30.0001H5.83333C5.54452 30.0001 5.2763 29.8505 5.12446 29.6049C4.97262 29.3592 4.95882 29.0524 5.08798 28.7941L9.25464 20.4607C9.37444 20.2212 9.6021 20.0538 9.86652 20.0108C10.1309 19.9679 10.3998 20.0548 10.5893 20.2442L13.1351 22.79L17.6018 14.601C17.7556 14.319 18.0578 14.1505 18.3786 14.168Z\"\n        fill=\"#707578\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M8.33333 9.99992C7.41286 9.99992 6.66667 10.7461 6.66667 11.6666C6.66667 12.5871 7.41286 13.3333 8.33333 13.3333C9.25381 13.3333 10 12.5871 10 11.6666C10 10.7461 9.25381 9.99992 8.33333 9.99992ZM5 11.6666C5 9.82564 6.49238 8.33325 8.33333 8.33325C10.1743 8.33325 11.6667 9.82564 11.6667 11.6666C11.6667 13.5075 10.1743 14.9999 8.33333 14.9999C6.49238 14.9999 5 13.5075 5 11.6666Z\"\n        fill=\"#707578\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M0 0.833333C0 0.373096 0.373096 0 0.833333 0H19.1667C19.3877 0 19.5996 0.0877974 19.7559 0.244078L28.0893 8.57741C28.2455 8.73369 28.3333 8.94565 28.3333 9.16667V15.8333C28.3333 16.2936 27.9602 16.6667 27.5 16.6667C27.0398 16.6667 26.6667 16.2936 26.6667 15.8333V9.51185L18.8215 1.66667H1.66667V35H17.5C17.9602 35 18.3333 35.3731 18.3333 35.8333C18.3333 36.2936 17.9602 36.6667 17.5 36.6667H0.833333C0.373096 36.6667 0 36.2936 0 35.8333V0.833333Z\"\n        fill=\"#707578\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M19.1663 0C19.6266 0 19.9997 0.373096 19.9997 0.833333V8.33333H27.4997C27.9599 8.33333 28.333 8.70643 28.333 9.16667C28.333 9.6269 27.9599 10 27.4997 10H19.1663C18.7061 10 18.333 9.6269 18.333 9.16667V0.833333C18.333 0.373096 18.7061 0 19.1663 0Z\"\n        fill=\"#707578\"\n      />\n    </svg>\n  );\n}\n","import React from 'react';\nimport FileDownloadIcon from '../../../../icons/FileDownloadIcon';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Media } from '@twilio/conversations/lib/media';\n\nconst useStyles = makeStyles({\n  messageContainer: {\n    display: 'flex',\n    padding: '0.9em 1.5em',\n    margin: '0.6em 0',\n    border: '2px solid #e4e7e9',\n    borderRadius: '4px',\n    cursor: 'pointer',\n  },\n  iconContainer: {\n    display: 'flex',\n    alignItems: 'center',\n  },\n  mediaInfo: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    marginLeft: '1.5em',\n    minWidth: 0,\n    '& p': {\n      margin: 0,\n      fontSize: '12px',\n    },\n  },\n  filename: {\n    fontWeight: 700,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  size: {\n    fontWeight: 400,\n  },\n});\n\ninterface MediaMessageProps {\n  media: Media;\n}\n\nexport function formatFileSize(bytes: number, suffixIndex = 0): string {\n  const suffixes = ['bytes', 'KB', 'MB', 'GB'];\n  if (bytes < 1000) return +bytes.toFixed(2) + ' ' + suffixes[suffixIndex];\n  return formatFileSize(bytes / 1024, suffixIndex + 1);\n}\n\nexport default function FileMessage({ media }: MediaMessageProps) {\n  const classes = useStyles();\n\n  const handleClick = () => {\n    media.getContentTemporaryUrl().then(url => {\n      const anchorEl = document.createElement('a');\n\n      anchorEl.href = url;\n      anchorEl.target = '_blank';\n      anchorEl.rel = 'noopener';\n\n      // setTimeout is needed in order to open files in iOS Safari.\n      setTimeout(() => {\n        anchorEl.click();\n      });\n    });\n  };\n\n  return (\n    <div className={classes.messageContainer} onClick={handleClick}>\n      <div className={classes.iconContainer}>\n        <FileDownloadIcon />\n      </div>\n      <div className={classes.mediaInfo}>\n        <p className={classes.filename}>{media.filename}</p>\n        <p className={classes.size}>{formatFileSize(media.size)} - Click to open</p>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport { Message } from '@twilio/conversations/lib/message';\nimport MessageInfo from './MessageInfo/MessageInfo';\nimport MessageListScrollContainer from './MessageListScrollContainer/MessageListScrollContainer';\nimport TextMessage from './TextMessage/TextMessage';\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\nimport MediaMessage from './MediaMessage/MediaMessage';\n\ninterface MessageListProps {\n  messages: Message[];\n}\n\nconst getFormattedTime = (message?: Message) =>\n  message?.dateCreated.toLocaleTimeString('en-us', { hour: 'numeric', minute: 'numeric' }).toLowerCase();\n\nexport default function MessageList({ messages }: MessageListProps) {\n  const { room } = useVideoContext();\n  const localParticipant = room!.localParticipant;\n\n  return (\n    <MessageListScrollContainer messages={messages}>\n      {messages.map((message, idx) => {\n        const time = getFormattedTime(message)!;\n        const previousTime = getFormattedTime(messages[idx - 1]);\n\n        // Display the MessageInfo component when the author or formatted timestamp differs from the previous message\n        const shouldDisplayMessageInfo = time !== previousTime || message.author !== messages[idx - 1]?.author;\n\n        const isLocalParticipant = localParticipant.identity === message.author;\n\n        return (\n          <React.Fragment key={message.sid}>\n            {shouldDisplayMessageInfo && (\n              <MessageInfo author={message.author} isLocalParticipant={isLocalParticipant} dateCreated={time} />\n            )}\n            {message.type === 'text' && <TextMessage body={message.body} isLocalParticipant={isLocalParticipant} />}\n            {message.type === 'media' && <MediaMessage media={message.media} />}\n          </React.Fragment>\n        );\n      })}\n    </MessageListScrollContainer>\n  );\n}\n","import React from 'react';\nimport { makeStyles, createStyles, Theme } from '@material-ui/core/styles';\nimport ChatWindowHeader from './ChatWindowHeader/ChatWindowHeader';\nimport ChatInput from './ChatInput/ChatInput';\nimport clsx from 'clsx';\nimport MessageList from './MessageList/MessageList';\nimport useChatContext from '../../hooks/useChatContext/useChatContext';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    chatWindowContainer: {\n      background: '#FFFFFF',\n      zIndex: 100,\n      display: 'flex',\n      flexDirection: 'column',\n      borderLeft: '1px solid #E4E7E9',\n      [theme.breakpoints.down('sm')]: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        bottom: 0,\n        right: 0,\n      },\n    },\n    hide: {\n      display: 'none',\n    },\n  })\n);\n\n// In this component, we are toggling the visibility of the ChatWindow with CSS instead of\n// conditionally rendering the component in the DOM. This is done so that the ChatWindow is\n// not unmounted while a file upload is in progress.\n\nexport default function ChatWindow() {\n  const classes = useStyles();\n  const { isChatWindowOpen, messages, conversation } = useChatContext();\n\n  return (\n    <aside className={clsx(classes.chatWindowContainer, { [classes.hide]: !isChatWindowOpen })}>\n      <ChatWindowHeader />\n      <MessageList messages={messages} />\n      <ChatInput conversation={conversation!} isChatWindowOpen={isChatWindowOpen} />\n    </aside>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Participant } from 'twilio-video';\nimport useParticipantNetworkQualityLevel from '../../hooks/useParticipantNetworkQualityLevel/useParticipantNetworkQualityLevel';\n\nconst useStyles = makeStyles({\n  outerContainer: {\n    width: '2em',\n    height: '2em',\n    padding: '0.9em',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    background: 'rgba(0, 0, 0, 0.5)',\n  },\n  innerContainer: {\n    display: 'flex',\n    alignItems: 'flex-end',\n    '& div': {\n      width: '2px',\n      marginRight: '1px',\n      '&:not(:last-child)': {\n        borderRight: 'none',\n      },\n    },\n  },\n});\n\nconst STEP = 3;\nconst BARS_ARRAY = [0, 1, 2, 3, 4];\n\nexport default function NetworkQualityLevel({ participant }: { participant: Participant }) {\n  const classes = useStyles();\n  const networkQualityLevel = useParticipantNetworkQualityLevel(participant);\n\n  if (networkQualityLevel === null) return null;\n\n  return (\n    <div className={classes.outerContainer}>\n      <div className={classes.innerContainer}>\n        {BARS_ARRAY.map(level => (\n          <div\n            key={level}\n            style={{\n              height: `${STEP * (level + 1)}px`,\n              background: networkQualityLevel > level ? 'white' : 'rgba(255, 255, 255, 0.2)',\n            }}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState } from 'react';\nimport { Participant } from 'twilio-video';\n\nexport default function useParticipantNetworkQualityLevel(participant: Participant) {\n  const [networkQualityLevel, setNetworkQualityLevel] = useState(participant.networkQualityLevel);\n\n  useEffect(() => {\n    const handleNewtorkQualityLevelChange = (newNetworkQualityLevel: number) =>\n      setNetworkQualityLevel(newNetworkQualityLevel);\n\n    setNetworkQualityLevel(participant.networkQualityLevel);\n    participant.on('networkQualityLevelChanged', handleNewtorkQualityLevelChange);\n    return () => {\n      participant.off('networkQualityLevelChanged', handleNewtorkQualityLevelChange);\n    };\n  }, [participant]);\n\n  return networkQualityLevel;\n}\n","import React from 'react';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport SvgIcon from '@material-ui/core/SvgIcon';\n\nexport default function PinIcon() {\n  return (\n    <Tooltip title=\"Participant is pinned. Click to un-pin.\" placement=\"top\">\n      <SvgIcon\n        style={{ float: 'right', background: 'rgba(0, 0, 0, 0.5)', padding: '0.1em', boxSizing: 'content-box' }}\n        width=\"26\"\n        height=\"26\"\n        viewBox=\"0 0 26 26\"\n      >\n        <path\n          fill=\"#FFF\"\n          fillRule=\"evenodd\"\n          strokeWidth=\"0\"\n          d=\"M15.808 4.489c.208-.207.544-.207.75 0l4.953 4.952c.207.207.207.543 0 .75l-1.415 1.415c-.207.208-.543.208-.75 0l-.333-.333-3.007 3.007v2.611c0 .113-.035.222-.1.312l-.055.063-1.06 1.062c-.208.207-.544.207-.751 0l-2.809-2.81-5.992 5.993c-.207.207-.543.207-.75 0-.184-.184-.205-.47-.062-.677l.062-.073 5.991-5.993-2.808-2.808c-.184-.184-.204-.47-.061-.677l.061-.073 1.062-1.061c.1-.1.234-.156.375-.156h2.61l3.007-3.007-.332-.332c-.185-.184-.205-.47-.062-.677l.062-.073zm.376 1.125l-.666.664.333.333c.185.184.205.47.062.677l-.062.074-3.537 3.537c-.1.1-.234.155-.375.155h-2.61l-.531.531 2.803 2.803.005.006.005.005 2.804 2.803.53-.531v-2.61c0-.112.036-.221.102-.311l.054-.064 3.537-3.537c.208-.208.544-.208.75 0l.333.332.664-.666-4.201-4.201z\"\n        />\n      </SvgIcon>\n    </Tooltip>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { LocalVideoTrack, RemoteVideoTrack } from 'twilio-video';\n\ntype TrackType = RemoteVideoTrack | LocalVideoTrack | undefined | null;\n\n// The 'switchedOff' event is emitted when there is not enough bandwidth to support\n// a track. See: https://www.twilio.com/docs/video/tutorials/using-bandwidth-profile-api#understanding-track-switch-offs\n\nexport default function useIsTrackSwitchedOff(track: TrackType) {\n  const [isSwitchedOff, setIsSwitchedOff] = useState(track && track.isSwitchedOff);\n\n  useEffect(() => {\n    // Reset the value if the 'track' variable changes\n    setIsSwitchedOff(track && track.isSwitchedOff);\n\n    if (track) {\n      const handleSwitchedOff = () => setIsSwitchedOff(true);\n      const handleSwitchedOn = () => setIsSwitchedOff(false);\n      track.on('switchedOff', handleSwitchedOff);\n      track.on('switchedOn', handleSwitchedOn);\n      return () => {\n        track.off('switchedOff', handleSwitchedOff);\n        track.off('switchedOn', handleSwitchedOn);\n      };\n    }\n  }, [track]);\n\n  return !!isSwitchedOff;\n}\n","import { useEffect, useState } from 'react';\nimport { LocalTrackPublication, Participant, RemoteTrackPublication } from 'twilio-video';\n\ntype TrackPublication = LocalTrackPublication | RemoteTrackPublication;\n\nexport default function usePublications(participant: Participant) {\n  const [publications, setPublications] = useState<TrackPublication[]>([]);\n\n  useEffect(() => {\n    // Reset the publications when the 'participant' variable changes.\n    setPublications(Array.from(participant.tracks.values()) as TrackPublication[]);\n\n    const publicationAdded = (publication: TrackPublication) =>\n      setPublications(prevPublications => [...prevPublications, publication]);\n    const publicationRemoved = (publication: TrackPublication) =>\n      setPublications(prevPublications => prevPublications.filter(p => p !== publication));\n\n    participant.on('trackPublished', publicationAdded);\n    participant.on('trackUnpublished', publicationRemoved);\n    return () => {\n      participant.off('trackPublished', publicationAdded);\n      participant.off('trackUnpublished', publicationRemoved);\n    };\n  }, [participant]);\n\n  return publications;\n}\n","import { useEffect, useState } from 'react';\nimport { LocalTrackPublication, RemoteTrackPublication } from 'twilio-video';\n\nexport default function useTrack(publication: LocalTrackPublication | RemoteTrackPublication | undefined) {\n  const [track, setTrack] = useState(publication && publication.track);\n\n  useEffect(() => {\n    // Reset the track when the 'publication' variable changes.\n    setTrack(publication && publication.track);\n\n    if (publication) {\n      const removeTrack = () => setTrack(null);\n\n      publication.on('subscribed', setTrack);\n      publication.on('unsubscribed', removeTrack);\n      return () => {\n        publication.off('subscribed', setTrack);\n        publication.off('unsubscribed', removeTrack);\n      };\n    }\n  }, [publication]);\n\n  return track;\n}\n","import { useEffect, useState } from 'react';\nimport { Participant } from 'twilio-video';\n\nexport default function useParticipantIsReconnecting(participant: Participant) {\n  const [isReconnecting, setIsReconnecting] = useState(false);\n\n  useEffect(() => {\n    const handleReconnecting = () => setIsReconnecting(true);\n    const handleReconnected = () => setIsReconnecting(false);\n\n    handleReconnected(); // Reset state when there is a new participant\n\n    participant.on('reconnecting', handleReconnecting);\n    participant.on('reconnected', handleReconnected);\n    return () => {\n      participant.off('reconnecting', handleReconnecting);\n      participant.off('reconnected', handleReconnected);\n    };\n  }, [participant]);\n\n  return isReconnecting;\n}\n","import React from 'react';\nimport clsx from 'clsx';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport { LocalAudioTrack, LocalVideoTrack, Participant, RemoteAudioTrack, RemoteVideoTrack } from 'twilio-video';\n\nimport AudioLevelIndicator from '../AudioLevelIndicator/AudioLevelIndicator';\nimport AvatarIcon from '../../icons/AvatarIcon';\nimport NetworkQualityLevel from '../NetworkQualityLevel/NetworkQualityLevel';\nimport PinIcon from './PinIcon/PinIcon';\nimport ScreenShareIcon from '../../icons/ScreenShareIcon';\nimport Typography from '@material-ui/core/Typography';\n\nimport useIsTrackSwitchedOff from '../../hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff';\nimport usePublications from '../../hooks/usePublications/usePublications';\nimport useTrack from '../../hooks/useTrack/useTrack';\nimport useParticipantIsReconnecting from '../../hooks/useParticipantIsReconnecting/useParticipantIsReconnecting';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    container: {\n      position: 'relative',\n      display: 'flex',\n      alignItems: 'center',\n      height: 0,\n      overflow: 'hidden',\n      marginBottom: '2em',\n      '& video': {\n        filter: 'none',\n        objectFit: 'contain !important',\n      },\n      borderRadius: '4px',\n      border: `${theme.participantBorderWidth}px solid rgb(245, 248, 255)`,\n      paddingTop: `calc(${(9 / 16) * 100}% - ${theme.participantBorderWidth}px)`,\n      background: 'black',\n      [theme.breakpoints.down('sm')]: {\n        height: theme.sidebarMobileHeight,\n        width: `${(theme.sidebarMobileHeight * 16) / 9}px`,\n        marginRight: '8px',\n        marginBottom: '0',\n        fontSize: '10px',\n        paddingTop: `${theme.sidebarMobileHeight - 2}px`,\n      },\n    },\n    innerContainer: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n    },\n    infoContainer: {\n      position: 'absolute',\n      zIndex: 2,\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'space-between',\n      height: '100%',\n      width: '100%',\n      background: 'transparent',\n      top: 0,\n    },\n    avatarContainer: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      background: 'black',\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n      zIndex: 1,\n      [theme.breakpoints.down('sm')]: {\n        '& svg': {\n          transform: 'scale(0.7)',\n        },\n      },\n    },\n    reconnectingContainer: {\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      background: 'rgba(40, 42, 43, 0.75)',\n      zIndex: 1,\n    },\n    screenShareIconContainer: {\n      background: 'rgba(0, 0, 0, 0.5)',\n      padding: '0.18em 0.3em',\n      marginRight: '0.3em',\n      display: 'flex',\n      '& path': {\n        fill: 'white',\n      },\n    },\n    identity: {\n      background: 'rgba(0, 0, 0, 0.5)',\n      color: 'white',\n      padding: '0.18em 0.3em',\n      margin: 0,\n      display: 'flex',\n      alignItems: 'center',\n    },\n    infoRowBottom: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      position: 'absolute',\n      bottom: 0,\n      left: 0,\n    },\n    typeography: {\n      color: 'white',\n      [theme.breakpoints.down('sm')]: {\n        fontSize: '0.75rem',\n      },\n    },\n    hideParticipant: {\n      display: 'none',\n    },\n    cursorPointer: {\n      cursor: 'pointer',\n    },\n  })\n);\n\ninterface ParticipantInfoProps {\n  participant: Participant;\n  children: React.ReactNode;\n  onClick?: () => void;\n  isSelected?: boolean;\n  isLocalParticipant?: boolean;\n  hideParticipant?: boolean;\n}\n\nexport default function ParticipantInfo({\n  participant,\n  onClick,\n  isSelected,\n  children,\n  isLocalParticipant,\n  hideParticipant,\n}: ParticipantInfoProps) {\n  const publications = usePublications(participant);\n\n  const audioPublication = publications.find(p => p.kind === 'audio');\n  const videoPublication = publications.find(p => p.trackName.includes('camera'));\n\n  const isVideoEnabled = Boolean(videoPublication);\n  const isScreenShareEnabled = publications.find(p => p.trackName.includes('screen'));\n\n  const videoTrack = useTrack(videoPublication);\n  const isVideoSwitchedOff = useIsTrackSwitchedOff(videoTrack as LocalVideoTrack | RemoteVideoTrack);\n\n  const audioTrack = useTrack(audioPublication) as LocalAudioTrack | RemoteAudioTrack | undefined;\n  const isParticipantReconnecting = useParticipantIsReconnecting(participant);\n\n  const classes = useStyles();\n\n  return (\n    <div\n      className={clsx(classes.container, {\n        [classes.hideParticipant]: hideParticipant,\n        [classes.cursorPointer]: Boolean(onClick),\n      })}\n      onClick={onClick}\n      data-cy-participant={participant.identity}\n    >\n      <div className={classes.infoContainer}>\n        <NetworkQualityLevel participant={participant} />\n        <div className={classes.infoRowBottom}>\n          {isScreenShareEnabled && (\n            <span className={classes.screenShareIconContainer}>\n              <ScreenShareIcon />\n            </span>\n          )}\n          <span className={classes.identity}>\n            <AudioLevelIndicator audioTrack={audioTrack} />\n            <Typography variant=\"body1\" className={classes.typeography} component=\"span\">\n              {participant.identity}\n              {isLocalParticipant && ' (You)'}\n            </Typography>\n          </span>\n        </div>\n        <div>{isSelected && <PinIcon />}</div>\n      </div>\n      <div className={classes.innerContainer}>\n        {(!isVideoEnabled || isVideoSwitchedOff) && (\n          <div className={classes.avatarContainer}>\n            <AvatarIcon />\n          </div>\n        )}\n        {isParticipantReconnecting && (\n          <div className={classes.reconnectingContainer}>\n            <Typography variant=\"body1\" className={classes.typeography}>\n              Reconnecting...\n            </Typography>\n          </div>\n        )}\n        {children}\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useRef } from 'react';\nimport { AudioTrack as IAudioTrack } from 'twilio-video';\nimport { useAppState } from '../../state';\n\ninterface AudioTrackProps {\n  track: IAudioTrack;\n}\n\nexport default function AudioTrack({ track }: AudioTrackProps) {\n  const { activeSinkId } = useAppState();\n  const audioEl = useRef<HTMLAudioElement>();\n\n  useEffect(() => {\n    audioEl.current = track.attach();\n    audioEl.current.setAttribute('data-cy-audio-track-name', track.name);\n    document.body.appendChild(audioEl.current);\n    return () => track.detach().forEach(el => el.remove());\n  }, [track]);\n\n  useEffect(() => {\n    audioEl.current?.setSinkId?.(activeSinkId);\n  }, [activeSinkId]);\n\n  return null;\n}\n","import React from 'react';\nimport useTrack from '../../hooks/useTrack/useTrack';\nimport AudioTrack from '../AudioTrack/AudioTrack';\nimport VideoTrack from '../VideoTrack/VideoTrack';\n\nimport { IVideoTrack } from '../../types';\nimport {\n  AudioTrack as IAudioTrack,\n  LocalTrackPublication,\n  Participant,\n  RemoteTrackPublication,\n  Track,\n} from 'twilio-video';\n\ninterface PublicationProps {\n  publication: LocalTrackPublication | RemoteTrackPublication;\n  participant: Participant;\n  isLocalParticipant?: boolean;\n  videoOnly?: boolean;\n  videoPriority?: Track.Priority | null;\n}\n\nexport default function Publication({ publication, isLocalParticipant, videoOnly, videoPriority }: PublicationProps) {\n  const track = useTrack(publication);\n\n  if (!track) return null;\n\n  switch (track.kind) {\n    case 'video':\n      return (\n        <VideoTrack\n          track={track as IVideoTrack}\n          priority={videoPriority}\n          isLocal={track.name.includes('camera') && isLocalParticipant}\n        />\n      );\n    case 'audio':\n      return videoOnly ? null : <AudioTrack track={track as IAudioTrack} />;\n    default:\n      return null;\n  }\n}\n","import React from 'react';\nimport { Participant, Track } from 'twilio-video';\nimport Publication from '../Publication/Publication';\nimport usePublications from '../../hooks/usePublications/usePublications';\n\ninterface ParticipantTracksProps {\n  participant: Participant;\n  videoOnly?: boolean;\n  enableScreenShare?: boolean;\n  videoPriority?: Track.Priority | null;\n  isLocalParticipant?: boolean;\n}\n\n/*\n *  The object model for the Room object (found here: https://www.twilio.com/docs/video/migrating-1x-2x#object-model) shows\n *  that Participant objects have TrackPublications, and TrackPublication objects have Tracks.\n *\n *  The React components in this application follow the same pattern. This ParticipantTracks component renders Publications,\n *  and the Publication component renders Tracks.\n */\n\nexport default function ParticipantTracks({\n  participant,\n  videoOnly,\n  enableScreenShare,\n  videoPriority,\n  isLocalParticipant,\n}: ParticipantTracksProps) {\n  const publications = usePublications(participant);\n\n  let filteredPublications;\n\n  if (enableScreenShare && publications.some(p => p.trackName.includes('screen'))) {\n    filteredPublications = publications.filter(p => !p.trackName.includes('camera'));\n  } else {\n    filteredPublications = publications.filter(p => !p.trackName.includes('screen'));\n  }\n\n  return (\n    <>\n      {filteredPublications.map(publication => (\n        <Publication\n          key={publication.kind}\n          publication={publication}\n          participant={participant}\n          isLocalParticipant={isLocalParticipant}\n          videoOnly={videoOnly}\n          videoPriority={videoPriority}\n        />\n      ))}\n    </>\n  );\n}\n","import React from 'react';\nimport ParticipantInfo from '../ParticipantInfo/ParticipantInfo';\nimport ParticipantTracks from '../ParticipantTracks/ParticipantTracks';\nimport { Participant as IParticipant } from 'twilio-video';\n\ninterface ParticipantProps {\n  participant: IParticipant;\n  videoOnly?: boolean;\n  enableScreenShare?: boolean;\n  onClick?: () => void;\n  isSelected?: boolean;\n  isDominantSpeaker?: boolean;\n  isLocalParticipant?: boolean;\n  hideParticipant?: boolean;\n}\n\nexport default function Participant({\n  participant,\n  videoOnly,\n  enableScreenShare,\n  onClick,\n  isSelected,\n  isLocalParticipant,\n  hideParticipant,\n}: ParticipantProps) {\n  return (\n    <ParticipantInfo\n      participant={participant}\n      onClick={onClick}\n      isSelected={isSelected}\n      isLocalParticipant={isLocalParticipant}\n      hideParticipant={hideParticipant}\n    >\n      <ParticipantTracks\n        participant={participant}\n        videoOnly={videoOnly}\n        enableScreenShare={enableScreenShare}\n        isLocalParticipant={isLocalParticipant}\n      />\n    </ParticipantInfo>\n  );\n}\n","import { useEffect, useState } from 'react';\nimport useVideoContext from '../useVideoContext/useVideoContext';\nimport { RemoteParticipant } from 'twilio-video';\n\nexport default function useDominantSpeaker() {\n  const { room } = useVideoContext();\n  const [dominantSpeaker, setDominantSpeaker] = useState(room?.dominantSpeaker ?? null);\n\n  useEffect(() => {\n    if (room) {\n      // Sometimes, the 'dominantSpeakerChanged' event can emit 'null', which means that\n      // there is no dominant speaker. If we change the main participant when 'null' is\n      // emitted, the effect can be jarring to the user. Here we ignore any 'null' values\n      // and continue to display the previous dominant speaker as the main participant.\n      const handleDominantSpeakerChanged = (newDominantSpeaker: RemoteParticipant) => {\n        if (newDominantSpeaker !== null) {\n          setDominantSpeaker(newDominantSpeaker);\n        }\n      };\n\n      // Since 'null' values are ignored, we will need to listen for the 'participantDisconnected'\n      // event, so we can set the dominantSpeaker to 'null' when they disconnect.\n      const handleParticipantDisconnected = (participant: RemoteParticipant) => {\n        setDominantSpeaker(prevDominantSpeaker => {\n          return prevDominantSpeaker === participant ? null : prevDominantSpeaker;\n        });\n      };\n\n      room.on('dominantSpeakerChanged', handleDominantSpeakerChanged);\n      room.on('participantDisconnected', handleParticipantDisconnected);\n      return () => {\n        room.off('dominantSpeakerChanged', handleDominantSpeakerChanged);\n        room.off('participantDisconnected', handleParticipantDisconnected);\n      };\n    }\n  }, [room]);\n\n  return dominantSpeaker;\n}\n","import { useEffect, useState } from 'react';\nimport { RemoteParticipant } from 'twilio-video';\nimport useDominantSpeaker from '../useDominantSpeaker/useDominantSpeaker';\nimport useVideoContext from '../useVideoContext/useVideoContext';\n\nexport default function useParticipants() {\n  const { room } = useVideoContext();\n  const dominantSpeaker = useDominantSpeaker();\n  const [participants, setParticipants] = useState(Array.from(room?.participants.values() ?? []));\n\n  // When the dominant speaker changes, they are moved to the front of the participants array.\n  // This means that the most recent dominant speakers will always be near the top of the\n  // ParticipantStrip component.\n  useEffect(() => {\n    if (dominantSpeaker) {\n      setParticipants(prevParticipants => [\n        dominantSpeaker,\n        ...prevParticipants.filter(participant => participant !== dominantSpeaker),\n      ]);\n    }\n  }, [dominantSpeaker]);\n\n  useEffect(() => {\n    if (room) {\n      const participantConnected = (participant: RemoteParticipant) =>\n        setParticipants(prevParticipants => [...prevParticipants, participant]);\n      const participantDisconnected = (participant: RemoteParticipant) =>\n        setParticipants(prevParticipants => prevParticipants.filter(p => p !== participant));\n      room.on('participantConnected', participantConnected);\n      room.on('participantDisconnected', participantDisconnected);\n      return () => {\n        room.off('participantConnected', participantConnected);\n        room.off('participantDisconnected', participantDisconnected);\n      };\n    }\n  }, [room]);\n\n  return participants;\n}\n","import useVideoContext from '../useVideoContext/useVideoContext';\nimport useDominantSpeaker from '../useDominantSpeaker/useDominantSpeaker';\nimport useParticipants from '../useParticipants/useParticipants';\nimport useScreenShareParticipant from '../useScreenShareParticipant/useScreenShareParticipant';\nimport useSelectedParticipant from '../../components/VideoProvider/useSelectedParticipant/useSelectedParticipant';\n\nexport default function useMainParticipant() {\n  const [selectedParticipant] = useSelectedParticipant();\n  const screenShareParticipant = useScreenShareParticipant();\n  const dominantSpeaker = useDominantSpeaker();\n  const participants = useParticipants();\n  const { room } = useVideoContext();\n  const localParticipant = room?.localParticipant;\n  const remoteScreenShareParticipant = screenShareParticipant !== localParticipant ? screenShareParticipant : null;\n\n  // The participant that is returned is displayed in the main video area. Changing the order of the following\n  // variables will change the how the main speaker is determined.\n  return selectedParticipant || remoteScreenShareParticipant || dominantSpeaker || participants[0] || localParticipant;\n}\n","import React from 'react';\nimport clsx from 'clsx';\nimport Participant from '../Participant/Participant';\nimport { makeStyles, createStyles, Theme } from '@material-ui/core/styles';\nimport useMainParticipant from '../../hooks/useMainParticipant/useMainParticipant';\nimport useParticipants from '../../hooks/useParticipants/useParticipants';\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\nimport useSelectedParticipant from '../VideoProvider/useSelectedParticipant/useSelectedParticipant';\nimport useScreenShareParticipant from '../../hooks/useScreenShareParticipant/useScreenShareParticipant';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    container: {\n      overflowY: 'auto',\n      background: 'rgb(79, 83, 85)',\n      gridArea: '1 / 2 / 1 / 3',\n      zIndex: 5,\n      [theme.breakpoints.down('sm')]: {\n        gridArea: '2 / 1 / 3 / 3',\n        overflowY: 'initial',\n        overflowX: 'auto',\n        display: 'flex',\n      },\n    },\n    transparentBackground: {\n      background: 'transparent',\n    },\n    scrollContainer: {\n      display: 'flex',\n      justifyContent: 'center',\n    },\n    innerScrollContainer: {\n      width: `calc(${theme.sidebarWidth}px - 4em)`,\n      padding: '2em 0',\n      [theme.breakpoints.down('sm')]: {\n        width: 'auto',\n        padding: `${theme.sidebarMobilePadding}px`,\n        display: 'flex',\n      },\n    },\n  })\n);\n\nexport default function ParticipantList() {\n  const classes = useStyles();\n  const { room } = useVideoContext();\n  const localParticipant = room!.localParticipant;\n  const participants = useParticipants();\n  const [selectedParticipant, setSelectedParticipant] = useSelectedParticipant();\n  const screenShareParticipant = useScreenShareParticipant();\n  const mainParticipant = useMainParticipant();\n  const isRemoteParticipantScreenSharing = screenShareParticipant && screenShareParticipant !== localParticipant;\n\n  if (participants.length === 0) return null; // Don't render this component if there are no remote participants.\n\n  return (\n    <aside\n      className={clsx(classes.container, {\n        [classes.transparentBackground]: !isRemoteParticipantScreenSharing,\n      })}\n    >\n      <div className={classes.scrollContainer}>\n        <div className={classes.innerScrollContainer}>\n          <Participant participant={localParticipant} isLocalParticipant={true} />\n          {participants.map(participant => {\n            const isSelected = participant === selectedParticipant;\n            const hideParticipant =\n              participant === mainParticipant && participant !== screenShareParticipant && !isSelected;\n            return (\n              <Participant\n                key={participant.sid}\n                participant={participant}\n                isSelected={participant === selectedParticipant}\n                onClick={() => setSelectedParticipant(participant)}\n                hideParticipant={hideParticipant}\n              />\n            );\n          })}\n        </div>\n      </div>\n    </aside>\n  );\n}\n","import React from 'react';\nimport clsx from 'clsx';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport { LocalAudioTrack, LocalVideoTrack, Participant, RemoteAudioTrack, RemoteVideoTrack } from 'twilio-video';\n\nimport AvatarIcon from '../../icons/AvatarIcon';\nimport Typography from '@material-ui/core/Typography';\n\nimport useIsTrackSwitchedOff from '../../hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff';\nimport usePublications from '../../hooks/usePublications/usePublications';\nimport useScreenShareParticipant from '../../hooks/useScreenShareParticipant/useScreenShareParticipant';\nimport useTrack from '../../hooks/useTrack/useTrack';\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\nimport useParticipantIsReconnecting from '../../hooks/useParticipantIsReconnecting/useParticipantIsReconnecting';\nimport AudioLevelIndicator from '../AudioLevelIndicator/AudioLevelIndicator';\nimport NetworkQualityLevel from '../NetworkQualityLevel/NetworkQualityLevel';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  container: {\n    position: 'relative',\n    display: 'flex',\n    alignItems: 'center',\n  },\n  identity: {\n    background: 'rgba(0, 0, 0, 0.5)',\n    color: 'white',\n    padding: '0.1em 0.3em 0.1em 0',\n    display: 'inline-flex',\n    '& svg': {\n      marginLeft: '0.3em',\n    },\n    marginRight: '0.4em',\n    alignItems: 'center',\n  },\n  infoContainer: {\n    position: 'absolute',\n    zIndex: 2,\n    height: '100%',\n    width: '100%',\n  },\n  reconnectingContainer: {\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    background: 'rgba(40, 42, 43, 0.75)',\n    zIndex: 1,\n  },\n  fullWidth: {\n    gridArea: '1 / 1 / 2 / 3',\n    [theme.breakpoints.down('sm')]: {\n      gridArea: '1 / 1 / 3 / 3',\n    },\n  },\n  avatarContainer: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    background: 'black',\n    position: 'absolute',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    zIndex: 1,\n    '& svg': {\n      transform: 'scale(2)',\n    },\n  },\n}));\n\ninterface MainParticipantInfoProps {\n  participant: Participant;\n  children: React.ReactNode;\n}\n\nexport default function MainParticipantInfo({ participant, children }: MainParticipantInfoProps) {\n  const classes = useStyles();\n  const { room } = useVideoContext();\n  const localParticipant = room!.localParticipant;\n  const isLocal = localParticipant === participant;\n\n  const screenShareParticipant = useScreenShareParticipant();\n  const isRemoteParticipantScreenSharing = screenShareParticipant && screenShareParticipant !== localParticipant;\n\n  const publications = usePublications(participant);\n  const videoPublication = publications.find(p => p.trackName.includes('camera'));\n  const screenSharePublication = publications.find(p => p.trackName.includes('screen'));\n\n  const videoTrack = useTrack(screenSharePublication || videoPublication);\n  const isVideoEnabled = Boolean(videoTrack);\n\n  const audioPublication = publications.find(p => p.kind === 'audio');\n  const audioTrack = useTrack(audioPublication) as LocalAudioTrack | RemoteAudioTrack | undefined;\n\n  const isVideoSwitchedOff = useIsTrackSwitchedOff(videoTrack as LocalVideoTrack | RemoteVideoTrack);\n  const isParticipantReconnecting = useParticipantIsReconnecting(participant);\n\n  return (\n    <div\n      data-cy-main-participant\n      data-cy-participant={participant.identity}\n      className={clsx(classes.container, {\n        [classes.fullWidth]: !isRemoteParticipantScreenSharing,\n      })}\n    >\n      <div className={classes.infoContainer}>\n        <div style={{ display: 'flex' }}>\n          <div className={classes.identity}>\n            <AudioLevelIndicator audioTrack={audioTrack} />\n            <Typography variant=\"body1\" color=\"inherit\">\n              {participant.identity}\n              {isLocal && ' (You)'}\n              {screenSharePublication && ' - Screen'}\n            </Typography>\n          </div>\n          <NetworkQualityLevel participant={localParticipant} />\n        </div>\n      </div>\n      {(!isVideoEnabled || isVideoSwitchedOff) && (\n        <div className={classes.avatarContainer}>\n          <AvatarIcon />\n        </div>\n      )}\n      {isParticipantReconnecting && (\n        <div className={classes.reconnectingContainer}>\n          <Typography variant=\"body1\" style={{ color: 'white' }}>\n            Reconnecting...\n          </Typography>\n        </div>\n      )}\n      {children}\n    </div>\n  );\n}\n","import MainParticipantInfo from '../MainParticipantInfo/MainParticipantInfo';\nimport ParticipantTracks from '../ParticipantTracks/ParticipantTracks';\nimport React from 'react';\nimport useMainParticipant from '../../hooks/useMainParticipant/useMainParticipant';\nimport useSelectedParticipant from '../VideoProvider/useSelectedParticipant/useSelectedParticipant';\nimport useScreenShareParticipant from '../../hooks/useScreenShareParticipant/useScreenShareParticipant';\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\n\nexport default function MainParticipant() {\n  const mainParticipant = useMainParticipant();\n  const { room } = useVideoContext();\n  const localParticipant = room!.localParticipant;\n  const [selectedParticipant] = useSelectedParticipant();\n  const screenShareParticipant = useScreenShareParticipant();\n\n  const videoPriority =\n    (mainParticipant === selectedParticipant || mainParticipant === screenShareParticipant) &&\n    mainParticipant !== localParticipant\n      ? 'high'\n      : null;\n\n  return (\n    /* audio is disabled for this participant component because this participant's audio \n       is already being rendered in the <ParticipantStrip /> component.  */\n    <MainParticipantInfo participant={mainParticipant}>\n      <ParticipantTracks\n        participant={mainParticipant}\n        videoOnly\n        enableScreenShare={mainParticipant !== localParticipant}\n        videoPriority={videoPriority}\n        isLocalParticipant={mainParticipant === localParticipant}\n      />\n    </MainParticipantInfo>\n  );\n}\n","import React from 'react';\nimport clsx from 'clsx';\nimport { makeStyles, Theme } from '@material-ui/core';\nimport ChatWindow from '../ChatWindow/ChatWindow';\nimport ParticipantList from '../ParticipantList/ParticipantList';\nimport MainParticipant from '../MainParticipant/MainParticipant';\nimport useChatContext from '../../hooks/useChatContext/useChatContext';\n\nconst useStyles = makeStyles((theme: Theme) => {\n  const totalMobileSidebarHeight = `${theme.sidebarMobileHeight +\n    theme.sidebarMobilePadding * 2 +\n    theme.participantBorderWidth}px`;\n  return {\n    container: {\n      position: 'relative',\n      height: '100%',\n      display: 'grid',\n      gridTemplateColumns: `1fr ${theme.sidebarWidth}px`,\n      gridTemplateRows: '100%',\n      [theme.breakpoints.down('sm')]: {\n        gridTemplateColumns: `100%`,\n        gridTemplateRows: `calc(100% - ${totalMobileSidebarHeight}) ${totalMobileSidebarHeight}`,\n      },\n    },\n    chatWindowOpen: { gridTemplateColumns: `1fr ${theme.sidebarWidth}px ${theme.chatWindowWidth}px` },\n  };\n});\n\nexport default function Room() {\n  const classes = useStyles();\n  const { isChatWindowOpen } = useChatContext();\n  return (\n    <div className={clsx(classes.container, { [classes.chatWindowOpen]: isChatWindowOpen })}>\n      <MainParticipant />\n      <ParticipantList />\n      <ChatWindow />\n    </div>\n  );\n}\n","import React from 'react';\nimport { styled, Theme } from '@material-ui/core/styles';\n\nimport MenuBar from './components/MenuBar/MenuBar';\nimport MobileTopMenuBar from './components/MobileTopMenuBar/MobileTopMenuBar';\nimport PreJoinScreens from './components/PreJoinScreens/PreJoinScreens';\nimport ReconnectingNotification from './components/ReconnectingNotification/ReconnectingNotification';\nimport Room from './components/Room/Room';\n\nimport useHeight from './hooks/useHeight/useHeight';\nimport useRoomState from './hooks/useRoomState/useRoomState';\n\nconst Container = styled('div')({\n  display: 'grid',\n  gridTemplateRows: '1fr auto',\n});\n\nconst Main = styled('main')(({ theme }: { theme: Theme }) => ({\n  overflow: 'hidden',\n  paddingBottom: `${theme.footerHeight}px`, // Leave some space for the footer\n  background: 'black',\n  [theme.breakpoints.down('sm')]: {\n    paddingBottom: `${theme.mobileFooterHeight + theme.mobileTopBarHeight}px`, // Leave some space for the mobile header and footer\n  },\n}));\n\nexport default function App() {\n  const roomState = useRoomState();\n\n  // Here we would like the height of the main container to be the height of the viewport.\n  // On some mobile browsers, 'height: 100vh' sets the height equal to that of the screen,\n  // not the viewport. This looks bad when the mobile browsers location bar is open.\n  // We will dynamically set the height with 'window.innerHeight', which means that this\n  // will look good on mobile browsers even after the location bar opens or closes.\n  const height = useHeight();\n\n  return (\n    <Container style={{ height }}>\n      {roomState === 'disconnected' ? (\n        <PreJoinScreens />\n      ) : (\n        <Main>\n          <ReconnectingNotification />\n          <MobileTopMenuBar />\n          <Room />\n          <MenuBar />\n        </Main>\n      )}\n    </Container>\n  );\n}\n","import { useEffect, useState } from 'react';\n\nexport default function useHeight() {\n  const [height, setHeight] = useState(window.innerHeight * (window.visualViewport?.scale || 1));\n\n  useEffect(() => {\n    const onResize = () => {\n      setHeight(window.innerHeight * (window.visualViewport?.scale || 1));\n    };\n\n    window.addEventListener('resize', onResize);\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  });\n\n  return height + 'px';\n}\n","import React, { PropsWithChildren } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport enhanceMessage from './enhanceMessage';\nimport { TwilioError } from 'twilio-video';\n\ninterface ErrorDialogProps {\n  dismissError: Function;\n  error: TwilioError | Error | null;\n}\n\nfunction ErrorDialog({ dismissError, error }: PropsWithChildren<ErrorDialogProps>) {\n  const { message, code } = error || {};\n  const enhancedMessage = enhanceMessage(message, code);\n\n  return (\n    <Dialog open={error !== null} onClose={() => dismissError()} fullWidth={true} maxWidth=\"xs\">\n      <DialogTitle>ERROR</DialogTitle>\n      <DialogContent>\n        <DialogContentText>{enhancedMessage}</DialogContentText>\n        {Boolean(code) && (\n          <pre>\n            <code>Error Code: {code}</code>\n          </pre>\n        )}\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => dismissError()} color=\"primary\" autoFocus>\n          OK\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n\nexport default ErrorDialog;\n","// This function is used to provide error messages to the user that are\n// different than the error messages provided by the SDK.\nexport default function enhanceMessage(message = '', code?: number) {\n  switch (code) {\n    case 20101: // Invalid token error\n      return message + '. Please make sure you are using the correct credentials.';\n    default:\n      return message;\n  }\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"desc\", null, \"Created with Sketch.\");\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"filter\", {\n  x: \"-50%\",\n  y: \"-50%\",\n  width: \"200%\",\n  height: \"200%\",\n  filterUnits: \"objectBoundingBox\",\n  id: \"filter-1\"\n}, /*#__PURE__*/React.createElement(\"feOffset\", {\n  dx: 0,\n  dy: 1,\n  \"in\": \"SourceAlpha\",\n  result: \"shadowOffsetOuter1\"\n}), /*#__PURE__*/React.createElement(\"feGaussianBlur\", {\n  stdDeviation: 0.5,\n  \"in\": \"shadowOffsetOuter1\",\n  result: \"shadowBlurOuter1\"\n}), /*#__PURE__*/React.createElement(\"feColorMatrix\", {\n  values: \"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.168 0\",\n  \"in\": \"shadowBlurOuter1\",\n  type: \"matrix\",\n  result: \"shadowMatrixOuter1\"\n}), /*#__PURE__*/React.createElement(\"feOffset\", {\n  dx: 0,\n  dy: 0,\n  \"in\": \"SourceAlpha\",\n  result: \"shadowOffsetOuter2\"\n}), /*#__PURE__*/React.createElement(\"feGaussianBlur\", {\n  stdDeviation: 0.5,\n  \"in\": \"shadowOffsetOuter2\",\n  result: \"shadowBlurOuter2\"\n}), /*#__PURE__*/React.createElement(\"feColorMatrix\", {\n  values: \"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.084 0\",\n  \"in\": \"shadowBlurOuter2\",\n  type: \"matrix\",\n  result: \"shadowMatrixOuter2\"\n}), /*#__PURE__*/React.createElement(\"feMerge\", null, /*#__PURE__*/React.createElement(\"feMergeNode\", {\n  \"in\": \"shadowMatrixOuter1\"\n}), /*#__PURE__*/React.createElement(\"feMergeNode\", {\n  \"in\": \"shadowMatrixOuter2\"\n}), /*#__PURE__*/React.createElement(\"feMergeNode\", {\n  \"in\": \"SourceGraphic\"\n}))), /*#__PURE__*/React.createElement(\"rect\", {\n  id: \"path-2\",\n  x: 0,\n  y: 0,\n  width: 40,\n  height: 40,\n  rx: 2\n}));\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Google-Button\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"9-PATCH\",\n  transform: \"translate(-608.000000, -160.000000)\"\n}), /*#__PURE__*/React.createElement(\"g\", {\n  id: \"btn_google_light_normal\",\n  transform: \"translate(-1.000000, -1.000000)\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"logo_googleg_48dp\",\n  transform: \"translate(15.000000, 15.000000)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M17.64,9.20454545 C17.64,8.56636364 17.5827273,7.95272727 17.4763636,7.36363636 L9,7.36363636 L9,10.845 L13.8436364,10.845 C13.635,11.97 13.0009091,12.9231818 12.0477273,13.5613636 L12.0477273,15.8195455 L14.9563636,15.8195455 C16.6581818,14.2527273 17.64,11.9454545 17.64,9.20454545 L17.64,9.20454545 Z\",\n  id: \"Shape\",\n  fill: \"#4285F4\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9,18 C11.43,18 13.4672727,17.1940909 14.9563636,15.8195455 L12.0477273,13.5613636 C11.2418182,14.1013636 10.2109091,14.4204545 9,14.4204545 C6.65590909,14.4204545 4.67181818,12.8372727 3.96409091,10.71 L0.957272727,10.71 L0.957272727,13.0418182 C2.43818182,15.9831818 5.48181818,18 9,18 L9,18 Z\",\n  id: \"Shape\",\n  fill: \"#34A853\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M3.96409091,10.71 C3.78409091,10.17 3.68181818,9.59318182 3.68181818,9 C3.68181818,8.40681818 3.78409091,7.83 3.96409091,7.29 L3.96409091,4.95818182 L0.957272727,4.95818182 C0.347727273,6.17318182 0,7.54772727 0,9 C0,10.4522727 0.347727273,11.8268182 0.957272727,13.0418182 L3.96409091,10.71 L3.96409091,10.71 Z\",\n  id: \"Shape\",\n  fill: \"#FBBC05\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9,3.57954545 C10.3213636,3.57954545 11.5077273,4.03363636 12.4404545,4.92545455 L15.0218182,2.34409091 C13.4631818,0.891818182 11.4259091,0 9,0 C5.48181818,0 2.43818182,2.01681818 0.957272727,4.95818182 L3.96409091,7.29 C4.67181818,5.16272727 6.65590909,3.57954545 9,3.57954545 L9,3.57954545 Z\",\n  id: \"Shape\",\n  fill: \"#EA4335\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M0,0 L18,0 L18,18 L0,18 L0,0 Z\",\n  id: \"Shape\"\n})), /*#__PURE__*/React.createElement(\"g\", {\n  id: \"handles_square\"\n})));\n\nfunction SvgGoogleLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"32px\",\n    height: \"32px\",\n    viewBox: \"7 7 32 32\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"btn_google_light_normal_ios\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3, _ref4);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgGoogleLogo);\nexport default __webpack_public_path__ + \"static/media/google-logo.8d51f170.svg\";\nexport { ForwardRef as ReactComponent };","import React, { ChangeEvent, useState, FormEvent } from 'react';\nimport { useAppState } from '../../state';\n\nimport Button from '@material-ui/core/Button';\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\nimport Grid from '@material-ui/core/Grid';\nimport { ReactComponent as GoogleLogo } from './google-logo.svg';\nimport { InputLabel, Theme } from '@material-ui/core';\nimport IntroContainer from '../IntroContainer/IntroContainer';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useLocation, useHistory } from 'react-router-dom';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  googleButton: {\n    background: 'white',\n    color: 'rgb(0, 94, 166)',\n    borderRadius: '4px',\n    border: '2px solid rgb(2, 122, 197)',\n    margin: '1.8em 0 0.7em',\n    textTransform: 'none',\n    boxShadow: 'none',\n    padding: '0.3em 1em',\n    [theme.breakpoints.down('sm')]: {\n      width: '100%',\n    },\n    '&:hover': {\n      background: 'white',\n      boxShadow: 'none',\n    },\n  },\n  errorMessage: {\n    color: 'red',\n    display: 'flex',\n    alignItems: 'center',\n    margin: '1em 0 0.2em',\n    '& svg': {\n      marginRight: '0.4em',\n    },\n  },\n  gutterBottom: {\n    marginBottom: '1em',\n  },\n  passcodeContainer: {\n    minHeight: '120px',\n  },\n  submitButton: {\n    [theme.breakpoints.down('sm')]: {\n      width: '100%',\n    },\n  },\n}));\n\nexport default function LoginPage() {\n  const classes = useStyles();\n  const { signIn, user, isAuthReady } = useAppState();\n  const history = useHistory();\n  const location = useLocation<{ from: Location }>();\n  const [passcode, setPasscode] = useState('');\n  const [authError, setAuthError] = useState<Error | null>(null);\n\n  const isAuthEnabled = Boolean(process.env.REACT_APP_SET_AUTH);\n\n  const login = () => {\n    setAuthError(null);\n    signIn?.(passcode)\n      .then(() => {\n        history.replace(location?.state?.from || { pathname: '/' });\n      })\n      .catch(err => setAuthError(err));\n  };\n\n  const handleSubmit = (e: FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    login();\n  };\n\n  if (user || !isAuthEnabled) {\n    history.replace('/');\n  }\n\n  if (!isAuthReady) {\n    return null;\n  }\n\n  return (\n    <IntroContainer>\n      {process.env.REACT_APP_SET_AUTH === 'firebase' && (\n        <>\n          <Typography variant=\"h5\" className={classes.gutterBottom}>\n            Sign in to join a room\n          </Typography>\n          <Typography variant=\"body1\">Sign in using your Twilio Google Account</Typography>\n          <Button variant=\"contained\" className={classes.googleButton} onClick={login} startIcon={<GoogleLogo />}>\n            Sign in with Google\n          </Button>\n        </>\n      )}\n\n      {process.env.REACT_APP_SET_AUTH === 'passcode' && (\n        <>\n          <Typography variant=\"h5\" className={classes.gutterBottom}>\n            Enter passcode to join a room\n          </Typography>\n          <form onSubmit={handleSubmit}>\n            <Grid container justify=\"space-between\">\n              <div className={classes.passcodeContainer}>\n                <InputLabel shrink htmlFor=\"input-passcode\">\n                  Passcode\n                </InputLabel>\n                <TextField\n                  id=\"input-passcode\"\n                  onChange={(e: ChangeEvent<HTMLInputElement>) => setPasscode(e.target.value)}\n                  type=\"password\"\n                  variant=\"outlined\"\n                  size=\"small\"\n                />\n                <div>\n                  {authError && (\n                    <Typography variant=\"caption\" className={classes.errorMessage}>\n                      <ErrorOutlineIcon />\n                      {authError.message}\n                    </Typography>\n                  )}\n                </div>\n              </div>\n            </Grid>\n            <Grid container justify=\"flex-end\">\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                type=\"submit\"\n                disabled={!passcode.length}\n                className={classes.submitButton}\n              >\n                Submit\n              </Button>\n            </Grid>\n          </form>\n        </>\n      )}\n    </IntroContainer>\n  );\n}\n","import React from 'react';\nimport { Redirect, Route, RouteProps } from 'react-router-dom';\nimport { useAppState } from '../../state';\n\nexport default function PrivateRoute({ children, ...rest }: RouteProps) {\n  const { isAuthReady, user } = useAppState();\n    \n  const renderChildren = user || !process.env.REACT_APP_SET_AUTH;\n\n  if (!renderChildren && !isAuthReady) {\n    return null;\n  }\n\n  return (\n    <Route\n      {...rest}\n      render={({ location }) =>\n        renderChildren ? (\n          children\n        ) : (\n          <Redirect\n            to={{\n              pathname: '/login',\n              state: { from: location },\n            }}\n          />\n        )\n      }\n    />\n  );\n}\n","import { createMuiTheme } from '@material-ui/core';\n\ndeclare module '@material-ui/core/styles/createMuiTheme' {\n  interface Theme {\n    sidebarWidth: number;\n    sidebarMobileHeight: number;\n    brand: string;\n    footerHeight: number;\n    mobileTopBarHeight: number;\n    mobileFooterHeight: number;\n    sidebarMobilePadding: number;\n    participantBorderWidth: number;\n    chatWindowWidth: number;\n  }\n\n  // allow configuration using `createMuiTheme`\n  interface ThemeOptions {\n    sidebarWidth?: number;\n    sidebarMobileHeight?: number;\n    brand: string;\n    footerHeight: number;\n    mobileTopBarHeight: number;\n    mobileFooterHeight: number;\n    sidebarMobilePadding: number;\n    participantBorderWidth: number;\n    chatWindowWidth?: number;\n  }\n}\n\nconst defaultTheme = createMuiTheme();\n\nexport default createMuiTheme({\n  overrides: {\n    MuiCssBaseline: {\n      '@global': {\n        'html, body, #root': {\n          height: '100%',\n        },\n      },\n    },\n    MuiButton: {\n      root: {\n        borderRadius: '4px',\n        textTransform: 'none',\n        color: 'rgb(40, 42, 43)',\n        fontSize: '0.9rem',\n        transition: defaultTheme.transitions.create(['background-color', 'box-shadow', 'border', 'color'], {\n          duration: defaultTheme.transitions.duration.short,\n        }),\n      },\n      text: {\n        padding: '6px 14px',\n      },\n      contained: {\n        boxShadow: 'none',\n        '&:hover': {\n          boxShadow: 'none',\n        },\n      },\n      outlinedPrimary: {\n        border: '2px solid #027AC5',\n        '&:hover': {\n          border: '2px solid rgb(1, 85, 137)',\n        },\n      },\n      startIcon: {\n        marginRight: '6px',\n      },\n    },\n    MuiTypography: {\n      body1: {\n        color: 'rgb(40, 42, 43)',\n        fontSize: '0.9rem',\n      },\n    },\n    MuiInputBase: {\n      root: {\n        fontSize: '0.9rem',\n      },\n    },\n    MuiSelect: {\n      root: {\n        padding: '0.85em',\n      },\n    },\n    MuiDialogActions: {\n      root: {\n        padding: '16px',\n      },\n    },\n    MuiTextField: {\n      root: {\n        color: 'rgb(40, 42, 43)',\n      },\n    },\n    MuiInputLabel: {\n      root: {\n        color: 'rgb(40, 42, 43)',\n        fontSize: '1.1rem',\n        marginBottom: '0.2em',\n        fontWeight: 500,\n      },\n    },\n    MuiOutlinedInput: {\n      notchedOutline: {\n        borderColor: 'rgb(136, 140, 142)',\n      },\n    },\n  },\n  typography: {\n    fontFamily: 'Inter, sans-serif',\n  },\n  palette: {\n    primary: {\n      main: '#027AC5',\n    },\n  },\n  brand: '#E22525',\n  footerHeight: 72,\n  mobileFooterHeight: 56,\n  sidebarWidth: 355,\n  sidebarMobileHeight: 90,\n  sidebarMobilePadding: 8,\n  participantBorderWidth: 2,\n  mobileTopBarHeight: 52,\n  chatWindowWidth: 320,\n});\n","import { ConnectOptions } from 'twilio-video';\nimport { isMobile, removeUndefineds } from '..';\nimport { getResolution } from '../../state/settings/renderDimensions';\nimport { useAppState } from '../../state';\n\nexport default function useConnectionOptions() {\n  const { roomType, settings } = useAppState();\n\n  // See: https://sdk.twilio.com/js/video/releases/2.0.0/docs/global.html#ConnectOptions\n  // for available connection options.\n  const connectionOptions: ConnectOptions = {\n    // Bandwidth Profile, Dominant Speaker, and Network Quality\n    // features are only available in Small Group or Group Rooms.\n    // Please set \"Room Type\" to \"Group\" or \"Small Group\" in your\n    // Twilio Console: https://www.twilio.com/console/video/configure\n    bandwidthProfile: {\n      video: {\n        mode: settings.bandwidthProfileMode,\n        dominantSpeakerPriority: settings.dominantSpeakerPriority,\n        renderDimensions: {\n          low: getResolution(settings.renderDimensionLow),\n          standard: getResolution(settings.renderDimensionStandard),\n          high: getResolution(settings.renderDimensionHigh),\n        },\n        maxTracks: Number(settings.maxTracks),\n        trackSwitchOffMode: settings.trackSwitchOffMode,\n      },\n    },\n    dominantSpeaker: true,\n    networkQuality: { local: 1, remote: 1 },\n\n    // Comment this line if you are playing music.\n    maxAudioBitrate: Number(settings.maxAudioBitrate),\n\n    // VP8 simulcast enables the media server in a Small Group or Group Room\n    // to adapt your encoded video quality for each RemoteParticipant based on\n    // their individual bandwidth constraints. Simulcast should be disabled if\n    // you are using Peer-to-Peer or 'Go' Rooms.\n    preferredVideoCodecs: [{ codec: 'VP8', simulcast: roomType !== 'peer-to-peer' && roomType !== 'go' }],\n\n    //@ts-ignore - Internal use only. This property is not exposed in type definitions.\n    environment: process.env.REACT_APP_TWILIO_ENVIRONMENT,\n  };\n\n  // For mobile browsers, limit the maximum incoming video bitrate to 2.5 Mbps.\n  if (isMobile && connectionOptions?.bandwidthProfile?.video) {\n    connectionOptions!.bandwidthProfile!.video!.maxSubscriptionBitrate = 2500000;\n  }\n\n  if (process.env.REACT_APP_TWILIO_ENVIRONMENT === 'dev') {\n    //@ts-ignore - Internal use only. This property is not exposed in type definitions.\n    connectionOptions!.wsServer = 'wss://us2.vss.dev.twilio.com/signaling';\n  }\n\n  // Here we remove any 'undefined' values. The twilio-video SDK will only use defaults\n  // when no value is passed for an option. It will throw an error when 'undefined' is passed.\n  return removeUndefineds(connectionOptions);\n}\n","import React from 'react';\nimport Video from 'twilio-video';\nimport { Container, Link, Typography, Paper, Grid } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles({\n  container: {\n    marginTop: '2.5em',\n  },\n  paper: {\n    padding: '1em',\n  },\n  heading: {\n    marginBottom: '0.4em',\n  },\n});\n\nexport default function UnsupportedBrowserWarning({ children }: { children: React.ReactElement }) {\n  const classes = useStyles();\n\n  if (!Video.isSupported) {\n    return (\n      <Container>\n        <Grid container justify=\"center\" className={classes.container}>\n          <Grid item xs={12} sm={6}>\n            <Paper className={classes.paper}>\n              <Typography variant=\"h4\" className={classes.heading}>\n                Browser or context not supported\n              </Typography>\n              <Typography>\n                Please open this application in one of the{' '}\n                <Link\n                  href=\"https://www.twilio.com/docs/video/javascript#supported-browsers\"\n                  target=\"_blank\"\n                  rel=\"noopener\"\n                >\n                  supported browsers\n                </Link>\n                .\n                <br />\n                If you are using a supported browser, please ensure that this app is served over a{' '}\n                <Link\n                  href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts\"\n                  target=\"_blank\"\n                  rel=\"noopener\"\n                >\n                  secure context\n                </Link>{' '}\n                (e.g. https or localhost).\n              </Typography>\n            </Paper>\n          </Grid>\n        </Grid>\n      </Container>\n    );\n  }\n\n  return children;\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { CssBaseline } from '@material-ui/core';\nimport { MuiThemeProvider } from '@material-ui/core/styles';\n\nimport App from './App';\nimport AppStateProvider, { useAppState } from './state';\nimport { BrowserRouter as Router, Redirect, Route, Switch } from 'react-router-dom';\nimport ErrorDialog from './components/ErrorDialog/ErrorDialog';\nimport LoginPage from './components/LoginPage/LoginPage';\nimport PrivateRoute from './components/PrivateRoute/PrivateRoute';\nimport theme from './theme';\nimport './types';\nimport { ChatProvider } from './components/ChatProvider';\nimport { VideoProvider } from './components/VideoProvider';\nimport useConnectionOptions from './utils/useConnectionOptions/useConnectionOptions';\nimport UnsupportedBrowserWarning from './components/UnsupportedBrowserWarning/UnsupportedBrowserWarning';\n\nconst VideoApp = () => {\n  const { error, setError } = useAppState();\n  const connectionOptions = useConnectionOptions();\n\n  return (\n    <VideoProvider options={connectionOptions} onError={setError}>\n      <ErrorDialog dismissError={() => setError(null)} error={error} />\n      <ChatProvider>\n        <App />\n      </ChatProvider>\n    </VideoProvider>\n  );\n};\n\nReactDOM.render(\n  <MuiThemeProvider theme={theme}>\n    <CssBaseline />\n    <UnsupportedBrowserWarning>\n      <Router>\n        <AppStateProvider>\n          <Switch>\n            <PrivateRoute exact path=\"/\">\n              <VideoApp />\n            </PrivateRoute>\n            <PrivateRoute path=\"/room/:URLRoomName\">\n              <VideoApp />\n            </PrivateRoute>\n            <Route path=\"/login\">\n              <LoginPage />\n            </Route>\n            <Redirect to=\"/\" />\n          </Switch>\n        </AppStateProvider>\n      </Router>\n    </UnsupportedBrowserWarning>\n  </MuiThemeProvider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}